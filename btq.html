<!DOCTYPE html>
<html lang="en">
<head>
    <title>趵突泉</title>
    <meta name="description" content="趵突泉(Baotu Spring),济南三大名胜之一,位于山东省济南市历下区,东临泉城广场,北望五龙潭,面积达158亩,位居济南七十二名泉之冠。乾隆皇帝南巡时因趵突泉水泡茶味醇甘美,曾册封趵突泉为“天下第一泉”。">
    <meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport">
    <meta content="yes" name="apple-mobile-web-app-capable">
    <meta content="telephone=no" name="format-detection">
    <meta content="black" name="apple-mobile-web-app-status-bar-style">
    <meta content="yes" name="apple-touch-fullscreen">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <meta charset="UTF-8" />
    <meta name="renderer" content="no-referrer-when-downgrade">
    <link rel="shortcut icon" href="https://static1.weizan.cn/zhibo/livecontent/vzan.ico" />
    <link rel="stylesheet" href="https://j.weizan.cn/zhibo/css/base.min.css?v=638498302430485833" />
    <link rel="stylesheet" href="https://j.weizan.cn/zhibo/css/weui.min.css?v=638498302430485833" />
    <link rel="stylesheet" href="https://j.weizan.cn/zhibo/css/animate.css?v=638498302430485833" />
    <link rel="stylesheet" href="https://j.weizan.cn/zhibo/css/swiper.css?v=638498302430485833" />
    <link rel="stylesheet" href="https://j.weizan.cn/zhibo/livecontent/plugin/element-ui/index.css?v=638498302430485833" />

    <link rel="stylesheet" href="https://static1.weizan.cn/zhibo/livecontent/livecommon/css_pc/mybase.css?ver=638498302430485833" />
    <link rel="stylesheet" href="https://static1.weizan.cn/zhibo/livecontent/livecommon/css_pc/direct.css?ver=638498302430485833" />
    <!-- ?ver=638498302430485833 -->
    <link rel="stylesheet" href="https://static1.weizan.cn/zhibo/livecontent/plugin/MagnificPopup/css/magnific-popup.css?ver=638498302430485833" />
    <link rel="stylesheet" href="https://static1.weizan.cn/zhibo/livecontent/new-2018/css/give-red-packets.css?ver1=638498302430485833" />

    <link rel="stylesheet" href="https://static1.weizan.cn/zhibo/livecontent/livecommon/css_pc/pd_pc.css?v=638498302430485833" />
    <link rel="stylesheet" href="https://static1.weizan.cn/zhibo/livecontent/livecommon/css_pc/theme.css?v=638498302430485833" />
    <link rel="stylesheet" href="https://static1.weizan.cn/zhibo/livecontent/webmic/styles/summit-entrance.css?ver=638498302430485833" />
    <link rel="stylesheet" href="https://static1.weizan.cn/zhibo/livecontent/virtualScene/styles/virtual-scene.css?ver=638498302430485833" />
    <link rel="stylesheet" href="https://static1.weizan.cn/zhibo/livecontent/topic/css/privateDomainTraffic.css?v=638498302430485833"></link>


    <script>
        // IE浏览器检测
        function isIE() {
            var userAgent = navigator.userAgent; //取得浏览器的userAgent字符串
            var isIE = userAgent.indexOf("compatible") > -1 && userAgent.indexOf("MSIE") > -1; //判断是否IE<11浏览器
            // var isEdge = userAgent.indexOf("Edge") > -1 && !isIE; //判断是否IE的Edge浏览器
            var isIE11 = userAgent.indexOf('Trident') > -1 && userAgent.indexOf("rv:11.0") > -1;

            return Boolean(isIE || isIE11)
        }

        if (isIE()) {
            alert('目前不兼容ie浏览器，请更换浏览器观看')
        }
    </script>

    <script src="https://static1.weizan.cn/zhibo/livecontent/public/js/moment.min.js?v=638498302430485833"></script>
    <script src="https://static1.weizan.cn/zhibo/livecontent/public/js/moment-timezone.min.js?v=638498302430485833"></script>
    <script src="https://j.weizan.cn/zhibo/js/jquery-2.1.4.min.js?v=638498302430485833"></script>
    <script src="https://j.weizan.cn/zhibo/js/jweixin-1.0.0.js?v=638498302430485833"></script>
    <script src="https://j.weizan.cn/zhibo/js/jquery.cookie.js?v=638498302430485833"></script>
    <script src="https://j.weizan.cn/zhibo/js/juicer.js?v=638498302430485833"></script>
    <script src="https://j.weizan.cn/zhibo/js/ajaxfileupload.js?v=638498302430485833"></script>
    <script src="https://j.weizan.cn/zhibo/js/swiper.js?v=638498302430485833"></script>
    <script src="https://j.weizan.cn/zhibo/js/clipboard.js?v=638498302430485833"></script>

    <link rel="stylesheet" href="https://static1.weizan.cn/zhibo/livecontent/slidVerify/static/css/slideApp.css?v=638498302430485833" />
    <link rel="stylesheet" href="https://static1.weizan.cn/zhibo/livecontent/img/PcLiveIcon/iconfont.css?v=638498302430485833" />
    <link rel="stylesheet" href="https://static1.weizan.cn/zhibo/livecontent/livecommon/css_pc/live_pc.css?v=638498302430485833" />
    <!-- 消息互动 新年皮肤  -->
    <!-- <link rel="stylesheet" href="https://static1.weizan.cn/zhibo/livecontent/livecommon/skin/newyear/css/style-d634b3218f.css" /> -->
    <link href="https://static1.weizan.cn/zhibo/livecontent/wedding/css/custom-theme-pc.css?638498302430485833" rel="stylesheet" />

    <script type="text/javascript" src="https://static1.weizan.cn/zhibo/livecontent/slidVerify/static/js/jquery.lgyslide.js?v=638498302430485833"></script>
    <script src="https://static1.weizan.cn/zhibo/livecontent/content/live/scripts/jquery.qrcode.min.js?v=638498302430485833"></script>
    <script src="https://static1.weizan.cn/zhibo/livecontent/plugin/MagnificPopup/js/jquery.magnific-popup.min.js?v=638498302430485833"></script>
    <script src="https://static1.weizan.cn/zhibo/livecontent/plugin/layer-3.0.1/layer.js?v=638498302430485833"></script>

    <script src="https://static1.weizan.cn/zhibo/plugin/vue/2.6.11/vue.min.js"></script>
    <script src="https://j.weizan.cn/zhibo/js/vue-router.min.js?v=638498302430485833"></script>

    <script src="https://static1.weizan.cn/zhibo/livecontent/js/utlis.js?v=638498302430485833"></script>
    <script id="analysislog" src="https://static1.weizan.cn/zhibo/livecontent/log/analysis.js?cname=zbvz_userid&ver=638498302430485833"></script>
    <script src="https://res.wx.qq.com/open/js/jweixin-1.2.0.js?v=638498302430485833"></script>
    <script src="https://open.work.weixin.qq.com/wwopen/js/jwxwork-1.0.0.js?v=638498302430485833"></script>

    <script src="https://static1.weizan.cn/zhibo/livecontent/content/live/scripts/wtwap/bulletjs.js?sv=638498302430485833"></script>
    <script src="https://static1.weizan.cn/zhibo/js/vzan_protobuf.min.js?v=638498302430485833"></script>
    <script src="https://j.weizan.cn/zhibo/livecontent/plugin/element-ui/index.js?v=638498302430485833"></script>


    <style>
        #pcLiveRightArea, #pcLiveIntroduceArea, #pcLiveRoomInfoArea {
            display: none;
        }

        .cjt-custom-player {
            background-image: none !important;
            height: auto !important;
        }

            .cjt-custom-player .live-info-state {
                height: 0 !important;
            }

            .cjt-custom-player #viewcontent {
                margin-bottom: 0 !important;
                min-height: inherit !important;
            }

            .cjt-custom-player .pd-viewcontent-left {
                border-radius: 0 !important;
                width: 100% !important;
            }

            .cjt-custom-player .direct-security {
                width: 100% !important;
            }

        .pd-like {
            width: 56px;
        }

        #attentionTitle {
            text-align: center;
        }

        .expo-live-video {
            background: transparent !important;
        }

        .expo-video-mask {
            display: none;
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.7);
            display: flex;
            align-items: center;
            justify-content: center;
            flex-direction: column;
        }

            .expo-video-mask > span {
                font-size: 16px;
                font-weight: 500;
                color: #FFFFFF;
                line-height: 16px;
            }

            .expo-video-mask > img {
                width: 44px;
                height: 44px;
                margin-bottom: 18px;
            }

        .bg-box-sign {
            position: relative;
            background: #C3F4FF;
            border-radius: 16px;
            border: 1px solid #FFFFFF;
            height: 32px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            font-size: 11px;
            font-family: PingFang;
            font-weight: 500;
            color: #FFFFFF;
            z-index: 300;
            position: relative;
            display: flex;
        }

        .wel-sign-icon {
            position: absolute;
            width: 48px;
            height: 42px;
            bottom: 0px;
        }

        .wel-sing-text {
            height: 34px;
            display: flex;
            align-items: center;
            color: #006CFF;
            padding: 4px 10px 4px 47px;
            font-size: 12px;
        }
        .fixedImg {
            position: fixed;
            top: 0;
            left: 0;
            z-index: 0;
            width: 100%;
        }
        .fixedMark {
            position: fixed;
            top: 0;
            left: 0;
            z-index: 0;
            width: 100%;
            height: 240px;
            opacity: 0;
        }
        .bg-scroll-style {
            position: absolute;
            left: 0;
            top: -16px;
            width: 100%;
            height: 100%;
            overflow: hidden;
        }
        .bg-scroll-style img {
            width: 100%;
        }
        .bg-scroll-style .fixedMark {
            position: absolute;
        }
        .qrCodeDialog {
            position: relative;
        }

        /*强制弹出*/
        .popup-head {
            padding: 15px 10px;
            border-bottom: 1px solid #eee;
            text-align: center;
        }

        .popup-body {
            padding: 10px;
            text-align: center;
        }

        .popup-forcefocus.popup-show {
            visibility: visible;
        }
        /*强制关注公众号*/
        .popup-forcefocus {
            position: fixed;
            top: 0;
            left: 0;
            bottom: 0;
            right: 0;
            width: 100%;
            height: 100%;
            display: -webkit-box;
            display: -moz-flex;
            display: -ms-flexbox;
            display: flex;
            -webkit-box-pack: center;
            -ms-flex-pack: center;
            -moz-justify-content: center;
            justify-content: center;
            -webkit-box-align: center;
            -ms-flex-align: center;
            -moz-align-items: center;
            align-items: center;
            visibility: hidden;
            z-index: 100000;
            background-color: rgba(0,0,0,.6);
        }

        .popup-forcefocus .popup-mask {
            background: rgba(0, 0, 0, .8);
            position: fixed;
            top: 0;
            left: 0;
            bottom: 0;
            right: 0;
            width: 100%;
            height: 100%;
        }

        .popup-forcefocus.active .popup {
            -webkit-animation-name: superScaleIn;
            animation-name: superScaleIn;
            -webkit-animation-duration: .2s;
            animation-duration: .2s;
            -webkit-animation-timing-function: ease-in-out;
            animation-timing-function: ease-in-out;
            -webkit-animation-fill-mode: both;
            animation-fill-mode: both;
        }

        .popup-forcefocus .popup {
            position: relative;
            width: 250px;
            max-width: 100%;
            max-height: 90%;
            border-radius: 3px;
            background-color: #fff;
            display: -webkit-box;
            display: -moz-flex;
            display: -ms-flexbox;
            display: flex;
            -webkit-box-direction: normal;
            -webkit-box-orient: vertical;
            -moz-flex-direction: column;
            -ms-flex-direction: column;
            flex-direction: column;
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none;
            z-index: 13;
        }

        .popup-forcefocus.popup-show {
            visibility: visible;
        }
    </style>

</head>

<body class="pc-live-video VzanBlue ">
    <div class="live_title_bar webkitBox" style="display:none;" attr-title="趵突泉(Baotu Spring),济南三大名胜之一,位于山东省济南市历下区,东临泉城广场,北望五龙潭,面积达158亩,位居济南七十二名泉之冠。乾隆皇帝南巡时因趵突泉水泡茶味醇甘美,曾册封趵突泉为“天下第一泉”。" attr-state="1" attr-pic="https://a2.vzan.com/live/1427079113/upload/image/png/20230414/71ff8d2849db47b18f82ad71d9023d80.png" attr-url="https://wx.vzan.com/live/tvchat-768346371?ver=638512900112373342&amp;sharetstamp=1715664411237"></div>

            <img class="fixedImg themeUrl" src="https://static1.weizan.cn/zhibo/livecontent/img/pcLive/Default.png" />

    <!--全局变量-->

    <script type="text/javascript">
        var baseURL = "";
        var shareApiList = ['onMenuShareTimeline', 'onMenuShareAppMessage', 'onMenuShareQQ', 'onMenuShareWeibo', 'onMenuShareQZone'];
        var showMenuApi = 'showOptionMenu';
        var wxPayApi = 'chooseWXPay';
        var recordAndVoiceApiList = ['startRecord', 'stopRecord', 'onVoiceRecordEnd', 'playVoice', 'stopVoice', 'uploadVoice'];
        if ('' != '') {
            wx.config(
                {
                    debug: false,
                    appId: "",
                    timestamp: "",
                    nonceStr: "",
                    signature: "",

                    jsApiList: [
                        "checkJsApi",
                        "onMenuShareTimeline",
                        "onMenuShareAppMessage",
                        "onMenuShareQQ",
                        "onMenuShareQZone",
                        "onMenuShareWeibo",
                        "hideMenuItems",
                        "showMenuItems",
                        "hideAllNonBaseMenuItem",
                        "showAllNonBaseMenuItem",
                        "translateVoice",
                        "startRecord",
                        "stopRecord",
                        "onRecordEnd",
                        "playVoice",
                        "pauseVoice",
                        "stopVoice",
                        "uploadVoice",
                        "downloadVoice",
                        "chooseImage",
                        "previewImage",
                        "uploadImage",
                        "downloadImage",
                        "getNetworkType",
                        "openLocation",
                        "getLocation",
                        "hideOptionMenu",
                        "showOptionMenu",
                        "closeWindow",
                        "scanQRCode",
                        "chooseWXPay",
                        "openProductSpecificView",
                        "addCard",
                        "chooseCard",
                        "openCard"
                    ]
                });
        }
        wx.ready(function () {
            if ('1' == '1') {
                wx.showOptionMenu();
            }
            else {
                wx.hideOptionMenu();
            }
        });

        function gettoken() { return ""; }
    </script>

<script src="https://static1.weizan.cn/zhibo/livecontent/drainSet/drainSet.js?v=638498302430485833"></script>
<script src="https://static1.weizan.cn/zhibo/livecontent/plugin/scrmlog/scrmLog.js?v=638498302430485833"></script>
<!--全局变量-->
<script type="text/javascript">
    var zbvd = {
        link_from_my_share: 'True' === 'True',
        wstpId: '',
        ThirdType: '',
        zbid: 1427079113,
        topicid: 768346371,
        enc_topicid: 'A18B9FDB1A37A560A23AAEB4D3DB1829',
        topictitle:"趵突泉",

        userid:0,
        enc_userid: '',
        //神策用全局属性 begin
        zb_live_state:'正在推流',//话题状态
        zb_live_type:'VR直播',//话题类型
        zb_industry_id :78,//一级行业ID
        zb_industry_id2 :80,//二级行业ID
        zb_industry_id3 :0,//三级行业ID
        zb_industry_name :'传媒广告',//一级行业名称
        zb_industry_name2 :'广告传媒',//二级行业名称
        zb_industry_name3 :'',//三级行业名称
        //神策用全局属性 end

        vzuid:0,
        thirduid: 0,//第三方表的用户Id,
        enc_thirduid: '', //第三方表的加密用户Id
        roleid:0,
        siteid:0,
        siteuser:65494707,
        blockall:false,
        block:false,
        ustate:1,
        isadmin:false,
        modeltype: '6',
        watchmode: '',
        actionname: 'tvchat',
        levels:0,
        iscomment:false,
        tplname: 'VRLive',
        isfree:false,
        customertype:6,
        liveroomname: '山东高锋科技发展有限公司',
        creator:{"id":65494707,"nickname":"圆梦行","headimgurl":"https://i2.vzan.com/image/live/headimg/jpeg/2021-3-7/124905aa18bf39ddda40f4ab69ab50269c0610.jpeg"},
        isadvance:false,
        tongjifangshi: "pv",
        maxint:2147483647,
        mintime: '0001/01/01 00:00:00',
        maxtime: '9999/12/31 23:59:59',
        status:1,
        isVerticalShop:false,
        isvideochange: true,
        isaudtcomment:false,
        isOpenDm:false,
        DanMuLineNum:5,
        isthirdbind:false,
        skin: 'VzanBlue',
        tpaddtime: '2023/04/14 18:38:25',
        tpstarttime: '2023/04/14 20:37:38',
        tpstarttimeTimestamp:'1681475858000',
        repayId:0,
        kws: '100',
        isGuestHost:false,
        isopenadv:false,
        wfid:0,
        wfplaying: 'https://static1.weizan.cn/zhibo/livecontent/livecommon/images/p2.gif',
        wfplay: 'https://static1.weizan.cn/zhibo/livecontent/livecommon/images/pause01.png',
        isopenonline:false,
        usercookie: 'zbvz_userid',
        shopMenu:0,
        isOpenHireLive:0,
        IsScreen:1,
        IsOpenShang:false,
        maxRewardMoney:parseInt('6000'),
        IsOpenInteractionEffects:false,
        QrPopType:0,
        LogoPopType:1,
        MerchantQRCode: '',
        shareuid: 300786936,
        shuid: 'ROThnhQdFvkSIXo7IXUVyw==',
        JubilationKey: eval('(' + "[&quot;恭贺新春&quot;,&quot;财源滚滚&quot;,&quot;万事大吉&quot;,&quot;恭喜发财&quot;,&quot;新年快乐&quot;,&quot;生意兴隆&quot;,&quot;大吉大利&quot;,&quot;新年&quot;,&quot;年年有余&quot;,&quot;一帆风顺&quot;,&quot;大展宏图&quot;,&quot;春节&quot;,&quot;新春&quot;]".replace(/&quot;/g, "'") + ')'),
        IsOpenZeroGift:true,
        GiftEffectValue:1,
        isLiveAss:false,
        cookiedomain: '.vzan.com',
        WsLinkItem: 'wss://ws.vzan.com',
        WsLinkSpare: 'wss://wks.vzan.com/ws',
        RealtimeUrl: '',
        PlaybackType: '0',
        rightTopWatermark: '',
        IsOpenGift: '0',
        shangType: '1',
        wsbanids: '771148547,',
        ouPaiCustomId: ',737014590,11800140,569331022,969984,926636440,1853745139,432873017,528623611,797029237,',
        IsOpenRedBagCode: '1',
        getCouponMul: 0,
        ip: '112.231.89.226',
        vzanLogs: 'https://lg.vzan.com',
        isLogsWss: '-1', // -1:表示不开启, 0:ajax轮询日志,1:WebSocket轮询日志，2:授权直接post腾讯云日志
        LogsWssUrl: "wss://lgws.vzan.com",
        LogsTencentAuthApi: 'https://logtx.vzan.com/api/ticketauth/visitor',
        sid: '93b3961e-63b4-4ead-a061-a72d1dcc71a4',
        sex: 0,
        terminal:2,
        cId: 0,
        isWsHeart: 1,
        isLocalVideo:false,
        IsFreeLookLimit:false,
        WebUrl: 'https://wx.vzan.com',
        isWorkWeChat:false,
        skId: '1F02589246BD66877AA39BFEAB864EEA63F90DF3EC2E1574',
        stay: '',
        isldlive:false,
        YLLiveId:69678608,
        thdp: '',
        tuid: '',
        thruid: '',
        tagInfo:{"tagid":0,"tagname":""},
        tagid: '0',
        tagname: '',
        IsSwitchJavaForm: 'true',
        formId: '0',
        IsSwitchJavaTurntable: 'false', //场次抽奖灰度
        TurntableId: '',   //大转盘抽奖Id
        Enc_TurntableId: '',
        lotteryType: '',   //抽奖类型 场次抽奖--0,多轮(在线)抽奖--1
        lotteryStartTime: '',   //抽奖活动开始时间
        lotteryEndTime: '',   //抽奖活动结束时间
        lotteryRemark: '',   //抽奖活动说明
        TagsLiveIds: '1375329736,1288982791,780102507,1788650844',
        applyId: 0,
        askId: 0,
        redpacketlimit:{"LimitAmountWxchat":600000,"LimitAmountCash":5000000,"LimitCountWxchat":6000,"LimitCountCash":6000,"LimitAmountMin":100},
        receive_bit_msg: '1' || '0', //是否接收二进制消息
        isAlonePay: 'False' === 'True', //是否独立支付
        weappNestWeb: 0,
        offiAccountSwitch:1,
        miniProgramSwitch:1,
        MiniType: 0 || 0,//小程序二维码类型 0--微赞小程序 1--商家小程序
        AreaDetails:'1', //互动区详情按钮控制
        AreaChangeName:'1',//互动区修改昵称
        AreaExpression: '1', //互动区表情按钮
        CustomImageSwitch: '0', //上传群活码/成员活码/图片  0关闭，1开放
        FollowOffAccountSwitch: '0', //关注公众号    0关闭，1开放
        convenientComment: '0' == '1',
        isShowCountDown:0,
        redpacketTotal: '',
        isTobaccoLive:false,
        lianMaiIconSwitch:0,

        mActId: 0, //展会活动id
        mExorId: 0, //展会参展商id
        ipCountryCode: 'China',
        customConfig:{"watchTimeLimits":null}, //定制配置
        allowTurnPagePPT:'True' === 'True',
        isKate: 'False' === 'True',
        isChanghong: 'False' == 'True',
        isYili: 'False' === 'True',
        yiLiCrmId:'',
        grayAnswerAct: 0,
        IsSwitchSignin:false,
        SocketSign:encodeURIComponent('81UB1uLr1tFMrJCFymxsNL45vNM71fq4pm/5OaYODi+tPRgKwiOfe4k4QwLw2yp+03NmBW4aSOzIo7vHQyOU9g=='),
        IsSwitchLuckyBag: false,
        isOpenHorseLampScreen:true,
        types: 0,
        topicAttr:{"IsOpenWhite":false,"wkVerify":false,"IsOpenShare":false,"SharePercent":20,"IsOpenForm":true,"IsOpenAd":false,"IsClipVideo":false,"IsBusiness":true,"IsOpenMiniIcon":1,"MiniType":0,"IsOpenShang":false,"ShangType":1,"IsOpenInteractionEffects":false,"MQRCodeName":"","VideoSrc":"","VideoSourceType":0,"VideoCover":"","JobId":"","JobState":"","IsSkipAds":false,"MultiPlatePushUrls":[],"IsRedPacket":false,"IsRedPacketRecord":false,"IsRedPacketShowFee":false,"IsShareBang":true,"WonderfulMoment":"","CustomFocus":null,"IsShowGuideCountDown":true,"GuideCountDownPosition":50,"IsOpenAudio":0,"IsOpenGift":0,"IsConcernLook":false,"IsFreeLook":false,"FreeLookMinutes":0,"ReturnUrl":"","RoleId":"","IsOpenCoupon":false,"IsShowCoupon":false,"AdUrl":"","IsShareIcon":false,"IsOpenSign":true,"PromotionType":0,"IsShowActor":false,"IsOpenRelay":true,"IsOpenRelayEntrance":false,"IsShowConcern":true,"InviteCardBgUrl":"","RewardSetting":null,"RewardWord":"","IntegralRewardSetting":null,"IntegralRewardWord":"","Adv_ScrollTextLogo":"","Adv_ScrollTextColor":"#ffffff","Adv_ScrollTextBgColor":"#ff3f5a","Adv_ScrollLocation":2,"IsOpenScrollAd":false,"ScrollingInterval":4,"Adv_TitleAdIsOpenHeadAdv":true,"Adv_TitleAdIsPlayEveryTime":false,"Adv_TitleAdNotStartPlayIsLoop":false,"Adv_TitleAdIsAllowPass":false,"Adv_PauseAdIsOpen":false,"Adv_PauseAdIsPlayLoop":false,"Adv_PauseAdIsAllowPass":false,"Adv_PauseAdAdUrl":"","IsOpenImgAudt":false,"isDirectUpload":false,"IsOpenImgDownload":true,"IsLookOpenImgQrcode":false,"LookOpenImgQrcodeName":"","LookOpenImgQrcode":"","PicAddress":"","IsAutoPlayMusic":true,"AutoPlaySecond":5,"BGM":"","IsShowPv":false,"IsOpenBasePv":false,"BasePv":0,"IsOpenTimesPv":false,"TimesPv":0,"TimesPvH":0,"SumPv":0,"IsShowShareTimes":false,"ShareTimes":0,"IsSendImg":false,"isShareMsg":false,"isEntryMsg":false,"IsOpenWaterMark":0,"isOpenFilter":0,"IsOpenRepairPhoto":0,"IsRepairAduitPhoto":0,"IsShowPhotographer":0,"WaterMarkUrl":"","WaterMarkX":0,"WaterMarkY":0,"QrPopType":0,"IsLike":false,"Likemulriple":0,"ImgWaterMarkInfo":"","ImgFilterInfo":"","IsimgViewCount":false,"JubilationKey":"恭贺新春，财源滚滚，万事大吉，恭喜发财，新年快乐，生意兴隆，大吉大利，新年，年年有余，一帆风顺，大展宏图，春节，新春","isOpenZeroGiftEffect":true,"GiftEffectValue":1,"RewardMethodType":0,"GiftMethodType":0,"enterModel":1,"RightTopWatermark":"","isOpenRightTopWatermark":true,"LogoPopType":3,"TopLookdescribe":"","IsTopicQrcode":true,"IsTopicSales":false,"ServiceQrcode":"","ShowServiceCodeType":0,"PlaybackType":0,"ServicePhone":"","ComplaintTel":"","IsimgClassify":true,"MaterialDownload":1,"AdPvType":0,"VoteIsShowTopicAd":false,"imgUploaduser":true,"isShowLiveTime":false,"isShowLiveAddress":false,"imgBtnOperType":1,"IsFaceRecEnable":false,"PicStoryStatus":-1,"IsOpenCooperation":true,"MiniPagePath":null,"IsOpenShop":true,"IsPv":true,"IsPraise":false,"OpendProductSales":true,"ProductUnderWay":0,"ActId":0,"InteractionImg":"","VoteSuId":0,"IsOpenPromoters":false,"CouponIdList":"","IsOpenSonTopics":false,"SonTopicsPosition":2,"SonTopicsTitle":"","IsOpenLangTopics":false,"TopicLangType":0,"IsOpenInteracte":false,"WhiteListTips":"","PrivateMaxNums":0,"SubscibeType":1,"SubscibeOpenHandle":false,"UnderTypes":0,"UnderBtnText":"","UnderIsNeedStore":false,"PushUnderText":"","UnderSubType":0,"InfoGather":false,"yy_isauth":0,"yy_authUrl":"","yy_failtureUrl":"","TutorialType":0,"IsOpenSafeLink":false,"IsProductDesc":false,"isReplyShowImg":false,"HdKfType":0,"IsDxKf":true,"DrainageQrcodeId":0,"AllowTurnPagePPT":true,"MiniProgramSwitch":true,"MiniProgramTime":15,"OffiAccountSwitch":true,"OffiAccountTime":15,"MessageSwitch":false,"MessageTime":15,"bottomBtn":null,"ctUrl":null,"IsShowProgress":true,"PageIsShowProgress":false,"SonPlayBackValidity":"","IsSonOpenPlayback":false,"HideNickname":false,"ShowMore":true,"DanMuLineNum":5},
        ShowSonTopicDescription:'0',
        isHomeMedal: false,
        playurl: '',
        customize: '',
        catAgentInfo:null,
        loginBackUrl:'0F7BFFA9474D371F39E70DAD7EB5EB23F2C9F26430169546F1B0327A879E8A476EC81D9CADB2DD007935136160D1E30513055652D15ACD538189A4E647D151BBC582C7C172AD3EAE6EDB5D5DB3113A3F58DA3B3ED481E3AAC3DC2E2055FD22E6957925481D1C94818F9DDC84EB45BB3132DDDE9370F47BF0AA6CF895F6C9BA07AB652CD608D2E6399A76ADA9693EF3D7',
        customRule: 0,
        sourceId: 0
    };
    if(/miniProgram\/wx92d650b253f8f2e3|miniProgram\/wx291cee336ee3530b/.test(window.navigator.userAgent)) {
      // 针对vzanlive小程序内嵌屏蔽管理员角色
      zbvd.roleid = 0
    }
    zbvd.redpacketlimitamountmin = zbvd.redpacketlimit.LimitAmountMin; //红包限制最小支付金额1元
    zbvd.zbredpacketlimitamountwxchat = zbvd.redpacketlimit.LimitAmountWxchat; //直播间红包微信支付限额
    zbvd.zbredpacketlimitamountcash = zbvd.redpacketlimit.LimitAmountCash; //直播间红包余额支付限额
    zbvd.zbredpacketlimitcountwxchat = zbvd.redpacketlimit.LimitCountWxchat; //直播间红包微信支付数量限制
    zbvd.zbredpacketlimitcountcash = zbvd.redpacketlimit.LimitCountCash; //直播间红包余额支付数量限制
    zbvd.redpacketlimitcountmax = (zbvd.siteuser == zbvd.userid && zbvd.zbredpacketlimitcountwxchat < zbvd.zbredpacketlimitcountcash) ? zbvd.zbredpacketlimitcountcash : zbvd.zbredpacketlimitcountwxchat; //红包限制最大数量(用于文案提示)

    $(function () {
		if(/\/live\/tvchat-/i.test(location.href)){
            try{
                scrmLog({itemName:zbvd.topictitle,title:zbvd.topictitle,event:'view_live'})//判断是话题 统一埋点
            }
            catch(e){}
            try{
                kateLog(zbvd.zbid,{
                    id:zbvd.topicid,
                    tid:zbvd.topicid,
                    type:1,
                    ip:zbvd.ip
                })
            }
            catch(e){}
		}
        try {
            var hideChat = "0";
            if (hideChat == "1") {
                $('#pcChatTabId').remove();
                $('#pcLiveChatBox').remove();
                $('#pcLiveChatArea').remove();
                $('#pcBangdanTabId').click();
            }

            var showUnit = "";
            if (showUnit == "video") {
                $('#LiveVideoArea').siblings().hide();
                $('#pcLiveRightArea').remove();
                $('#pcLiveIntroduceArea').remove();
                $('#pcLiveRoomInfoArea').remove();
                $('#videoPlayer').siblings().hide();
                $('#videoBottomBtnApp').show();

                try {
                  if (!liveinfo.playurl) {
                    $('.video-poster').css('object-fit', 'contain').show()
                  }
                  if (!liveinfo.livestatus == "notbegin") {
                    $('#div_live_status.timeover').show()
                  }
                } catch (error) {
                    console.error(error);
                }

                $('body').addClass("cjt-custom-player");
            }
            else {
                $('#pcLiveRightArea').show();
                $('#pcLiveIntroduceArea').show();
                $('#pcLiveRoomInfoArea').show();
            }
        } catch (error) {
            console.log(error);
        }
    });

    function getQueryVariable(variable) {
        var query = window.location.search.substring(1);
        var vars = query.split("&");
        for (var i = 0; i < vars.length; i++) {
            var pair = vars[i].split("=");
            if (pair[0] == variable) { return pair[1]; }
        }
        return (false);
    }

    function getQueryStringArgs(){
        var qs=(window.location.search.length>0?window.location.search.substring(1):""); //去除？
        args={},
        items=qs.length?qs.split("&"):[];
        var item=null,
        name=null,
        value=null,
        i=0,
        len=items.length;
        for(i=0;i<len;i++){
            item=items[i].split("=");

            name=decodeURIComponent(item[0]);

            value=decodeURIComponent(item[1]);

            if (name.length) {
                args[name]=value;
            };
        }
        return args;
    }

    // 报名表神策接入
    function getShenCeSignup(reason) {
        setTimeout(function(){
            try {
                var data = {
                    zb_form_id: window.zbvd.formId,
                    is_success: window.zbvd.formId > 0 ? true : false,
                    fail_reason: reason || "",
                };
                window.VZAN_SHENCE&&window.VZAN_SHENCE.track('zb_form_request',data);
                console.log(window.VZAN_SHENCE,'报名表神策success',data);
            } catch (ex) {
                console.log(ex,'报名表神策fail');
            }
        },8000)
    }
    // 载入前跳转报名表页面判断
    // 获取url参数
    // 10.31报名表重构报名状态判断,是未报名进行新版直播间的跳转，否则不跳转
    if (window.zbvd.formId > 0) {
        var hasSignupSuccess = false;
        try{
            var base = {
                id: window.zbvd.topicid,//获取话题
                shareUid: 0,
                type: 1,//类型固定话题zbid
                zbId: window.zbvd.zbid,
            };
            var lid = window.zbvd.zbid;//报名表请求判断是否强制报名且未填报名表跳转新版报名表页面
            var rol = window.zbvd.roleid;
            $.ajax({
                headers: {
                    'TOKEN-PAYLOAD': JSON.stringify({ lid, rol })
                },
                type: "POST",
                async: true,
                dataType: "json",
                contentType: 'application/json',
                url: "/marketing/wx/v1/enroll_form/get",
                data: JSON.stringify(base),
                success: function (data) {
                    if (data && data.dataObj) {
                        //判断新版版本是否已报名
                        // 只在互动区显示时直接显示直播页，如果要跳转则判定是否已填，未填就跳
                        var signupskip = getQueryVariable("signupskip") || 0;
                        // 取出全部参数跟已有固定参数对比然后去除
                        var otherAll = getQueryStringArgs();
                        var otherString  = "";
                        console.log(otherAll);
                        if(otherAll){
                            for (let key in otherAll) {
                                if(key=="zbid"||key=="id"||key=="type"||key=="meun"||key=="f"||key=="oId"||key=="zbId"||key=="other"||key=="signupskip"){
                                    // 不处理
                                }else{
                                    otherString = otherString + key +  "=" + otherAll[key] +"&"
                                }
                            }
                        }
                        // 待审核 || 审核不通过
                        var auditStatus = data.dataObj.audit_type === 0 || data.dataObj.audit_type === 2
                        if(data.dataObj.form_attr.must_write && (data.dataObj.post_data.length == 0 || auditStatus) && (data.dataObj.form_attr.topicEnterType==1||data.dataObj.form_attr.topicEnterType==2) && data.dataObj.form_attr.fillInStyle == 0 && window.zbvd.roleid <= 0){
                            //window.location.replace("/live/TpForm?zbid=" + window.zbvd.zbid + "&oId=" + window.zbvd.topicid + "&type=1&" + otherString);

                            // 报名表独立页面跳转优化(话题报名表)
                            window.location.href = "/live/mk/signupform?zbid=" + window.zbvd.zbid + '&oId=' + window.zbvd.topicid + '&type=1&meun=&ismini=0&'+ otherString + '&ver=' +  new Date().getTime();
                            return;
                        }
                        //如果是跳过则直接进入直播间
                        //再接口判断报名状态
                        if (signupskip == 1) {
                            getShenCeSignup("has formId signupSkip");
                        } else if ( (data.dataObj.form_attr.topicEnterType==1||data.dataObj.form_attr.topicEnterType==2) && data.dataObj.post_data.length == 0 && data.dataObj.form_attr.fillInStyle == 0 && window.zbvd.roleid <= 0) {
                            //进入话题前显示，且未填写且需要跳转页面
                            //window.location.replace("/live/TpForm?zbid=" + window.zbvd.zbid + "&oId=" + window.zbvd.topicid + "&type=1&" + otherString);

                            // 报名表独立页面跳转优化(话题报名表)
                            window.location.href = "/live/mk/signupform?zbid=" + window.zbvd.zbid + '&oId=' + window.zbvd.topicid + '&type=1&meun=&ismini=0&'+ otherString + '&ver=' +  new Date().getTime();
                            return;
                        }else {
                            getShenCeSignup("has formId enter Topic");
                        }
                        hasSignupSuccess = true;
                    }
                },
                error: function (err) {
                    console.log("报名表详情调用失败");
                    var message = "";
                    if(err && err.responseText){
                        message = err.responseText;
                    }
                    getShenCeSignup(message.toString() + "(has formId Ajax Fail)");
                    // hasformid -> api error
                }
            });
        }catch(error){
            // hasformid -> code error
            getShenCeSignup(error.toString() + "(has formId Js Fail)");
        }
        setTimeout(function(){
            if(!hasSignupSuccess){
                getShenCeSignup("has formId enter Topic Api Fail");
            }
        },1000)
    } else {
        // 如果没报名表，执行没报名表的失败打印
        getShenCeSignup("no formId");
    }
    if(true){
        try{
            var marketingbase = {
                topicId: window.zbvd.topicid,
                userId: window.zbvd.userid,
                zbId: window.zbvd.zbid
            };
            var lid = window.zbvd.zbid;//报名表请求判断是否强制报名且未填报名表跳转新版报名表页面
            var rol = window.zbvd.roleid;
            $.ajax({
                headers: {
                    'TOKEN-PAYLOAD': JSON.stringify({ lid, rol })
                },
                type: "POST",
                async: false,
                dataType: "json",
                contentType: 'application/json',
                url: "/marketing/wx/v1/public/config",
                data: JSON.stringify(marketingbase),
                success: function (data) {
                    if(data && data.dataObj){
                        if(data.dataObj.sign){
                            // 签到功能初始化赋值
                            window.zbvd.IsSwitchSignin = true;
                        }
                        if(data.dataObj.luckyBag){
                            // 福袋开关
                            window.zbvd.IsSwitchLuckyBag = true;
                        }
                        if (data.dataObj.topicLikeSetting) {
                            window.zbvd.zang_config = data.dataObj.topicLikeSetting
                        }
                        // 券码抽奖
                        if (data.dataObj.ltId) {
                            window.zbvd.lt_id = data.dataObj.ltId
                            $("#multiRoundLotteryIcon").show()
                        }

                        // 是否官方直播间
                        window.isVzanLive = data.dataObj.isOfficialZb || 0
                        
                        if(data.dataObj.turntable) {
                            // 大转盘开关
                            window.zbvd.IsSwitcTurntable = true;
                            window.zbvd.turntableSetting = data.dataObj.turntableSetting;
                        } else {
                            window.zbvd.IsSwitcTurntable = false;
                            window.zbvd.turntableSetting = {};
                        }

                        if (data.dataObj.zySetting) {
                            window.zbvd.zySetting = data.dataObj.zySetting;
                        }

                        // 免费版私域引流
                        if ((zbvd.customertype == 0)) {
                            getFreeDrainSetTopicDetail();
                        } else {
                            if (data.dataObj.topicDrainageSetting) {
                                window.drainSetConfig = data.dataObj.topicDrainageSetting;
                            }
                            // 私域引流
                            // if (data.dataObj.topicDrainage == 1) {
                            //     getDrainSetTopicDetail();
                            // }
                        }
                        if (data.dataObj.questionnaireid) {
                            window.zbvd.questionnaireId = data.dataObj.questionnaireid;
                        }
                    }
                },
                error: function (err) {
                    console.log("获取营销共用配置失败");
                }
            });
        }catch(error){
            // hasformid -> code error
            console.log(error);
        }
    }
</script>


<script type="text/javascript">
    var wxMiniProgram = {
        inminiprogram: false,
    };

    window.onload = function () {
        getWxMiniProgramEnv();
    }

    function getWxMiniProgramEnv() {
        try {
            wx.miniProgram.getEnv(function (res) {
                wxMiniProgram.inminiprogram = res.miniprogram;
            });
        } catch (err) {
            console.log("wx.miniProgram.getEnv failed:", err);
        }
    }
</script>
<!--新皮肤样式-->
<script src="https://static1.weizan.cn/zhibo/livecontent/skinset/js/skinset.js?ver=638498302430485833"></script>
<link rel="stylesheet" href="https://static1.weizan.cn/zhibo/livecontent/skinset/css/skinset.css?ver=638498302430485833">
<script>
    var sourceLangPath = 'https://static1.weizan.cn/zhibo/livecontent'
</script>
<script src="https://static1.weizan.cn/zhibo/livecontent/pc/js/language.js?v=638498302430485833"></script>
<script src="https://static1.weizan.cn/zhibo/livecontent/pc/js/vzan.i18n.js?v=638498302430485833"></script>
<script src="https://static1.weizan.cn/zhibo/livecontent/js/memberPoints/memberPointsNew.js?v=638498302430485833"></script>
<script src="https://static1.weizan.cn/zhibo/livecontent/js/useTime/b64md5.js?v=638498302430485833"></script>
<script src="https://static1.weizan.cn/zhibo/livecontent/js/useTime/useTimelong.js?v=638498302430485833"></script>
<!-- 请求接口 如果响应code 403 禁止页面访问 -->
<script async src="https://static1.weizan.cn/zhibo/livecontent/js/liveIsEmbed/index.js?v=638498302430485833"></script>
    <!--消息模板-->
    <script type="text/template" id="tpl_normalmsg">
        $${Msg|showTime_build}
        {#if Msg.msgtype==6}
        <li class="news-alert-red-packet reward" data-msgtype="$${Msg.msgtype}" attr-id="$${Msg.Ids}" attrtime="$${Msg.Id}" attrcreateby="$${Msg.userId}" data-addtime="$${Msg.addtime}"
            data-nickname="$${Msg.nickname}" data-parentid="$${Msg.ParentId}">
            <span data-myself="false" data-imgurl="$${UserInfo.headimgurl}" data-money="$${Msg.content}" data-response="" data-who="$${Msg.tnickName}">
                    <i>
                        <i class="little-red-packet"></i><var>$${UserInfo.nickname}</var>赞赏了 <var>$${ Msg.tnickName}</var>一个 <em>
                            $${ parseFloat(Msg.content / 100).toFixed(2)}
                            元红包
                        </em>
                    </i>

            </span>
        </li>
        {#else if Msg.msgtype==41}
        <li class="news-alert-red-lettery lettery" style="width:100%;" data-msgtype="$${Msg.msgtype}" attrtime="$${Msg.Id}" attr-id="$${Msg.Ids}" data-addtime="$${Msg.addtime}">
            <span><i class="little-red-lettery"></i><var>$${UserInfo.nickname}</var>抽中了<em> $${Msg.content}</em></span>
        </li>
        {#else if Msg.msgtype==13}
        {#if Msg.userId==_zbvd.userid&&Msg.tuserId != _zbvd.userid}
        <li class="news-alert-red-packet redbag" data-msgtype="$${Msg.msgtype}" rid="$${Msg.ParentId}" attrtime="$${Msg.Id}">
                <span><i class="little-red-packet"></i><var>$${Msg.tnickName}</var>领取了<var>你的</var><em> $${parseFloat(Msg.content/100).toFixed(2)}元红包</em></span>


        </li>
        {#else if Msg.tuserId == _zbvd.userid}
        {#if Msg.tuserId==Msg.userId}
        <li class="news-alert-red-packet redbag" data-msgtype="$${Msg.msgtype}" rid="$${Msg.ParentId}" attrtime="$${Msg.Id}">
            <span><i class="little-red-packet"></i><var>你</var>领取了<var>自己发的</var>一个<em> $${parseFloat(Msg.content/100).toFixed(2)}元红包</em></span>
        </li>
        {#else}
        <li class="news-alert-red-packet redbag" data-msgtype="$${Msg.msgtype}" rid="$${Msg.ParentId}" attrtime="$${Msg.Id}">
                <span><i class="little-red-packet"></i><var>你</var>领取了<var>$${Msg.nickName}</var>的<em> $${parseFloat(Msg.content/100).toFixed(2)}元红包</em></span>

        </li>
        {#/if}
        {#else}
        <li class="news-alert-red-packet redbag" data-msgtype="$${Msg.msgtype}" rid="$${Msg.ParentId}" attrtime="$${Msg.Id}">
                <span><i class="little-red-packet"></i><var>$${Msg.tnickName}</var>领取了<var>$${Msg.nickName}</var>的<em> $${parseFloat(Msg.content/100).toFixed(2)}元红包</em></span>

        </li>
        {#/if}
        {#else if Msg.msgtype==62}
        <li class="news-alert-red-packet" data-msgtype="$${Msg.msgtype}" attrtime="$${Msg.Id}">
                <span><i class="little-red-packet"></i><var>$${Msg.tnickName}</var>领取了<em style="color: #d84e43;"> 观看奖励红包</em></span>

        </li>
        {#else if Msg.msgtype==0}
        <li class="news-alert-time" data-msgtype="$${Msg.msgtype}" attrtime="$${Msg.Id}" attr-id="$${Msg.Ids}" data-addtime="$${Msg.addtime}">
            <span>$${Msg.content}</span>
        </li>
        {#else if Msg.msgtype==7}
        <li class="news-alert-time" data-msgtype="$${Msg.msgtype}" attrtime="$${Msg.Id}" attr-id="$${Msg.Ids}" data-addtime="$${Msg.addtime}">
            <span>直播已结束</span>
        </li>
        {#else if Msg.msgtype==25}

        <!--投票消息内容模板-->
        <!--投票消息内容-新版pc(实时推送)  -start-->
        <li voteid="$${Msg.VoteInfo.VoteId}" datatype="$${Msg.VoteInfo.DataType}" votetype="$${Msg.VoteInfo.VoteType}" votetype_name="$${Msg.VoteInfo.VoteType_Name}"
            class="d-flex" vtid="$${Msg.tuserId}" data-msgtype="$${Msg.msgtype}" attrtime="$${Msg.Id}" attr-id="$${Msg.Ids}" data-addtime="$${Msg.addtime}">
            <div class="marry-chat-content clearfix d-flex" style="width: 100%;">
                <img src="$${Msg.UserInfo.headimgurl}" alt="" class="userphoto" />
                {#if Msg.UserInfo.RoleId>0&&_zbvd.IsOpenShang}
                <img class="swiper-lazy RoleShang swiper-lazy-loaded" data-hostuserid="$${Msg.UserInfo.userId}" data-hostusername="$${Msg.UserInfo.nickname}" data-hostimg="$${Msg.UserInfo.headimgurl}" src="https://static1.weizan.cn/zhibo/livecontent/livecommon/images/shangLogo.png">
                {#/if}

                <div class="flex">
                    <span class="nickname">
                        <em class="rolename"> $${Msg.UserInfo.RoleName}</em>
                        $${Msg.UserInfo.nickname}
                    </span>
                    <div class="test-paper" name="divVoteConta" voteid="$${Msg.VoteInfo.VoteId}" datatype="$${Msg.VoteInfo.DataType}" votetype="$${Msg.VoteInfo.VoteType}" votetype_name="$${Msg.VoteInfo.VoteType_Name}">
                        <div class="test-paper-one">
                            <div class="paper-one-img">
                                <!-- <img src="https://static1.weizan.cn/zhibo/livecontent/redpackage/img/hongbao_ico.png" alt=""> -->
                                <img src="https://static1.weizan.cn/zhibo/livecontent/img/PcLiveIcon/vote-icon.svg">
                            </div>
                            <div class="paper-one-title">
                                <p class="paper-one-titleP1">$${Msg.content}</p>
                                <p class="paper-one-titleP2">点击投票</p>
                            </div>
                        </div>
                        <div class="test-paper-two">$${Msg.VoteInfo.VoteType_Name}</div>
                    </div>
                </div>
            </div>
        </li>
        {#else}

        <li class="d-flex" data-msgtype="$${Msg.msgtype}" tempid="$${tempid}" attr-id="$${Msg.Ids}" attr-time="$${Msg.Id}" attrcreateby="$${Msg.userId}" data-addtime="$${Msg.addtime}" attr-uid="$${Msg.userId}">

            {#if Msg.msgtype==1}
            <div class="marry-chat-content clearfix d-flex">
                <img src="$${Msg.Duration==-2?Msg.tnickName:UserInfo.headimgurl}" alt="" class="userphoto" style="display:block" />
                <div class="flex">
                    <span class="nickname pd-ellipsis-1">
                        {#if _zbvd.roleid>0&&Msg.Duration<0}
                        <i style="width: 8px;height: 8px;background: #0084ff;display: inline-block;border-radius: 50%;"></i>
                        {#/if}
                        {#if Msg.userId <= 0 && Msg.Duration != -2}
                        <span style="background: #00B849;border-radius: 2px;color: #fff;padding: 0 2px;" >游客</span>
                        {#/if}
                        {#if ((UserInfo.RoleName!='访客'&&UserInfo.RoleName!='')||Msg.commentType==4) && Msg.Duration != -2}
                            {#if Msg.commentType==4}
                                <em class="rolename i18n" name="Role.name.teacher">讲师</em>
                            {#else if UserInfo.RoleName=='管理员'}
                                <em class="rolename i18n" name="Role.name.administrator">$${UserInfo.RoleName}</em>
                            {#else if UserInfo.RoleName=='嘉宾'}
                                <em class="rolename i18n" name="Role.name.guest">$${UserInfo.RoleName}</em>
                            {#else if UserInfo.RoleName=='摄影师'}
                                <em class="rolename i18n" name="Role.name.cameraman">$${UserInfo.RoleName}</em>
                            {#else if UserInfo.RoleName=='主持人'}
                                <em class="rolename i18n" name="Role.name.compere">$${UserInfo.RoleName}</em>
                            {#else if UserInfo.RoleName=='新娘'}
                                <em class="rolename i18n" name="Role.name.bride">$${UserInfo.RoleName}</em>
                            {#else if UserInfo.RoleName=='新郎'}
                                <em class="rolename i18n" name="Role.name.groom">$${UserInfo.RoleName}</em>
                            {#else if UserInfo.RoleName=='直播助理'}
                                <em class="rolename i18n" name="Role.name.assistant">$${UserInfo.RoleName}</em>
                            {#else}
                                <em class="rolename i18n"> ${UserInfo.RoleName}</em>
                            {#/if}
                        <!-- <em class="rolename ${UserInfo.RoleName=='管理员'?'i18n':''}" name="Role.name.administrator"> $${Msg.commentType==4?'讲师':UserInfo.RoleName}</em> -->
                        {#/if}
                            <i> $${Msg.Duration==-2?Msg.nickName:UserInfo.nickname}</i>
                    </span>
                    <div class="msg-content ${Msg.ParentId!=''?'huifu':''}">
                        {#if Msg.ParentId!=""}
                            <div class="msg-content-wen">「 $${ReplyMsg.nickName}: $${ReplyMsg.content} 」</div>
                        <div class="msg-content-huifu">回复：<span class="text-content">$${Msg.content}</span></div>
                        {#else}
                        <span class="text-content">$${Msg.content}</span>
                        {#/if}

                        <div class="nhzb-redline-all">
                            <div class="nhzb-redline"></div>
                            {#if UserInfo.userId%2==0}
                            <div class="nhzb-lantern"></div>
                            {#else}
                            <div class="nhzb-hen"></div>
                            {#/if}
                        </div>

                    </div>
                </div>
            </div>
            {#if loginuserid!='' &&(loginuserid==UserInfo.userId||_zbvd.levels==1||_zbvd.isadmin)}
            {#if Msg.msgtype!=15&&Msg.msgtype!=16&&Msg.msgtype!=17}
            <div class="marry-chat-delete"><a href="javascript:;"></a></div>
            {#/if}
            {#/if}
            {#else if Msg.msgtype==16}
            <div class="new-gift-msg">
                <div>
                    <!-- 主播名字和礼物单位需要填充数据 -->
                        <!-- 横屏 -->
                            <span>
                                $${UserInfo.nickname.slice(0, 8)}
                                $${UserInfo.nickname.length > 8 ? '...':''}
                            </span>
                            <span>送了</span>
                            <span>
                                $${Msg.tnickName.slice(0, 8)}
                                $${Msg.tnickName.length > 8 ? '...':''}
                            </span>
                    <img src="$${Msg.gift.GiftImgUrl}" style="margin:0;width:26px;" />
                    <span>×$${Msg.gift.GiftCount}</span>
                </div>
            </div>            
            {#else if Msg.msgtype==17}
            <div class="marry-chat-content d-flex giftmsg">
                <img src="$${UserInfo.headimgurl}" alt="" class="userphoto" />
                <div class="flex">
                    <span class="nickname">
                        {#if UserInfo.RoleName!='访客'&&UserInfo.RoleName!=''}
                        <em class="rolename"> $${UserInfo.RoleName}</em>
                        {#/if}
                        $${UserInfo.nickname}
                    </span>
                    <div class="msg-content">
                        $${Msg.content}
                    </div>
                </div>

            </div>
            {#else if Msg.msgtype==2}
            <div class="marry-chat-content d-flex giftmsg">
                <img src="$${Msg.Duration==-2?Msg.tnickName:UserInfo.headimgurl}" alt="" class="userphoto" />
                <div class="flex">
                    <span class="nickname">
                        {#if _zbvd.roleid>0&&Msg.Duration<0}
                        <i style="width: 8px;height: 8px;background: #0084ff;display: inline-block;border-radius: 50%;"></i>
                        {#/if}
                        {#if ((UserInfo.RoleName!='访客'&&UserInfo.RoleName!='')||Msg.commentType==4) && Msg.Duration != -2}
                        <em class="rolename"> $${Msg.commentType==4?'讲师':UserInfo.RoleName}</em>
                        {#/if}
                        $${Msg.Duration==-2?Msg.nickName:UserInfo.nickname}
                    </span>
                    <div class="msg-content">
                        <img src="$${Msg.content}" fullsrc="$${Msg.content}" class="chat-msg-img" height="150" />
                        <div class="nhzb-redline-all">
                            <div class="nhzb-redline"></div>
                            {#if UserInfo.userId%2==0}
                            <div class="nhzb-lantern"></div>
                            {#else}
                            <div class="nhzb-hen"></div>
                            {#/if}
                        </div>
                    </div>
                </div>

            </div>
            {#else if Msg.msgtype==12}
            <div class="marry-chat-content d-flex giftmsg">
                <img src="$${UserInfo.headimgurl}" alt="" class="userphoto" />
                <div class="flex">
                    <span class="nickname">
                        {#if UserInfo.RoleName!='访客'&&UserInfo.RoleName!=''}
                        <em class="rolename"> $${UserInfo.RoleName}</em>
                        {#/if}
                        $${UserInfo.nickname}
                    </span>
                    <div class="msg-content">
                        $${Msg|showFile_build}
                    </div>
                </div>

            </div>
            {#else if Msg.msgtype==15}
            <div class="marry-chat-content d-flex">
                <img src="$${UserInfo.headimgurl}" alt="" class="userphoto" />
                <div class="flex">
                    <span class="nickname">
                        {#if UserInfo.RoleName!='访客'&&UserInfo.RoleName!=''}
                        <em class="rolename"> $${UserInfo.RoleName}</em>
                        {#/if}
                        $${UserInfo.nickname}
                    </span>
                    <div class="content-redpacket" red-type="$${Msg.MsgInfo.red_type}" style="$${Msg.MsgInfo.red_type == 8?('background-image:url('+Msg.MsgInfo.bubblecover+')'):''}">
                        <ul class="bz d-flex rpna-ul hongbao" rid="$${Msg.ParentId}">
                            <li class="rpna-pic">
                                <img src="https://static1.weizan.cn/zhibo/livecontent/redpackage/img/hongbao_icon_1.png?v=1" style="width: 100%;">
                                <!-- <img src="https://static1.weizan.cn/zhibo/livecontent/redpackage/img/hongbao_ico.png" style="width: 100%;"> -->
                            </li>
                            <li class="flex" style="padding-left: 1rem;line-height: 1.5;">
                                <p class="rena-wish">$${Msg.MsgInfo.red_type == 8?Msg.MsgInfo.wish:Msg.MsgInfo.red_type == 5?'参与答题，领取红包':Msg.MsgInfo.content}</p>
                                <p style="font-size: 1.2rem;"><span>领取红包</span></p>
                            </li>
                        </ul>
                        <div class="white-top">$${Msg.MsgInfo.red_type == 8 ? Msg.MsgInfo.companyname :Msg.MsgInfo.red_type == 5?'答题红包':'直播间红包'}</div>
                    </div>
                </div>
            </div>
            {#else if Msg.msgtype==49}
            <div class="marry-chat-content d-flex">
                <img src="$${Msg.UserInfo.headimgurl}" alt="" class="userphoto" />
                <div class="flex">
                    <span class="nickname">
                        {#if Msg.UserInfo && Msg.UserInfo.RoleName != '访客' && Msg.UserInfo.RoleName!=''}
                        <em class="rolename"> $${UserInfo.RoleName}</em>
                        {#/if}
                        $${Msg.UserInfo.nickname}
                    </span>
                    <div class="content-redpacket">
                        <ul class="bz d-flex rpna-ul answer" onclick="ShowQrCode('answer')" rid="$${Msg.ParentId}">
                            <li class="rpna-pic">
                                <img src="https://static1.weizan.cn/zhibo/livecontent/img/PcLiveIcon/guess-icon.svg" style="width: 100%;">
                            </li>
                            <li class="flex" style="padding-left: 1rem;line-height: 1.5;">
                                <p class="rena-wish">参与竞猜领取奖励！</p>
                                <p style="font-size: 1.2rem;"><span>点击答题</span></p>
                            </li>
                        </ul>
                        <div class="white-top">直播间竞猜</div>
                    </div>
                </div>
            </div>
            <!--<a class="remove-msg"></a>-->
            {#else if Msg.msgtype==3}

            <div class="marry-chat-content clearfix d-flex">
                <img src="$${UserInfo.headimgurl}" alt="" class="userphoto" />
                <div class="flex">
                    <span class="nickname">
                        {#if UserInfo.RoleName!='访客'&&UserInfo.RoleName!=''}
                        <em class="rolename"> $${UserInfo.RoleName}</em>
                        {#/if}
                        $${UserInfo.nickname}
                    </span>
                    <div class="msg-content">
                        <div class="recordingMsg recordwid3">
                            <i class="audio_info" data-src="$${Msg.voice.TransFilePath}"></i>
                            <var>$${Msg.voice.VoiceTime|showVoice_build}</var>
                        </div>

                    </div>
                </div>
            </div>

            {#/if}
            {#if isreward}
            <a class="btn_ilike" href="javascript:;"></a>
            {#/if}
        </li>
        {#/if}
    </script>
    <!--/消息模板-->
    <!-- <div class="direct-one">
        <div class="direct-security d-flex justify-sb">
            <div class="direct-one-zhibo ellipsis"><i class="iconhuatimingcheng iconfont"></i>趵突泉</div>
            <div class="rel direct-one-personal">
                    <div class="to-login show-out-pop" data-type="login">登录</div>
            </div>
        </div>
    </div> -->
    <div class="direct-security live-info-state d-flex justify-sb">
        <!-- <div class="live-info-num d-flex flexdr">
            <div class="d-flex live-state-icontips">
                    <i class="iconzhibozhong iconfont"></i>
                    <span>直播中</span>
            </div>
            <div class="d-flex">
                <i class="iconshijian iconfont"></i>
                <span>2023-04-14 20:37:38</span>
            </div>
                <div class="d-flex">
                    <i class="iconguankanrenshu iconfont"></i>
                    <span class="online_number">886人气</span>
                </div>
        </div> -->

        <div class="live-topic-info d-flex">
            <!--                 <div style="line-height: 24px;cursor: pointer;" class="d-flex flexdr live-info-top align-sc mag-R10">
                    <img class="circle" src="https://i2.vzan.com/image/liveImage/png/20230308/71ec29fb1919401bbc3721ab080fbb76.png" />
                    <span class="cfff">山东高锋科技发展有限公司</span>
                </div>
 -->
            <!-- <div class="d-flex flexdr live-follow">
                    <div class="d-flex flexdr">
                        <i class="iconguanzhushu cfff align-sc iconfont"></i>
                        <span class="cfff">2.11万</span>
                    </div>
                    <div class="set-following cfff focus">+关注</div>
            </div> -->
        </div>
    </div>
    <div class="direct-three" style="padding-top: 0px">
        <div class="direct-security clearfix">
                <div id="pd-right-fixed-id-1" v-cloak class="pd-right-fixed-1" v-on:mouseleave="pdRightMenuleave1">
                    <template v-if="isShowCustomerService">
                        <div v-bind:class="['pd-chat', pdRightMenuCurrent1 === 'customer' ? 'hover-active' : null]"
                             v-on:mouseenter="pdRightMenuEnter1('customer')">
                            <i style="font-size: 24px;" class="iconfont iconkefu"></i>
                            <div class="mt-8 i18n" name="customer.service.name">客服</div>
                        </div>
                        <div class="pd-split"></div>
                    </template>
                    <div v-bind:class="['pd-phone', pdRightMenuCurrent1 === 'phone' ? 'hover-active' : null]"
                         class="pd-phone"
                         v-on:mouseenter="pdRightMenuEnter1('phone')">
                        <i style="font-size: 24px;" class="iconfont iconshoujikan1"></i>
                        <div class="mt-8 i18n" name="mobile.name">手机看</div>
                    </div>
                    <div class="pd-split"></div>
                    <div class="pd-mine" v-on:mouseenter="pdRightMenuEnter1('mine')">
                            <div class="to-login show-out-pop" data-type="login">
                                <i style="font-size: 24px;" class="iconfont icongerenzhongxin"></i>
                                <div class="to-login mt-8 i18n" name="login.name">登录</div>
                                <!-- show-out-pop data-type="login" -->
                            </div>
                    </div>
                    <!-- hover客服 -->
                    <div class="pd-customer-popover"
                         v-show="pdRightMenuCurrent1 === 'customer'"
                         v-on:mouseenter="pdRightMenuSover1"
                         v-on:mouseleave="pdRightMenuleave1">
                        <div class="triangle"></div>
                        <h4 v-if="drainSet && drainSet.title" class="drain-tit">{{ drainSet.title }}</h4>
                        <img class="qrcode" :src="drainSet && drainSet.qrCodeUrl" />
                        <div v-if="drainSet && drainSet.desc" class="tip i18n">{{ drainSet.desc }}</div>
                        <div v-if="drainSet && drainSet.contactPhone" class="phone">
                            <i class="iconfont icondianhua"></i>
                            <div class="split"></div>
                            <div class="phone-number">{{ drainSet && drainSet.contactPhone }}</div>
                        </div>
                    </div>
                    <!-- hover手机看 -->
                    <div class="pd-phoneplay-popover"
                         v-show="pdRightMenuCurrent1 === 'phone'"
                         v-on:mouseenter="pdRightMenuSover1"
                         v-on:mouseleave="pdRightMenuleave1">
                        <div class="triangle"></div>
                        <div class="qrcode-box">
                            <div class="wechat-qrcode-box">
                                <img :src="qrcodeList.phone.qrcodeurl" />
                                <div class="tip i18n" name="wx.watch.name">微信端观看</div>
                            </div>
                        </div>
                        <div class="copy-box">
                            <div class="link">{{shareUrl}}</div>
                            <div class="btn btn_copy i18n" name="copy.btn.name">复制</div>
                        </div>
                    </div>
                    <!-- hover我的 -->
                    <div class="pd-mine-popover"
                         v-show="pdRightMenuCurrent1 === 'mine'"
                         v-on:mouseenter="pdRightMenuSover1"
                         v-on:mouseleave="pdRightMenuleave1">
                        <div class="triangle"></div>
                        <div class="popover-item">
                                <a>
                                    <i style="font-size: 24px;" class="iconfont icongerenzhongxin"></i>
                                    <div class="to-login show-out-pop i18n" name="login.name" data-type="login">登录</div>
                                </a>
                        </div>
                        <div class="split"></div>
                    </div>
                </div>
            <!--                 <div style="line-height: 24px;cursor: pointer;" class="d-flex flexdr live-info-top align-sc mag-R10">
                    <img class="circle" src="https://i2.vzan.com/image/liveImage/png/20230308/71ec29fb1919401bbc3721ab080fbb76.png" />
                    <span class="cfff">山东高锋科技发展有限公司</span>
                </div>
 -->


            <div id="viewcontent" style="display:flex;justify-content: center;margin-bottom: 16px;">
                <div style="margin-bottom: 0px;" class="pd-viewcontent-left themeBackground-b">
                    <div id="pcLiveRoomInfoArea" class="pd-viewcontent-left-info">


                        <div class="pd-text-info">
                            <div class="pd-text-info-top">
                                <div class="pd-text-info-top-title pd-ellipsis-1">
                                    趵突泉&#x2B;天下第一泉
                                </div>
                                    <div class="pd-text-info-top-tag i18n" name="Live.name">直播中</div>
                            </div>
                            <div class="pd-text-info-bottom">
                                    <div class="pd-views item" style="white-space: nowrap">
                                        <i class="iconliveop iconredu"></i>
                                        <div>
                                            <a style="cursor:auto;" title="886">886 <span class="i18n" name="heat.text.name">热度</span></a>
                                        </div>
                                    </div>
                                <div class="pd-datetime item" style="white-space: nowrap">
                                    <i class="iconfont iconzhiboshijian"></i>
                                    <div>
                                        <a style="cursor:auto;" title="2023-04-14 20:37" class="i18n-dynamic" data-zh_CN="2023.04.14 20:37" data-en_US="04.14.2023 20:37">
                                            2023.04.14 20:37
                                        </a>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div v-cloak id="pd-lang-id" class="pd-lang-box" v-if="showButton">
                            <el-popover v-model="langVisible"
                                        :append-to-body='false'
                                        :visible-arrow="false"
                                        placement="bottom"
                                        popper-class="no-padding-popover"
                                        trigger="click">
                                <div class="handel-items">
                                    <div class="handel-item" @click="changeLanguage('zh_CN')">
                                        <i class="iconfont iconqhyw"></i>
                                        <span>简体中文</span>
                                    </div>
                                    <div class="handel-item" @click="changeLanguage('en_US')">
                                        <i class="iconfont iconqhzw"></i>
                                        <span>English</span>
                                    </div>
                                </div>
                                <div slot="reference" class="pd-lang">
                                    <i class="iconfont" :class="languageValue=='zh_CN'?'iconqhyw':'iconqhzw'"></i>
                                    <span class="i18n" name="language.btn.name">切换语言</span>
                                </div>
                            </el-popover>
                        </div>
                        <div id="pd-share-id" v-cloak class="pd-like-share">
                            <div class="pd-like-box">
                                <!--&lt;!&ndash; 引流二维码弹框 &ndash;&gt;-->
                                <template v-if="getTopicQRCodeShow">
                                    <div class="qrcode-popupp" style="display: flex; justify-content: center; align-items: center">
                                        <div class="qrCodeDialog">
                                            <h2 v-if="drainSet && drainSet.title" class="qr-title">{{drainSet.title}}</h2>
                                            <div class="qr-code-box">
                                                <img v-if="drainSet && drainSet.qrCodeUrl" class="qr-code" :src="drainSet.qrCodeUrl" alt="">
                                            </div>
                                            <p v-if="drainSet && drainSet.desc" class="qr-desc">{{ drainSet.desc }}</p>
                                            <div class="popup-line"></div>
                                            <img class="popup-closed" src="https://static1.weizan.cn/zhibo/static/img/live/drainset/drain-close.png" @click="getTopicQRCodeShow = false" />
                                        </div>
                                    </div>
                                </template>
                                <template v-if="(AttentionLiveSwitch || CustomImageSwitch)">
                                    <template v-if="AttentionLiveSwitch && !CustomImageSwitch">
                                        <div v-if="isFocus" class="pd-like show-out-pop">
                                            <i class="pd-like-icon iconfont iconguanzhu"></i>
                                            <div class="pd-like-text i18n" name="follow.text.name">{{ drainSet && (drainSet.focusTxt || '已关注') }}</div>
                                        </div>
                                        <div v-else @click="focusCurrentLive" class="pd-like show-out-pop" data-type="focusCurrentLive" isfocus="0">
                                            <i class="pd-like-icon iconfont iconguanzhu"></i>
                                            <div class="pd-like-text">{{ drainSet && (drainSet.btnTxt || '+ 关注') }}</div>
                                        </div>
                                    </template>
                                    <template v-else>
                                        <div v-if="AttentionLiveSwitch && !isFocus" @click="focusAndShowAttention" class="pd-like show-out-pop" data-type="focusAndShowAttention" isfocus="0">
                                            <i class="pd-like-icon iconfont iconguanzhu"></i>
                                            <div class="pd-like-text">{{ drainSet && (drainSet.btnTxt || '+ 关注') }}</div>
                                        </div>
                                        <div v-else @click="getTpQrcode" class="pd-like show-out-pop" data-type="showAttentionDialog">
                                            <i class="pd-like-icon iconfont iconguanzhu"></i>
                                            <div class="pd-like-text i18n" name="follow.text.name">{{ drainSet && (drainSet.focusTxt || '已关注') }}</div>
                                        </div>
                                    </template>
                                </template>
                            </div>
                            <!--强制关注公众号二维码-->
                            <div id="IsShowConcernLook" v-if="isShowConcernLook && !isSubscribe">
                                <div class="popup-forcefocus layui-m-anim-scale popup-show">
                                    <div class="popup">
                                        <span class="focus-on-click"></span>
                                        <div class="popup-head">
                                            <h3 class="popup-title">长按识别二维码，立刻观看</h3>
                                            <span style="font-size: 12px;line-height: 3rem;">关注公众号后将收到直播推送</span>
                                        </div>
                                        <div class="popup-body"><img :src="drainSet && drainSet.qrCodeUrl" style="max-width:100%;max-height:200px;"></div>
                                    </div>
                                </div>
                            </div>
                                <div class="pd-share-box">
                                    <div class="pd-share"
                                         v-on:mouseenter="pdShareEnter"
                                         v-on:mouseleave="pdShareLeave">
                                        <i v-bind:class="['pd-share-icon', 'iconfont', 'iconfenxiang2', sharePdPopUp ? 'share-active': null]"></i>
                                        <div v-bind:class="['pd-share-text', sharePdPopUp ? 'share-active i18n': 'i18n']" name="shareBtn.name">分享</div>
                                    </div>

                                    <div class="pd-share-popup"
                                         v-show="sharePdPopUp"
                                         v-on:mouseleave="pdShareLeave"
                                         v-on:mouseenter="pdShareSover">
                                        <div class="pd-share-popup-top">
                                            <div class="pd-popup-top-title i18n" name="shareBtn.name">分享至</div>
                                            <div class="pd-popup-del"></div>
                                        </div>
                                        <div class="pd-share-zoom bdsharebuttonbox">
                                            <div class="pd-share-qq" @click="track()">
                                                <a href="javascript:;" class="qq" data-cmd="qzone" title="分享到QQ空间">
                                                    <img src="https://static1.weizan.cn/zhibo/livecontent/img/pcLive/qq_zoom_icon.png" />
                                                    <div class="i18n" name="qzone.name">QQ空间</div>
                                                </a>
                                            </div>
                                            <div class="pd-share-weibo" @click="track()">
                                                <a href="javascript:;" class="weibo" data-cmd="tsina" title="分享到新浪微博">
                                                    <img src="https://static1.weizan.cn/zhibo/livecontent/img/pcLive/weibo_icon.png" />
                                                    <div class="i18n" name="sina.name">新浪微博</div>
                                                </a>

                                            </div>
                                        </div>
                                        <div class="pd-copy-btn-title">
                                            <div class="title i18n" name="watch.btn.name">观看链接</div>
                                            <div class="btn btn_copy i18n" name="copy.btn.name" @click="track()">复制</div>
                                        </div>
                                        <div class="pd-copy-link" v-text="shareUrl"></div>
                                    </div>
                                </div>
                        </div>
                    </div>
                    <div class='direct-three-left-height flex rel'>


                        <div class='abs direct-three-left-end direct-three-left-end-height' id="videomsgtip" style="display: none">
                            <p class="f-18px cfff rel" style="color:#F3B115;font-size:18px;" id="videomsgtip-content"></p>
                            <!-- 弹幕显示开关 -->
                        </div>
                        <div class="direct-three-left-video videowrap rel d-flex d-flex-center" style="background-color:#000;position:relative;">
                            <span class="plan-name" data-title="趵突泉5G&#x2B;VR天下第一泉" data-qrname=""></span>
                            <div class="danmuBox">
                                <div class="dm" style="color:#17042d;animation-iteration-count:1;"></div>
                            </div>
                            <!-- 红包雨进行中 -->
                            <div id="pc-rain-countdown">
                                <i></i>
                                <span>60</span>s
                            </div>
                            <!-- 跑马灯容器 -->
                            <div id="horse-box"></div>

                            <!-- 新版 欢迎消息系统 -->
                            <div id="newSidetipApp" v-cloak>
                                <div class="my-slide-container" style="position:absolute;top:40px;left:10px;">
                                    <div style="width: 600px;">
                                        <transition name="myslide">
                                            <div class="welcome" v-if="currentItem.tag&&tipstyleType=='normal'">
                                                <div class="bg-box">
                                                        <div class="wel-text">
                                                            {{currentItem.nickname}}
                                                        </div>
                                                </div>
                                            </div>
                                            <div class="welcome" v-else-if="currentItem.tag&&tipstyleType=='sign'">
                                                <div class="bg-box-sign">
                                                    <img class="wel-sign-icon" src="https://static1.weizan.cn/zhibo/livecontent/signin/img/sign_tipstar.png" alt="">
                                                        <div class="wel-sing-text">
                                                            {{currentItem.nickname}}
                                                            <span style="color: #0A2F61;">{{signMessage}}</span>
                                                        </div>

                                                </div>
                                            </div>
                                        </transition>
                                    </div>
                                </div>
                            </div>
                            <!-- 多会场 -->
                                <div id="sceneArea" v-cloak class="scene-area" v-if="isopenScene && sceneList.length>0 && islanguage">
                                    <div class="scene-tab" @click="$('#sceneArea').toggleClass('open')">
                                        <span style="line-height:1.5;">中<br />or<br />EN</span>
                                        <i class="toright"></i>
                                    </div>
                                    <div class="scene-list">
                                        <div class="scene-item" v-for="(item,index) in sceneList" :key="'scene'+item.Id" :class="{'on':index==activeScene}"
                                             :style="'background-image:url('+ item.Cover +')'" @click="changeLanguageTopic(item)">
                                            <p class="scene-title">
                                                <!-- <img :src="'https://static1.weizan.cn/zhibo/livecontent/livecommon/img/lang/lang_icon_'+((item.LangType+1)||1)+'.png'" style="width:18px;height:18px;margin-right:5px;" /> -->
                                                {{item.LangTypeName}}
                                            </p>
                                            <div class="stateLive" :class="item.livestatus|fitStatus(item)"></div>
                                        </div>
                                    </div>
                                </div>

                            <p class="cfff rel" id="playerloading" style="display:none;font-size: 28px; position: absolute;z-index:0; left: 50%; top: 50%; -moz-transform: translate(-50%,-50%); -ms-transform: translate(-50%,-50%); -o-transform: translate(-50%,-50%); -webkit-transform: translate(-50%,-50%); transform: translate(-50%,-50%);">
                                <img src="https://static1.weizan.cn/zhibo/livecontent/livecommon/images_pc/smal-writing-010.png" style="vertical-align: -10px;margin-right: 10px">视频加载中...
                            </p>
                            <!--倒计时-->
                            <div class="timeover" id="div_live_status" style="display:none;" data-starttime="2023-04-14 20:37:38">
                                <div class="rel timewrap isCountdown">
                                    <span class="rel"><var style="margin-right:5px" class="qlDays yelloColor">00</var><span class="i18n" name="day.name">天</span></span>
                                    <span class="rel"><var style="margin-right:5px" class="qlHours yelloColor">00</var><span class="i18n" name="hour.name">时</span></span>
                                    <span class="rel"><var style="margin-right:5px" class="qlMinutes yelloColor">00</var><span class="i18n" name="minute.name">分</span></span>
                                    <span class="rel"><var style="margin-right:5px" class="qlSeconds yelloColor">00</var><span class="i18n" name="second.name">秒</span></span>
                                    <span class="i18n" name="time.after.tip">开播</span>
                                </div>
                                <!-- 弹幕显示开关 -->
                            </div>

<link rel="stylesheet" href="https://static1.weizan.cn/zhibo/livecontent/vrplayer/css/index.css?ver=638498302430485833" />
<link rel="stylesheet" href="https://static1.weizan.cn/zhibo/livecontent/fonts/icon-op/iconfont.css?ver=638498302430485833" />

<style>
    .direct-three-right {
        flex-shrink: 0;
    }

    .direct-three-left-end {
        z-index: 6;
    }

    .get-rewards.enter {
        left: 10px !important;
        display: flex !important;
    }
</style>
<div id="vrplayer" style="width: 100%;height: 100%;position: relative;" v-cloak>
    <div id="vr"
         :class="{'mobile':ismobile||isWx('pc'),'full':iscrossscreen||isfullscreen,'livemode':liveMode,'isandroid':iscrossscreen && /android/i.test(navigator.userAgent)}"
         @mouseenter="showCtrl" @mouseleave="hideCtrl" @mousemove="showCtrl">
        <div id="vjs" style="display:none;"></div>
        <div v-if="(status==0||status==4)&&playUrl" class="vr-center play" @click="firstPlay"></div>
        <img v-if="status==0" :src="poster" class="vr-poster">
        <div class="vr-load" v-if="playUrl && onload">
            <i class="vr-loadicon"></i>
        </div>
        <section class="vr-control" v-show="status!=0&&(showControl||status!=1||onslide)" @click="showCtrl();showSpeed=false;">
            <div class="vr-bar-container" :class="{'vrlive':liveMode}">
                <div class="vr-bar">
                    <template v-if="!liveMode">
                        <div class="vr-playbar" :style="{width:per+'%'}">
                            <i class="vr-dot"></i>
                        </div>
                        <i class="vr-loadbar"></i>
                    </template>
                </div>
            </div>
            <div class="vr-bottom">
                <div class="vr-bottom-left">
                    <i class="vricon vr-btn" @click="togglePlay" :class="{'pause':status==1}"></i>
                    <div v-if="liveMode" class="vr-time">实时直播</div>
                    <div v-else class="vr-time">{{AVR.formatSeconds(curTime)||'00:00'}} / {{AVR.formatSeconds(video.duration)||'00:00'}}</div>
                </div>
                <div class="vr-bottom-right">
                    <div class="vr-voice-area" v-if="!ismobile">
                        <i class="vricon vr-voicebtn" :class="{'on':volume!=0}" @click="volume=(volume==0?1:0);"></i>
                        <div class="vr-voicebar-container">
                            <div class="vr-voicebar">
                                <div class="onvoice-bar" :style="{height:volume*100+'%'}">
                                    <i class="voice-dot"></i>
                                </div>
                            </div>
                        </div>
                    </div>
                    <i class="vricon vr-gyro" v-if="ismobile" :class="{'on':gyro}" @click="gyro=!gyro"></i>
                    <i class="vricon vr-vr" title="3D模式" :class="{'on':vr.vrmode}" @click="vr.vrmode=!vr.vrmode"></i>
                    <div class="vr-speed-container" v-if="!liveMode">
                        <i class="vricon vr-speed" :class="'speed'+speed.toString().replace('.','p')" @click.stop="showSpeed=!showSpeed"></i>
                        <ul class="vr-speed-option" v-show="showSpeed">
                            <li v-for="item in speedOption" @click="speed=item;showSpeed=false;"
                                :class="{'on':item==speed}">{{item+'x'}}</li>
                        </ul>
                    </div>
                    <i class="vricon vr-full" :class="{'on':isfullscreen||iscrossscreen}" @click="fullscreen"></i>
                </div>
            </div>
        </section>
        <section class="vr-shadow" v-show="showSpeed&&showControl" @click="showSpeed=false;"></section>
        <section class="vr-tip-area" v-if="opentip&&status==1" @mousedown="opentip=false;openVRFunc()">
            <i class="vr-tip"></i>
            <div class="vr-tiptext" :class="{'mobile':ismobile}">VR直播沉浸式观看体验，360°拖动试试吧</div>
        </section>
    </div>
</div>
<script src="https://static1.weizan.cn/zhibo/livecontent/videojs/7.6.0/video.min.js?ver=638498302430485833"></script>
<script src="https://static1.weizan.cn/zhibo/livecontent/vrplayer/js/three.min.js?ver=638498302430485833"></script>

<script src="https://static1.weizan.cn/zhibo/livecontent/plugin/Browser.js?v=638498302430485833"></script>
<script>Browser = { client: System };</script>
<script src="https://static1.weizan.cn/zhibo/livepage_resource/hls/hls.js"></script>
//
<!-- <script src="https://static1.weizan.cn/zhibo/livecontent/vrplayer/js/ptools.js"></script> -->
<script src="https://static1.weizan.cn/zhibo/livecontent/public/js/base.js?ver=638498302430485833"></script>

<script>
    var liveStatus='beginning';//不声明全局会报错 其他地方用到了
    var liveStyle = {
        playback: '<i class="iconhuifang vricon"></i><span>回放</span>',
        stop: '<i class="iconzhibozantingzhong vricon"></i><span>暂停中</span>',
        living: '<i class="iconzhibozhong vricon"></i><span>直播中</span>',
        notStart: '<i class="iconzhiboweikaishi vricon"></i><span>未开始</span>',
        ended: '<i class="iconhuifang vricon"></i><span>已结束</span>',
    }
    var vrParam = {
        playUrl:'https://www.gofront.net:4433/my-hls/room8.m3u8',
        livestatus:'beginning',
        mhost: "p2hs.vzan.com",
        playbackType:0

    }
    if(!window.liveinfo) {
      window.liveinfo = {
        livestatus: liveStatus
      }
    }
    var vrlive;
</script>
<script src="https://static1.weizan.cn/zhibo/livecontent/vrplayer/js/m2.js?ver=638498302430485833"></script>
<script src="https://static1.weizan.cn/zhibo/livecontent/vrplayer/js/mvr.js?ver=638498302430485833"></script>                        </div>

                        <div class="abs direct-three-left-follow" id="FocusQRCode">
                            <div class="direct-three-left-follow-end">
                                <img src="https://static1.weizan.cn/zhibo/livecontent/livecommon/images_pc/direct-three-11.png">
                            </div>
                            <p class="co33" style="font-size:16px;">关注公众号获得更多直播内容</p>
                            <img style="width:218px; height:218px;" src="https://static1.weizan.cn/zhibo/livecontent/content/live/img/ico-noQCode.png " class="direct-three-left-follow-tx">
                            <p style="justify-content:center;" class="f-14px co99">微信扫码即可关注公众号</p>
                        </div>

                        <div class="abs direct-three-left-follow" id="LoginQRCode">
                            <div class="direct-three-left-follow-end">
                                <img src="https://static1.weizan.cn/zhibo/livecontent/livecommon/images_pc/direct-three-11.png">
                            </div>
                            <p class="co33" style="font-size:16px;">扫码登录发评论</p>
                            <div id="WeixinSanQRCode" class="direct-three-left-follow-tx" style="display:flex;justify-content: center;"></div>
                            <p class="f-14px">微信扫描二维码登录</p>
                        </div>
                        <!-- <div style="position:absolute;top:0;" class="direct-three-left-bottom d-flex d-flex-center justify-sb">
                            <div class="dtfb-left d-flex">
                                    <div class="d-flex rel set-live-share">
                                        <i class="iconfont iconfenxiang"></i>
                                        <span class="i18n" name="shareBtn.name">分享</span>
                                        <div class="abs share-tips-wrap">
                                            <div class="d-flex flexdr justify-sb bdsharebuttonbox">
                                                <a href="javascript:;" class="share-to-zoon qq" data-cmd="qzone" title="分享到QQ空间"></a>
                                                <a href="javascript:;" class="share-to-weibo weibo" data-cmd="tsina" title="分享到新浪微博"></a>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="d-flex show-out-pop" data-type="phone">
                                        <i class="iconshoujikan iconfont"></i>
                                        <span class="i18n" name="mobile.name">手机看</span>
                                    </div>
                                    <div class="d-flex show-out-pop" data-type="wc">
                                        <i class="iconguanzhugongzhonghao iconfont"></i>
                                        <span>关注公众号</span>
                                    </div>
                            </div>
                            <div class="dtfb-right d-flex">
                                <div title="竞拍" style="display: none;" class="popper-icon auction auction-tomin auc_time" data-type="auction"></div>
                                <div title="在线抽奖" style="display: none;" class="popper-icon luck-draw show-out-pop lot_timea" data-type="luckdraw"></div>
                                <div title="场次抽奖" style="display: none;" class="popper-icon luck-draw-once show-out-pop lot_timeb" data-type="luckdraw" id="oldTurnIcon"></div>
                                <div title="场次抽奖" style="display: none;" class="popper-icon luck-draw-once show-out-pop lot_timeb" data-type="luckdraw" id="newTurnIcon"></div>
                                <div title="报名表" class="vertical-apply-icon" id="openformJava"  style="width: 24px;height: 24px;background-image:url(https://j.weizan.cn/livecontent/img/Addquestionnaire/icon1.png);margin-left: 30px;cursor: pointer;background-size: 100%;"></div>
                            </div>
                        </div> -->
                        <div style="width:128px;height:128px;display:none;" id="liveqr"></div>


                        <div id="pc-redbag-2021" v-cloak>
                            <div class="redbag-container">
                                    <div class="login-qrcode" v-show="showLogin">
                                        <img class="bg" src="https://static1.weizan.cn/zhibo/livecontent/content/images/pc-redbag-bg.png" alt="">
                                        <img class="qrcode" :src="qrcodeURL" />
                                    </div>
                                    <div class="no-login"
                                         @mouseenter="enterLogin"
                                         @mouseleave="leaveLogin"
                                         v-show="showNoLogin">
                                        <div class="redbag-btn-container">
                                            <img src="https://static1.weizan.cn/zhibo/livecontent/content/images/redbag-btn.png" />
                                            <div class="redbag-btn-text">登录领取</div>
                                        </div>
                                    </div>
                            </div>
                        </div>
                    </div>

                    <!-- 多会场 -->



                    <!-- 菜单 -->
<!-- https://static1.weizan.cn/zhibo/livecontent -->
<link rel="stylesheet" href="https://static1.weizan.cn/zhibo/livecontent/pc-menu/styles/style.css?ver=638498302430485833"/>
<link rel="stylesheet" href="https://static1.weizan.cn/zhibo/livecontent/pc-menu/styles/newYearTheme.css?ver=638498302430485833"/>
<link rel="stylesheet" href="https://static1.weizan.cn/zhibo/livecontent/pc-menu/styles/technologyBlue.css?ver=638498302430485833"/>
<link rel="stylesheet" href="https://static1.weizan.cn/zhibo/livecontent/pc-menu/styles/fashionGold.css?ver=638498302430485833"/>
<link rel="stylesheet" href="https://static1.weizan.cn/zhibo/livecontent/pc-menu/styles/noData.css?ver=638498302430485833"/>
<link rel="stylesheet" href="https://static1.weizan.cn/zhibo/livecontent/pc-menu/styles/recommendContentCard.css?ver=638498302430485833"/>
<link rel="stylesheet" href="https://static1.weizan.cn/zhibo/livecontent/pc-menu/styles/previewResource.css?ver=638498302430485833"/>
<link rel="stylesheet" href="https://static1.weizan.cn/zhibo/livecontent/pc-menu/styles/highlight.css?ver=638498302430485833"/>
<link rel="stylesheet" href="https://static1.weizan.cn/zhibo/livecontent/pc-menu/styles/ppt.css?ver=638498302430485833"/>
<link rel="stylesheet" href="https://static1.weizan.cn/zhibo/livecontent/pc-menu/styles/fullRichText.css?ver=638498302430485833"/>
<link rel="stylesheet" href="https://static1.weizan.cn/zhibo/livecontent/pc-menu/styles/recommendContent.css?ver=638498302430485833"/>
<link rel="stylesheet" href="https://static1.weizan.cn/zhibo/livecontent/pc-menu/styles/picLive.css?ver=638498302430485833"/>
<link rel="stylesheet" href="https://static1.weizan.cn/zhibo/livecontent/pc-menu/styles/specialColumn.css?ver=638498302430485833"/>

<!-- 菜单tab -->
<div id="pcMenu" v-cloak>
  <div class="pc-menu">
     <el-tabs v-model="activeTab" class="pc-tabs">
      <el-tab-pane 
        v-for="tab in tabs" 
        :key="tab.key" 
        :label="tab.name" 
        :name="tab.key"
      >
      </el-tab-pane>
    </el-tabs>
    
    <div class="pc-menu__content">
      <!-- 介绍菜单 , 直播合作-->
      <transition name="el-fade-in-linear">
          <template v-if="activeTabData && activeTabData.state == menuMap.INTRODUCE || activeTabData.state == menuMap.COOPERATION || activeTabData.state == menuMap.GRAPHICS">
            <full-rich-text v-if="activeTabData" :content="activeTabData.content"></full-rich-text>
          </template>

          <template v-if="activeTabData && activeTabData.state == menuMap.RECOMMEND">
            <recommend-content></recommend-content>
          </template>


          <template v-if="activeTabData && activeTabData.state == menuMap.COLUMN">
            <special-column></special-column>
          </template>


          <template v-if="activeTabData && activeTabData.state == menuMap.HIGHLIGHT">
            <highlight></highlight>
          </template>


          <template v-if="activeTabData && activeTabData.state == menuMap.PPT">
            <ppt ref="pptRef" :ppt-url="activeTabData.content"></ppt>
          </template>


          <template v-if="activeTabData && activeTabData.state == menuMap.IMG_TOPIC">
            <pic-live ref="picLiveRef" :pic-live-topic-id="activeTabData.content"></pic-live>
          </template>
      </transition>
    </div>
  </div>
</div>



<!-- 富文本组件：介绍菜单 , 直播合作 -->
<script	type="text/x-template" id="fullRichText">
  <div class="full-rich-text" v-html="content"></div>
</script>


<!-- 专栏 -->
<script	type="text/x-template" id="specialColumn">
  <div class="special-column">
    <template v-if="list.length">
      <div class="special-column__main">
        <recommend-content-card 
          v-for="item in list" 
          :key="item.Id"
          v-bind="item"
          can-click
          @click.native="handleCardClick(item)"
        ></recommend-content-card>
      </div>
      <div class="special-column__footer">
        <el-pagination
          background
          @current-change="handlePageChange"
          :current-page.sync="page"
          :page-size="size"
          layout="total, prev, pager, next"
          :total="total">
        </el-pagination>
      </div>
    </template>
    <no-data v-else></no-data>
  </div>
</script>


<!-- 推荐内容 -->
<script type="text/x-template" id="recommendContent">
  <div class="recommend-content">
    <template v-if="list.length">
      <div class="recommend-content__main">
        <recommend-content-card 
          v-for="item in list" 
          :key="item.id"
          v-bind="item"
          :can-click="true"
          @click.native="handleCardClick(item)"
        ></recommend-content-card>
      </div>
      <div class="recommend-content__footer">
        <!-- <el-pagination
          background
          @current-change="handlePageChange"
          :current-page.sync="page"
          :page-size="size"
          layout="total, prev, pager, next"
          :total="list.length">
        </el-pagination> -->
        <p @click="fetchRecommendContent" v-if="!loadAll">加载更多</p>
      </div>
    </template>
    <no-data v-else></no-data>
  </div>
</script>


<!-- 推荐内容卡片 -->
<script type="text/x-template" id="recommendContentCard">
  <div class="recommend-content-card" :style="{cursor: canClick ? 'pointer' : ''}">
    <div class="recommend-content-card__cover">
      <div class="label" :style="{background: labelStyle(label).background}" v-if="label">
      <i class="el-icon-s-data" v-if="label == '2'"></i> {{ labelStyle(label).text }}
      </div>
      <img :src="cover" />
    
    </div>
    <p class="title">{{ title }}</p>
    <p class="description">{{ description }}</p>
  </div>
</script>


<!-- 小视频 -->
<script type="text/x-template" id="highlight">
  <div class="highlight">
    <template v-if="splitList.length">
      <div class="highlight__main">
        <div 
          class="highlight__item"
          v-for="item in splitList" 
          :key="item.id"
          v-bind="item"
          @click="handleClick(item)"
        >
          <div class="cover">
            <img src="https://static1.weizan.cn/zhibo/livecontent/pc-menu/images/play.png" class="play-btn" />
            <img class="cover-img" :src="item.cover">
          </div>
          <p>{{ item.title }}</p>
        </div>
      </div>
      <div class="highlight__footer">
        <el-pagination
          background
          @current-change="handlePageChange"
          :current-page.sync="page"
          :page-size="size"
          layout="total, prev, pager, next"
          :total="list.length">
        </el-pagination>
      </div>
    </template>
    <no-data v-else></no-data>
  </div>
</script>

<!-- ppt -->
<script type="text/x-template" id="ppt">
  <div class="ppt">
    <template v-if="list.length">
      <div 
        class="ppt__main" 
        v-loading="isLoading"
        element-loading-text="正在翻页中..."
        element-loading-spinner="el-icon-loading"
        element-loading-background="rgba(0, 0, 0, 0.8)"
      >
        <div class="ppt__content" >
          <transition name="component-fade" mode="out-in">
            <el-image
              ref="pptContentRef"
              :key="activePPT"
              :src="activePPT" 
              :fit="'contain'"
              :preview-src-list="[activePPT]"
              @load="setPPTAsideHeight"
            >
            </el-image>
          </transition>
          <div class="ppt__content__pager">
              <img 
                v-if="allowTurnPage"
                class="pager-arrow" 
                :src="actveLeftArrow ? 'https://static1.weizan.cn/zhibo/livecontent/pc-menu/images/active_left_arrow.png' : 'https://static1.weizan.cn/zhibo/livecontent/pc-menu/images/left_arrow.png'" 
                @click="handlePagerClick(-1)" 
                @mouseenter="actveLeftArrow = true"
                @mouseleave="actveLeftArrow = false"
              />
              {{ activeIndex + 1 }} / {{ list.length }}
              <img 
                v-if="allowTurnPage"
                class="pager-arrow" 
                :src="actveRightArrow ? 'https://static1.weizan.cn/zhibo/livecontent/pc-menu/images/active_right_arrow.png' : 'https://static1.weizan.cn/zhibo/livecontent/pc-menu/images/right_arrow.png'" 
                @click="handlePagerClick(1)" 
                @mouseenter="actveRightArrow = true"
                @mouseleave="actveRightArrow = false"
              />
          </div>
        </div>

     
          <div class="ppt__aside" ref="pptAsideRef" v-if="allowTurnPage">
            <span class="el-icon-arrow-up arrow-icon" @click="scrollPPTList('up')"></span>
              <ul class="ppt-list" ref="pptListRef">
                <li 
                  v-for="(item, index) in list" 
                  :key="index" 
                  :class="{active: index == activeIndex}" 
                  @click="handlePPTClick(index)"
                >
                  <img :src="item.pathUrl" />
                </li>
              </ul>
            <span class="el-icon-arrow-down arrow-icon" @click="scrollPPTList('down')"></span>
          </div>
      </div>
      <div 
        v-if="pptUrl" 
        :class="{'offset-left-100': allowTurnPage }"
        class="download-btn" 
        @click="handleDownloadClick"
      >下载文件</div>
    </template>
    <no-data v-if="!list.length" text="讲师还未上传PPT课件"></no-data>
  </div>
</script>


<!-- 图片直播 -->
<script type="text/x-template" id="picLive">
  <div class="pic-live">
    <div v-if="picLiveTopicId" class="enter-album" @click="enterAlbum">进入相册</div>

    <template v-if="isStartLive">
        <!-- 分类tab -->
        <ul class="pic-live__category-tab" v-if="!hadVideo && hadCategories && !isFeeTopic">
          <li 
            class="pic-live__category-tab__item" 
            :class="{'active-category': categoryKey == 0}" 
            @click="handleCategoryClick({Id: 0})"
          >
            全部
          </li>
          <li 
            class="pic-live__category-tab__item" 
            :class="{'active-category': categoryKey == category.Id}" 
            v-for="category in categoryList" 
            :key="category.Id"
            @click="handleCategoryClick(category)"
          >
            {{ category.title }}
          </li>
        </ul>


        <div class="pic-live__more-resource" v-if="hadVideo">
          <!-- 资源tab -->
          <ul class="pic-live__resource-tab" >
            <li :class="{'active-resource': tabKey == 'pic' }" @click="handleResourceTabChange('pic')">{{selectMenuText('livepic')}}</li>
            <li :class="{'active-resource': tabKey == 'video' }" @click="handleResourceTabChange('video')">{{selectMenuText('video')}}</li>
          </ul>

          <el-select 
            v-model="categoryKey" 
            placeholder="请选择" 
            v-if="hadCategories && !isFeeTopic"
            @change="handleCategoryKeyChange"
          >
            <el-option label="全部" :value="0"></el-option>
            <el-option
              v-for="category in categoryList"
              :key="category.Id"
              :label="category.title"
              :value="category.Id">
            </el-option>
          </el-select>
        
        </div>

        <!-- 图片列表 -->
        <div class="pic-list" key="pic" v-show="tabKey == 'pic'" @scroll="handlePicListScroll">
          <div class="pic-list__item" v-for="(img, index) in imgList" :key="img.Id" @click="previewImg(img)">
            <img class="img" :class="{loaded: img.loaded}" :src="img.FilePath | formatImage" :alt="img.FileName" @load="onImgLoad(index)" />
          </div>
        </div>

        <!-- 视频列表 -->
        <div class="pic-list" key="video" v-show="tabKey == 'video'" @scroll="handlePicListScroll">
          <div class="pic-list__item" v-for="video in videoList" :key="video.id" @click="previewVideo(video)">
            <img :src="video.fileCover" :alt="video.fileName" />
            <img class="play-btn" src="https://static1.weizan.cn/zhibo/livecontent/pc-menu/images/play.png"/>
            <span class="duration">{{ formatVideoTime(video.fileTime) }}</span>
          </div>
        </div>
    
        <no-data v-if="tabKey == 'pic' && !imgList.length"></no-data>
        <no-data v-if="tabKey == 'video' && !videoList.length"></no-data>


        <!-- <div class="pic-live__pagination">
          <el-pagination
            background
            @current-change="handlePageChange"
            :current-page.sync="page"
            :page-size="size"
            layout="total, prev, pager, next"
            :total="total">
          </el-pagination>
        </div> -->
    </template>

    <no-data v-else :text="picLiveTopicId ? '直播即将开始，敬请期待!' : '暂未绑定图片直播'"></no-data>

    <preview-resource 
      v-model="showPreview" 
      :default-key="activeSourceKey"
      :source-list="sourceList"
      :is-preview-img="isPreviewImg"
    ></preview-resource>
  </div>
</script>


<script type="text/x-template" id="previewResource">
  <transition name="el-fade-in-linear">
    <div v-if="visible" class="preview-resource" ref="previewResourceRef">
      <div class="preview-resource__main">
        <div 
          class="preview-content" 
          @mouseleave="isMouseEnterVideo = false"
          @mouseenter="isMouseEnterVideo = true"
        >
          <img :src="currentSource | formatImage" v-if="isPreviewImg" />
          <video id="previewVideoElement" ref="videoRef" controls v-else />
          
          <img
            v-show="!isPreviewImg && isMouseEnterVideo"
            class="video-btn" 
            :src="isVideoPlaying ? 'https://static1.weizan.cn/zhibo/livecontent/pc-menu/images/pause_big.png' : 'https://static1.weizan.cn/zhibo/livecontent/pc-menu/images/play_big.png'" 
            @click="toggleVideoPlay"
          />
        </div>

        <div class="download-image" v-if="isPreviewImg" @click="handleImageClick">下载图片({{fileSize}})</div>
      </div>

      <!-- 指示器 -->
      <span class="indicator">({{index + 1}}/{{sourceList.length}})</span>
      
      <!-- 箭头切换 -->
      <div class="prev-arrow arrow" @click="handlePrevClick">
        <i class="el-icon-arrow-left"></i>
      </div>
      <div class="next-arrow arrow" @click="handleNextClick">
        <i class="el-icon-arrow-right"></i>
      </div>


      <!-- 预览缩略图 -->
      <div class="preview-list-wrapper" v-if="isPreviewImg">
        <ul class="preview-list" ref="previewListRef">
          <li 
            class="preview-list__item" 
            :class="{'active-img': index == idx}" 
            :ref="'thumbnail' + img.Id"
            v-for="(img, idx) in sourceList" :key="img.Id"
            @click="index = idx"
          >
            <img :src="img.FilePath | formatImage" :key="img.FileName" />
          </li>
        </ul>
      </div>
    </div>
  </transition>
</script>


<script type="text/x-template" id="pcMenuNoData">
  <div class="no-data">
     <img src="https://static1.weizan.cn/zhibo/livecontent/pc-menu/images/no_data.png" alt="" />
     <p>{{ text }}</p>
  </div>
</script>


<!-- https://static1.weizan.cn/zhibo/livecontent -->
<script src="https://static1.weizan.cn/zhibo/livecontent/pc-menu/utils/utils.js?ver=638498302430485833"></script>
<script src="https://static1.weizan.cn/zhibo/livecontent/pc-menu/constants.js?ver=638498302430485833"></script>
<script src="https://static1.weizan.cn/zhibo/livecontent/pc-menu/components/NoData.js?ver=638498302430485833"></script>
<script src="https://static1.weizan.cn/zhibo/livecontent/pc-menu/components/RecommendContentCard.js?ver=638498302430485833"></script>
<script src="https://static1.weizan.cn/zhibo/livecontent/pc-menu/components/PreviewResource.js?ver=638498302430485833"></script>
<script src="https://static1.weizan.cn/zhibo/livecontent/pc-menu/components/Highlight.js?ver=638498302430485833"></script>
<script src="https://static1.weizan.cn/zhibo/livecontent/pc-menu/components/FullRichText.js?ver=638498302430485833"></script>
<script src="https://static1.weizan.cn/zhibo/livecontent/pc-menu/components/RecommendContent.js?ver=638498302430485833"></script>
<script src="https://static1.weizan.cn/zhibo/livecontent/pc-menu/components/SpecialColumn.js?ver=638498302430485833"></script>
<script src="https://static1.weizan.cn/zhibo/livecontent/pc-menu/components/PPT.js?ver=638498302430485833"></script>
<script src="https://static1.weizan.cn/zhibo/livecontent/pc-menu/components/PicLive.js?ver=638498302430485833"></script>
<script src="https://static1.weizan.cn/zhibo/livecontent/pc-menu/index.js?ver=638498302430485833"></script>
                </div>





                <div id="qr-canvas_tpl" style="display:none;"></div>
                <div id="answer-qr_tpl" style="display: none;">
                    <div style="width: 325px;height: 387px;padding-top: 35px;text-align: center;background-image: url(https://static1.weizan.cn/zhibo/livecontent/answer/images/q-layout-bg.png);background-color: #ff900d;box-sizing: border-box;">
                        <div class="answer-qr-close" style="position: absolute;right: 16px;top: 16px;font-size: 14px;color: #fff;z-index: 10;" onclick="closeAnswerQrCode()">x</div>
                        <p style="margin-bottom: 75px;color: #FFF;font-size: 18px;">参与直播竞猜赢大奖</p>
                        <img id="answer-qr_img" style="width: 182px;height: 182px;margin-bottom: 9px;" />
                        <p style="color: #747474;font-size: 14px;">微信扫码参与</p>
                    </div>
                </div>

                <section id="pcLiveRightArea" class="direct-right-area">
                    <!--连麦-->
<div style="display: none;" id="mike-voice"></div>
<div class="mike-video" id="mike-video-app" style="display:none;" v-if="open">
    <div id="mikeVideoWrapper"></div>
    <div class="mike-icon-line">
        <i class="iconfont" :class="mutedVideo?'iconshexiangguan':'iconwebcam-fill'" @click="mutedVideo = !mutedVideo" v-if="!forbidVideo"></i>
        <i class="iconfont" :class="mutedAudio?'iconmaiguan':'iconmic-fill'" @click="mutedAudio = !mutedAudio" v-if="!forbidAudio && hasAudio"></i>
    </div>
    <p class="mike-username">{{zbvd.loginuser.nickname}}</p>
    <button class="mike-exit" @click="beforeExit">退出</button>
</div>
<script src="https://static1.weizan.cn/zhibo/livecontent/linkMike/linkMike.js?v=638498302430485833"></script>
<script>
if( 'True'=='False' && zbvd.loginuser){
    $('#mike-video-app').show();
    initMikeVideo();
}
else {
    $('#mike-video-app').remove();
}
</script>
                    <div class="direct-three-right flexdc" style="display:none">


                        <!-- pd右侧菜单 -->
                            <div id="pd-right-fixed-id" v-cloak class="pd-right-fixed" v-on:mouseleave="pdRightMenuleave">
                                <div id="summitEntranceEl" class="summit-entrance">
                                    <div @click="open">
                                        <img style="width: 44px;" src="https://static1.weizan.cn/zhibo/livecontent/webmic/images/chat.png" />
                                        <p :class="{'bg-yellow': isWait}">{{ text }}</p>
                                    </div>
                                </div>

                                <template v-if="isShowCustomerService">
                                    <div v-on:mouseenter="pdRightMenuEnter('customer')"
                                         v-bind:class="['pd-chat', pdRightMenuCurrent === 'customer' ? 'hover-active' : null]">
                                        <i style="font-size: 24px;" class="iconfont iconkefu"></i>
                                        <div class="mt-8 i18n" name="customer.service.name">客服</div>
                                    </div>
                                    <div class="pd-split"></div>
                                </template>
                                <div class="pd-phone" v-on:mouseenter="pdRightMenuEnter('phone')"
                                     v-bind:class="['pd-phone', pdRightMenuCurrent === 'phone' ? 'hover-active' : null]">
                                    <i style="font-size: 24px;" class="iconfont iconshoujikan1"></i>
                                    <div class="mt-8 i18n" name="mobile.name">手机看</div>
                                </div>
                                <div class="pd-split"></div>
                                <div class="pd-mine" v-on:mouseenter="pdRightMenuEnter('mine')">
                                        <div class="to-login show-out-pop" data-type="login">
                                            <i style="font-size: 24px;" class="iconfont icongerenzhongxin"></i>
                                            <div class="to-login show-out-pop mt-8 i18n" data-type="login" name="login.name">登录</div>
                                        </div>

                                </div>
                                <!-- hover客服 -->
                                <div class="pd-customer-popover"
                                     v-show="pdRightMenuCurrent === 'customer'"
                                     v-on:mouseenter="pdRightMenuSover"
                                     v-on:mouseleave="pdRightMenuleave">
                                    <div class="triangle"></div>
                                    <div class="triangle"></div>
                                    <h4 v-if="drainSet && drainSet.title" class="drain-tit">{{ drainSet.title }}</h4>
                                    <img class="qrcode" :src="drainSet && drainSet.qrCodeUrl" />
                                    <div v-if="drainSet && drainSet.desc" class="tip i18n">{{ drainSet.desc }}</div>
                                    <div v-if="drainSet && drainSet.contactPhone" class="phone">
                                        <i class="iconfont icondianhua"></i>
                                        <div class="split"></div>
                                        <div class="phone-number">{{ drainSet && drainSet.contactPhone }}</div>
                                    </div>
                                </div>
                                <!-- hover手机看 -->
                                <div class="pd-phoneplay-popover"
                                     v-show="pdRightMenuCurrent === 'phone'"
                                     v-on:mouseenter="pdRightMenuSover"
                                     v-on:mouseleave="pdRightMenuleave">
                                    <div class="triangle"></div>
                                    <div class="qrcode-box">
                                        <div class="wechat-qrcode-box">
                                            <img :src="qrcodeList.phone.qrcodeurl" />
                                            <div class="tip i18n" name="wx.watch.name">微信端观看</div>
                                        </div>
                                    </div>
                                    <div class="copy-box">
                                        <div class="link">{{shareUrl}}</div>
                                        <div class="btn btn_copy i18n" name="copy.btn.name">复制</div>
                                    </div>
                                </div>
                                <!-- hover我的 -->
                                <div class="pd-mine-popover"
                                     v-show="pdRightMenuCurrent === 'mine'"
                                     v-on:mouseenter="pdRightMenuSover"
                                     v-on:mouseleave="pdRightMenuleave">
                                    <div class="triangle"></div>
                                    <div class="popover-item">
                                            <a>
                                                <i style="font-size: 24px;" class="iconfont icongerenzhongxin"></i>
                                                <div class="to-login show-out-pop" data-type="login">登录</div>
                                            </a>
                                    </div>
                                    <div class="split"></div>
                                </div>
                            </div>

                        <!-- 右侧菜单（峰会话题显示连麦入口） -->
                   


                        <div class="direct-three-right-comment d-flex" id="direct-three-right-comment-id">
                        </div>

<link rel="stylesheet" href="https://static1.weizan.cn/zhibo/livecontent/announcement/style.css?ver=638498302430485833">

<!-- 公告栏 -->
<div id="announcement" class="announcement" v-cloak>
  <div
    v-if="scrollTextAd.lingText"
    class="announcement-wrap"
    :style="{ 'background-color': scrollTextAd.textBgColor }"
    @click="showTooltip = true"
  >
    <i class="left-icon" v-if="scrollTextAd.textLogo"><img :src="scrollTextAd.textLogo" alt=""></i>
    <div class="announcement-content">
      <!-- @mouseleave="showTooltip = false" -->
      <p ref="contentRef" :style="{color: scrollTextAd.textColor}">{{scrollTextAd.lingText.replace(/\s/g, '&nbsp;')}}</p>
    </div>
  </div>

    <transition name="el-zoom-in-top">
      <div 
        class="announcement-tooltip" 
        :style="{ 'background-color': scrollTextAd.textBgColor, color: scrollTextAd.textColor }"
        v-show="showTooltip"
      >
        <div class="announcement-tooltip__header">
          <img src="https://static1.weizan.cn/zhibo/livecontent/announcement/imgs/close.png" @click="showTooltip = false" />
        </div>
        <p class="announcement-tooltip__main" v-if="scrollTextAd.lingText">
          {{scrollTextAd.lingText.replace(/\s/g, '&nbsp;')}}
        </p>
      </div>
    </transition>
</div>

<script src="https://static1.weizan.cn/zhibo/livecontent/announcement/index.js?ver=638498302430485833"></script>                        <div v-cloak id="top-list" style="display: none" class="dtr-tab toplist-direct-three-right">
                            <div v-if="IsOpenShare || IsOpenReward" class="d-flex flexdc flex rel" style="height: 100%;">
                                <div class="tab-btn d-flex justify-c" v-if="isbandan || !IsScreen">

                                    <span v-if="IsOpenShare" @click="listType = 'Day'" class="i18n" :class="{act: listType == 'Day', raduis: !IsOpenReward}" v-bind:name="IsScreen?'Invitation.list.name':'Daily.list.name'">
                                        <!-- <i v-bind:class="['iconfont', IsScreen ? 'iconyaoqingbang' : 'iconzongbang']"></i> -->
                                        {{IsScreen?'邀请榜':'日榜'}}
                                    </span>
                                    <span v-if="IsOpenReward" @click="listType = 'Total'" class="i18n" :class="{act: listType == 'Total', raduis: !IsOpenShare}" v-bind:name="IsScreen?'Reward.list.name':'Total.list.name'">
                                        <!-- <i v-bind:class="['iconfont', IsScreen ? 'icondashangbang' : 'iconribang']"></i> -->
                                        {{IsScreen?'打赏榜':'总榜'}}
                                    </span>
                                </div>
                                <div class="top-list-center" v-if="isbandan || !IsScreen">
                                    <div v-show="listType == 'Day'" class="day-list">
                                        <div v-for="(v, i) in listDay" :key="i" class="man-item">
                                            <i v-if="i<=2" class="win-three"></i>
                                            <i v-else class="trag">{{i+1}}</i>
                                            <img :src="v.HeadImgUrl" />
                                            <div class="stp-ri-title" style="line-height: 20px; color: #fff;">
                                                <span class="ellipsis">{{v.NickName}}</span>
                                                <p style="font-size: 12px; color: rgb(174, 174, 174);">
                                                    <span class="i18n" name="Invite.name"></span>
                                                    <span class="list-rec">{{v.RecommendCount}}</span>
                                                </p>
                                            </div>
                                        </div>
                                        <div v-if="!listDay.length" class="empty-data">
                                            <div class="empty-data-icon"></div>
                                            暂无榜单数据!
                                        </div>
                                        <div v-else-if="!hasMoreDay" class="cfff text-align mag-t15 mag-b15">没有更多了</div>
                                    </div>
                                    <div v-show="listType == 'Total'" class="total-list">
                                        <div v-for="(v, i) in listTotal" :key="i" class="man-item">
                                            <i v-if="i<=2" class="win-three"></i>
                                            <i v-else class="trag">{{i+1}}</i>
                                            <img :src="v.HeadImgUrl" />
                                            <div class="stp-ri-title" style="line-height: 20px; color: #fff;">
                                                <span class="ellipsis">{{v.NickName}}</span>
                                                {{IsScreen}}
                                                <p v-if="IsScreen" class="list-cash">￥{{v.Cash}}</p>
                                                <p v-else style="font-size: 12px; color: rgb(174, 174, 174);">
                                                    <span class="i18n" name="Invite.name"></span>
                                                    <span class="list-rec">{{v.RecommendCount}}</span>
                                                </p>
                                            </div>
                                        </div>
                                        <div v-if="!listTotal.length" class="empty-data">
                                            <div class="empty-data-icon"></div>
                                            暂无榜单数据!
                                        </div>
                                        <div v-else-if="!hasMoreTotal" class="cfff text-align mag-t15 mag-b15">没有更多了</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>

            </div>






        </div>



        <!--发红包-->

<span style="display:none;">False</span>
<!-- 上传图片 -->
<script src="https://static1.weizan.cn/zhibo/livecontent/plugin/ajaxfileupload.js"></script>
<script type="text/javascript" src="https://static1.weizan.cn/zhibo/livecontent/new-2018/js/upload.js?ver=638498302430485833" charset="utf-8"></script>
<!--红包处理  -->
<script src="https://static1.weizan.cn/zhibo/livecontent/plugin/SliderVerify.min.js?ver=638498302430485833"></script>
<script type="text/javascript" src="https://static1.weizan.cn/zhibo/livecontent/new-2018/js/redbag.js?ver=638498302430485833" charset="utf-8"></script>
<script src="https://static1.weizan.cn/zhibo/userlivecontent/vzan2020/js/svga.min.js"></script>
<script src="https://static1.weizan.cn/zhibo/livecontent/js/redbagUtils/redbagUtils.js?ver=638498302430485833"></script>
<style>
    [v-cloak] { display: none !important; }
</style>
<!-- 发布红包弹窗开始 -->
<input type="hidden" id="hidIsWX" value="false" />
<div id="send-redpacket" class="give-redpacket-content">
    <router-view></router-view>
</div>
<script type="text/x-template" id="send-redbag-menu">
    <div id="redbag-menu-area">
        <div class="redbag-menu-mask" @click="closeMenu"></div>
        <section class="redbag-menu-box" :class="{ 'no-tabs': zbvd.applyId == 16 }">
            <!-- 非连锁门店 -->
            <template v-if="zbvd.applyId != 16">
                <div class="tabs">
                    <div v-for="tab in tabs" :key="tab.name" :class="['tab', { 'is-active': activeTab === tab.name }]" @click="onClickTab(tab)">
                      <span class="tab__text">{{ tab.title }}</span>
                    </div>
                </div>
                <div class="notice-bar-wrap">
                    <van-notice-bar scrollable text="现金红包可通过第三方账户直接发放现金红包给到用户,用户领取后可直接提现到自有的银行卡" />
                </div>
            </template>
            <h1 v-else>选择红包类型</h1>
            <ul>
                <li @click="openRedbag('normal')">
                    <i class="normal"></i>
                    <p>普通红包</p>
                </li>
                <li v-if="userInfo.isAdmin && modelType!=0 && modelType!=4" @click="openRedbag('answer')">
                    <i class="answer"></i>
                    <p>答题红包</p>
                </li>
                <li v-if="userInfo.isAdmin" @click="openRedbag('word')">
                    <i class="pwd"></i>
                    <p>口令红包</p>
                </li>
                <li v-if="modelType == 2 && userInfo.isAdmin && (userInfo.roleType == 1 || userInfo.roleType == 2) && !userInfo.isLiveAss" @click="openRedbag('lookredbag')">
                    <i class="look"></i>
                    <p>观看奖励</p>
                </li>
                <li v-if="userInfo.isAdmin && !/0|4/i.test(zbvd.modeltype)" @click="openRedbag('company')">
                    <i class="comp"></i>
                    <p>企业红包</p>
                </li>
                <li v-if="userInfo.isAdmin && modelType!=0 && modelType!=4 && openRain" @click="openRedbag('rain')">
                    <i class="rain"></i>
                    <p>红包雨</p>
                </li>
            </ul>
        </section>
    </div>
</script>
<script type="text/x-template" id="send-redpacket-template">
    <div id="redpacketapp" class="redpacketapp">
        <div class="hd">
            <ul>
                <li :class="{on:redpacket.type == 'company'}" v-if="userInfo.isAdmin && !/0|4/i.test(zbvd.modeltype)" v-on:click="switchTab('company')"><s>企业</s></li>
                <li :class="{on:redpacket.type == 'normal'}" v-on:click="switchTab('normal')"><s>普通</s></li>
                <li :class="{on:redpacket.type == 'rain'}" v-if="userInfo.isAdmin && modelType!=0 && modelType!=4 && openRain" @click="switchTab('rain')"><s>红包雨</s></li>
                <li :class="{on:redpacket.type == 'answer'}" v-if="userInfo.isAdmin && modelType!=0 && modelType!=4" @click="switchTab('answer')"><s>答题</s></li>
                <li :class="{on:redpacket.type == 'word'}" v-if="userInfo.isAdmin" v-on:click="switchTab('word')"><s>口令</s></li>
                <li :class="{on:redpacket.type == 'lookredbag'}" v-if="modelType == 2 && userInfo.isAdmin && (userInfo.roleType == 1 || userInfo.roleType == 2) && !userInfo.isLiveAss" v-on:click="switchTab('lookredbag')"><s>观看</s></li>
            </ul>
        
        </div>
        <div class="close-content" v-if="false" v-on:click="closeSendRedpacket"><i class="close-hb"></i></div>
        <div class="base-wrap" ref="baseWrap" style="height:100vh;overflow-y:scroll;">
            <div v-if="redpacket.type == 'lookredbag'">
                <div class="lookRewardList" v-if="!showEditForm && lookRewardRedBagList.length > 0">
                    <div class="lookRewardListItem" v-for="item in lookRewardRedBagList" :key="item.id">
                        <div class="top">
                            <div>
                                <span style="font-weight: bold; color: #333;">{{ item.payType === 2 ? '核销红包' : '现金红包' }}</span>
                                <span v-if="item.state == 0">（未开启）</span>
                                <span v-if="item.state == 2">（已结束）</span>
                                <span v-if="item.state == 1" class="top-left-no">（已开启）</span>
                                <span v-if="item.state == 3">（已退款）</span>
                                <span v-if="item.state == 4">（已暂停）</span>
                            </div>
                            <div class="top-right" v-if="item.state == 0" v-on:click="editLookRewardRedBag(item, 'edit')">编辑</div>
                            <div class="top-right" v-if="item.state != 0" v-on:click="editLookRewardRedBag(item, 'detail')">详情</div>
                        </div>
                        <div class="center">
                            <div class="center-left item">
                                <div class="text">总金额</div>
                                <div class="num">￥{{item.totalMoney}}</div>
                            </div>
                            <div class="w1px"></div>
                            <div class="center-center item">
                                <div class="text">红包数量</div>
                                <div class="num">{{item.totalRedPacketsNum}}个</div>
                            </div>
                            <div class="w1px"></div>
                            <div class="center-right item">
                                <div class="text">观看时长</div>
                                <div class="num">{{item.showTimeshowTime}}</div>
                            </div>
                        </div>
                        <div class="br1px3"></div>
                        <div class="bottom bottom-start" @click="openLookRewardRedBag(item)" v-if="item.state == 0">开启</div>
                        <div class="bottom bottom-end " @click="closeLookRewardRedBag(item)" v-if="item.state == 1">结束</div>
                    </div>
                    <div class="create-btn" @click="createBtn">创建观看奖励红包</div>
                </div>

                <div class="red-packetsSlide" v-if="showEditForm || lookRewardRedBagList.length == 0">
                    <div class="bd" v-if="redpacket.type!='rain' && redpacket.type != 'answer'">
                        <section class="red-input-group">
                            <div class="editBox two-row" v-if="redpacket.rtype==0">
                                <div class="d-flex d-flex-center">
                                    <span class="sumin">单个金额</span>
                                    <div class="fill-in flex">
                                        <input type="text" style="font-size:30px;" placeholder="0.00"
                                            v-model.number="lookRewardRedBagItem.redPacketItem.singleMoney" class="flex"
                                            v-on:blur="inputNums" v-on:keyup="inputMoney" onkeyup="value = value.replace(/[^\d|.]/g, '')" oninput="value = value.replace(/[^\d|.]/g, '')" />
                                    </div>
                                    <span v-show="!canUsePrivateRedBag">元</span>
                                </div>
                                <p class="switch-hb" v-if="redpacket.rtype==0">
                                    <s>当前为等分红包，</s><span style="cursor:pointer;" @click="chanageRedbagType(1)">改为拼手气红包</span>
                                </p>
                            </div>
                            <div class="editBox two-row" v-if="redpacket.rtype==1">
                                <div class="d-flex d-flex-center">
                                    <span class="sumin">总金额</span>
                                    <div class="pin"></div>
                                    <div class="fill-in flex">
                                        <input 
                                            class="flex"
                                            type="text" 
                                            style="font-size:30px;" 
                                            placeholder="0.00"
                                            maxlength="10"
                                            v-model.number="lookRewardRedBagItem.redPacketItem.totalMoney"
                                            v-on:blur="completeMoney" 
                                            onkeyup="value = value.replace(/[^\d|.]/g, '')" 
                                            oninput="value = value.replace(/[^\d|.]/g, '')" 
                                            v-on:keyup="inputMoney" 
                                        />
                                    </div>
                                    <span v-show="!canUsePrivateRedBag">元</span>
                                </div>
                                <p class="switch-hb" v-if="redpacket.rtype==1">
                                    <s>当前为拼手气红包，</s><span style="cursor:pointer;" @click="chanageRedbagType(0)">改为等分红包</span>
                                </p>
                            </div>
                            <div class="editBox d-flex d-flex-center">
                                <span>红包数量</span>
                                <div class="fill-in flex">
                                    <input type="text" :placeholder="'填写红包个数，最多'+maxWxNum" class="flex" v-model.number="lookRewardRedBagItem.redPacketItem.totalRedPacketsNum" onkeyup="value = value.replace(/[^\d]/g, '')" oninput="value = value.replace(/[^\d]/g, '')" v-on:keyup="inputNums" />
                                </div>
                                <span>个</span>
                            </div>
                        </section>

                        <section class="red-input-group">
                            <div class="editBox d-flex d-flex-center">
                                <span>领取区域</span>
                                <div class="fill-in fill-in-t flex" @click="showArea = true">
                                    <input type="text" placeholder="选择领取区域" class="flex" id="scitys" readonly />
                                </div>
                                <div class="up-down"></div>
                            </div>
                            <template>
                                <div class="editBox d-flex d-flex-center">
                                    <span>观看时长</span>
                                    <div class="fill-in fill-in-t flex">
                                        <input type="text" placeholder="选择观看时长" id='looktime' class="flex" readonly />
                                    </div>
                                    <div class="up-down"></div>
                                </div>
                                <div class="editBox d-flex d-flex-center">
                                    <span>结束时间</span>
                                    <div class="fill-in fill-in-t flex" @click="showTime=true;dateModelKey='endTime';">
                                        <input type="text" placeholder="请选择结束时间" v-model="lookRewardRedBagItem.endTime" class="flex" readonly />
                                    </div>
                                    <div class="up-down"></div>
                                </div>
                            </template>
                        </section>

                        <section class="congraText selfForm">
                            <span>祝福语</span>
                            <div class="fill-in flex">
                                <input type="text" v-model="lookRewardRedBagItem.redPacketItem.config.redpackeblessing" v-on:keyup="redpacket.note = redpacket.note.replace(/\s/gi, '')" v-bind:placeholder="placeholder" />
                            </div>
                        </section>

                        <section class="notGetTip selfForm">
                            <div class="title">未获得红包提示</div>
                            <div class="br1Px"></div>
                            <div class="input-title">
                                <span>标题</span>
                                <input v-model="lookRewardRedBagItem.redPacketItem.config.Losingtitle" type="text" placeholder="已抢光">
                            </div>
                            <div class="br1Px2"></div>
                            <div class="input-text">
                                <span>提示语</span>
                                <input  v-model="lookRewardRedBagItem.redPacketItem.config.Losingtips" type="text" placeholder="再接再厉">
                            </div>
                        </section>

                        <p class="switch-hb" v-if="false">当前直播间可用余额为{{liveMoney}}元</p>
                    </div>
                    <footer class="send-redpacket-footer" v-if="redpacket.type == 'lookredbag'">
                        <div style="display:flex;align-items: center;">
                            <div class="gobackLookRedbag" v-if="showEditForm && lookRewardRedBagList.length > 0" @click="gobackLookRedbag">返回</div>
                            <button 
                                v-if="detailType == 'edit'" 
                                class="submit" 
                                :style="(showEditForm && lookRewardRedBagList.length > 0) ? 'width:70%' : 'width: 100%'" 
                                @click="saveLookRewardRedbag"
                            >
                                塞钱进红包
                            </button>
                        </div>
                        <p class="paytype-2-tips" v-if="canUsePrivateRedBag" >“核销红包”需要已领取红包的用户添加客服领取</p>
                        <template v-else>
                            <p class="unreceived">未领取的微信支付红包，需后台手动发起退款；未领取的第三方支付红包，将于24小时后自动退款</p>
                            <p class="unreceived">
                                红包总金额最多支持发放{{maxWxPay/100}}元
                            <!-- <span v-if="isCreator">，直播间余额发红包最多支持{{maxCashPay/100}}元</span> -->
                        </p>
                        </template>
                    </footer>
                </div>
            </div>

            <div class="red-packetsSlide" v-if="redpacket.type != 'lookredbag'">
                <div class="bd" v-if="redpacket.type!='rain' && redpacket.type != 'answer'">
                    <section class="red-input-group" v-if="redpacket.type == 'company'">
                        <div class="editBox d-flex d-flex-center">
                            <span>红包玩法</span>
                            <div class="fill-in fill-in-t flex">
                                <select v-model="redpacket.rptype">
                                    <option :value="0">普通红包</option>
                                    <!-- 核销红包不可使用裂变玩法 -->
                                    <option :value="2" v-if="$route.query.mode != 2">裂变红包</option>
                                </select>
                            </div>
                            <div class="up-down"></div>
                        </div>
                        <div class="editBox d-flex d-flex-center" v-if="redpacket.rptype == 2">
                            <span>口令</span>
                            <div class="fill-in flex">
                                <input type="text" v-model="redpacket.redpwd" placeholder="请输入激活红包口令" class="flex" maxlength="20"/>
                            </div>
                        </div>
                        <div class="editBox d-flex d-flex-center" v-if="redpacket.rptype == 2">
                            <marquee class="merchant-tip">裂变红包存在被微信限制的风险，设置口令时尽量避免出现金钱、分享有奖等敏感词。</marquee>
                        </div>
                    </section>
                    <section class="red-input-group">
                        <div class="editBox two-row" v-if="redpacket.rtype==0">
                            <div class="d-flex d-flex-center">
                                <span class="sumin">单个金额</span>
                                <div class="fill-in flex">
                                    <input type="text" style="font-size:30px;" placeholder="0.00"
                                        v-model="redpacket.singlemoneystr" class="flex"
                                        v-on:blur="inputNums" v-on:keyup="inputMoney" onkeyup="value = value.replace(/[^\d|.]/g, '')" oninput="value = value.replace(/[^\d|.]/g, '')" />
                                </div>
                                <span v-show="!canUsePrivateRedBag" >元</span>
                            </div>
                            <p class="switch-hb">
                                <s>当前为等分红包，</s><span style="cursor:pointer;" @click="chanageRedbagType(1)">改为拼手气红包</span>
                            </p>
                        </div>
                        <div class="editBox two-row" v-if="redpacket.rtype==1">
                            <div class="d-flex d-flex-center">
                                <span class="sumin">总金额</span>
                                <div class="pin"></div>
                                <div class="fill-in flex">
                                    <input type="text" style="font-size:30px;" placeholder="0.00"
                                        v-model="redpacket.money" class="flex"
                                        maxlength="10"
                                        v-on:blur="completeMoney" onkeyup="value = value.replace(/[^\d|.]/g, '')" oninput="value = value.replace(/[^\d|.]/g, '')" v-on:keyup="inputMoney" />
                                </div>
                                <span v-show="!canUsePrivateRedBag">元</span>
                            </div>
                            <p class="switch-hb">
                                <s>当前为拼手气红包，</s><span style="cursor:pointer;" @click="chanageRedbagType(0)">改为等分红包</span>
                            </p>
                        </div>
                        <!-- <div class="editBox d-flex d-flex-center" v-if="redpacket.type == 'lookredbag'">
                            <span>红包数量</span>
                            <div class="fill-in flex">
                                <input type="text" :placeholder="'填写红包个数，最多'+zbvd.zbredpacketlimitcountcash" class="flex" v-model="redpacket.nums" onkeyup="value = value.replace(/[^\d]/g, '')" oninput="value = value.replace(/[^\d]/g, '')" v-on:keyup="inputNums" />
                            </div>
                            <span>个</span> v-else
                        </div> -->
                        <div class="editBox d-flex d-flex-center">
                            <span>红包数量</span>
                            <div class="fill-in flex">
                                <input type="text" :placeholder="'填写红包个数，最多'+ maxWxNum" class="flex" v-model="redpacket.nums" onkeyup="value = value.replace(/[^\d]/g, '')" oninput="value = value.replace(/[^\d]/g, '')" v-on:keyup="inputNums" />
                            </div>
                            <span>个</span>
                        </div>
                        <div class="editBox d-flex d-flex-center" v-if="redpacket.type == 'word'">
                            <span>红包口令</span>
                            <div class="fill-in fill-in-t flex">
                                <input type="text" placeholder="请设置领取口令" class="flex" v-model="redpacket.redpwd" v-on:keyup="redpacket.redpwd=redpacket.redpwd.replace(/\s/gi, '')" />
                            </div>
                        </div>
                        <div class="editBox d-flex d-flex-center" v-if="redpacket.type == 'word'">
                            <span>口令提示</span>
                            <div class="fill-in fill-in-t flex">
                                <input type="text" placeholder="请设置提示信息(建议14字以内)" class="flex" v-model="redpacket.redmsgtip" v-on:keyup="redpacket.redmsgtip=redpacket.redmsgtip.replace(/\s/gi, '')" />
                            </div>
                        </div>
                    </section>

                    <section class="red-input-group">
                        <div class="editBox d-flex d-flex-center" v-if="userInfo.isAdmin && redpacket.type == 'normal'">
                            <span>领取区域</span>
                            <div class="fill-in fill-in-t flex" @click="showArea = true">
                                <input type="text" placeholder="选择领取区域" class="flex" id="scitys" readonly />
                            </div>
                            <div class="up-down"></div>
                        </div>
                        <div class="editBox d-flex d-flex-center" v-if="redpacket.type != 'lookredbag' && redpacket.type != 'company'">
                            <span>定时红包</span>
                            <div class="weui_cell_ft flex">
                                <input class="weui_switch" type="checkbox" v-model="redpacket.isTiming" v-on:click="setTiming()">
                            </div>
                        </div>
                        <div class="editBox d-flex d-flex-center" v-if="redpacket.isTiming">
                            <span>发送时间</span>
                            <div class="fill-in fill-in-t flex" @click="showTime=true;dateModelKey='rptime';">
                                <input type="text" placeholder="请选择发送时间" v-model="redpacket.rptime" id='redbagdatetime' class="flex" readonly />
                            </div>
                            <div class="up-down"></div>
                        </div>
                    </section>

                    <section class="congraText selfForm" v-if="redpacket.type=='lookredbag'">
                        <span>祝福语</span>
                        <div class="fill-in flex">
                            <input type="text" v-model="redpacket.note" v-on:keyup="redpacket.note = redpacket.note.replace(/\s/gi, '')" v-bind:placeholder="placeholder" />
                        </div>
                    </section>

                    <section class="notGetTip selfForm" v-if="redpacket.type=='lookredbag'">
                        <div class="title">未获得红包提示</div>
                        <div class="br1Px"></div>
                        <div class="input-title">
                            <span>标题</span>
                            <input type="text" placeholder="已抢光">
                        </div>
                        <div class="br1Px2"></div>
                        <div class="input-text">
                            <span>提示语</span>
                            <input type="text" placeholder="再接再厉">
                        </div>
                    </section>

                    <section class="red-input-group" v-if="redpacket.type == 'company'">
                        <div class="editBox d-flex d-flex-center">
                            <span>企业名称</span>
                            <div class="fill-in flex">
                                <input type="text" v-model="redpacket.companyname" placeholder="将展示于红包气泡下方" maxlength="20">
                            </div>
                        </div>
                        <div class="editBox d-flex d-flex-center">
                            <span>祝福语</span>
                            <div class="fill-in flex">
                                <input type="text" v-model="redpacket.wish" placeholder="恭喜发财,大吉大利！" maxlength="20">
                            </div>
                        </div>
                    </section>
                    <section class="red-input-group" v-if="redpacket.type != 'company' && redpacket.type !='lookredbag'">
                        <div 
                            class="editBox d-flex d-flex-center" 
                            :style="{ background:(redpacket.type == 'normal' && !userInfo.isAdmin) ? '#f0f0f0' : null }"
                        >
                            <div class="fill-in-text flex">
                                <textarea
                                    :readonly="redpacket.type == 'normal' && !userInfo.isAdmin"
                                    id="note" 
                                    v-bind:placeholder="placeholder" 
                                    v-model="redpacket.note" 
                                    v-on:keyup="redpacket.note = redpacket.note.replace(/\s/gi, '')"
                                ></textarea>
                            </div>
                        </div>
                    </section>
                    <section class="red-input-group" @click="showChooseCom" v-if="canUsePrivateRedBag">
                        <div class="editBox private-redbag-openchoose">
                            <div class="private-redbag-choose">
                                <span>客服二维码 </span>
                                <div class="up-down"></div>
                            </div>
                            <div class="res-tipsdx">用户添加客服凭红包领取截图取现金红包</div>
                        </div>
                    </section>

                    <section class="red-input-group" v-if="redpacket.type == 'company'">
                        <div class="editBox d-flex d-flex-center no-border">
                            <span>红包封面</span>
                            <div class="fill-in flex" style="margin-right:0;">
                                <a href="https://j.weizan.cn/LiveAdmin/assets/html/coverRule/index.html" class="cover-tip">封面设计规范</a>
                            </div>
                        </div>
                        <div class="cover-list-area">
                            <div class="cover-list">
                                <div class="cover-item add" @click="beforeUploadCover">添加封面</div>
                                <div class="cover-item normal" v-for="item in coverList" :key="item.id" 
                                    @click="setCover(item)" :class="{check:item.cover == redpacket.cover && item.bubbleCover == redpacket.bubblecover}">
                                    <img :src="item.cover">
                                    <i class="del iconfont iconguanbi" v-if="item.id" @click.stop="beforeDelCover(item)"></i>
                                </div>
                            </div>
                        </div>
                    </section>

                    <div class="clause-tips" v-if="redpacket.type!='lookredbag'" v-on:click="showClause=true">
                        <p v-if="redpacket.type == 'word'">用户填写正确口令即可领取红包</p>
                        <p v-if="redpacket.type == 'lookredbag'">单次观看达到时长即可领取红包，退出页面重新计算</p>
                        <!-- <div class="tip-right">
                            服务条款
                        </div> -->
                    </div>
                    <p class="switch-hb" v-if="redpacket.type == 'lookredbag' && !canUsePrivateRedBag">当前直播间可用余额为{{liveMoney}}元</p>
                </div>
                <!-- 企业红包封面设置 -->
                <div class="red-shadow bottom" v-if="coverStep == 1" @click="coverStep=0">
                    <section class="red-cover-box" @click.stop="">
                        <h1>红包封面<a href="https://j.weizan.cn/LiveAdmin/assets/html/coverRule/index.html">封面设计规范</a></h1>
                        <h2>建议尺寸(600*688)</h2>
                        <div class="img">
                            <img v-if="coverObj.cover" :src="coverObj.cover" />
                        </div>
                        <div class="cover-btn-row">
                            <button @click="coverStep=2">下一步</button>
                            <button @click="$refs.companyCover.click()">{{coverObj.cover?'更换':'添加'}}封面图</button>
                        </div>
                    </section>
                </div>
                <input type="file" ref="companyCover" @change="uploadCover" accept="image/*" style="display: none;">
                <div class="red-shadow bottom" v-if="coverStep == 2" @click="coverStep=0">
                    <section class="red-cover-box" @click.stop="">
                        <h1>红包气泡封面<a class="bubbleTipBtn" @click="openBubbleTip">什么是气泡封面</a></h1>
                        <div class="bubble">
                            <img :src="coverObj.cover">
                            <div class="bubble-shadow">
                                <i class="bubble-top" :style="{height:clipY + 'px'}"></i>
                                <div class="bubble-slide" 
                                v-on:[startEvent]="slideCoverStart" 
                                v-on:[moveEvent]="slideCoverMove"></div>
                                <i class="bubble-bottom"></i>
                            </div>
                        </div>
                        <p class="bubble-tip">移动裁剪框选取气泡封面</p>
                        <div class="cover-btn-row">
                            <button @click="coverStep=1">上一步</button>
                            <button @click="saveClipCover">确定</button>
                        </div>
                    </section>
                </div>
                <div class="red-shadow" v-if="bubbleTip.show" @click="bubbleTip.show=false">
                    <img @click.stop="" class="bubblexm" :style="{top:bubbleTip.top + 'px',right:bubbleTip.right + 'px'}" 
                    src="https://static1.weizan.cn/zhibo/livecontent/new-2018/redpack2021/redbubble.png">
                </div>
                <!-- 红包雨列表 -->
                <div class="bd" :class="{'scroll':rainList.length!=0 && rainList!==''}" v-if="redpacket.type == 'rain'">
                    <section class="rain-empty" v-if="rainList.length==0 && rainList!==''">
                        <img src="https://static1.weizan.cn/zhibo/livecontent/new-2018/images/rain-exm.png">
                        <p>设置红包雨后，达到开启时间直播页面飘动红包雨，用户点击红包图片即可参与</p>
                    </section>
                    <section v-else-if="rainList.length">
                        <div class="rain-item rain"
                             :class="{'isend':Utils.timeStringToDate(item.Endtime,true)<new Date()}"
                             v-for="item in rainList">
                            <h1>
                                {{item.RpType===0?'立即':'定时'}}发送：{{item.Addtime}}
                                <div class="ml15">
                                    <span>{{ item.PayType == 2 ? '核销红包' : '现金红包' }}</span>
                                    <span class="rain-status" :class="item.StatusName=='未开始'?'notbegin':item.StatusName=='进行中'?'':'grey'">
                                        （{{item.StatusName}}）
                                    </span>
                                </div>
                            </h1>
                            <div class="rain-item-money">
                                <div class="left count-item"><span>￥{{(item.Total_Amount*0.01).toFixed(2)}}</span>红包金额</div>
                                <div class="line"></div>
                                <div class="right count-item"><span>{{item.Target_User_Count}}个</span>红包总数</div>
                            </div>
                            <div class="rain-item-money">
                                <div class="left count-item"><span>￥{{(item.BalanceAmount*0.01).toFixed(2)}}</span>剩余红包金额</div>
                                <div class="line"></div>
                                <div class="right count-item"><span>{{item.BalanceCount}}个</span>剩余红包总数</div>
                            </div>
                            <div class="rain-foot">
                                <button class="grey" @click="beforeCancelRain(item.RId)" v-if="item.StatusName=='未开始'">撤回</button>
                                <button v-if="item.StatusName=='未开始'" 
								@click="$router.push('/createRain?id='+item.RId+'&isend='+(Utils.timeStringToDate(item.Endtime,true)<new Date()?1:0))">
                                    编辑
                                </button>
                                <button v-else @click="$router.push('/createRain?id='+item.RId+'&isend='+(Utils.timeStringToDate(item.Endtime,true)<new Date()?1:0))">
                                    查看详情
                                </button>
                            </div>
                        </div>
                    </section>
                </div>
                <!-- 答题红包列表 -->
                <div class="bd" :class="{'scroll':answerList.length!=0 && answerList!==''}" v-if="redpacket.type == 'answer'">
                    <section class="rain-empty" v-if="answerList.length==0 && answerList!==''">
                        <img src="https://static1.weizan.cn/zhibo/livecontent/new-2018/images/answer-exm.png">
                        <p>设置答题红包后，将答题红包推送至互动区，答对题目即可领取红包，先到先得</p>
                    </section>
                    <section v-else-if="answerList.length">
                        <div class="rain-item" v-for="(item,index) in answerList">
                            <h1>{{item.Question.Question}}<span>（{{ item.PayType == 2 ? '核销红包' : '现金红包' }}）</span></h1>
                            <div class="rain-item-money">
                                <div class="left">红包金额：<span>￥{{(item.Total_Amount*0.01).toFixed(2)}}</span></div>
                                <div class="right">红包总数：<span>{{item.Target_User_Count}}个</span></div>
                            </div>
                            <div class="rain-foot">
                                <button @click="$router.push('/createAnswer?id='+item.RId+'&isend='+(item.State==-2?0:1))">红包详情</button>
                                <button v-if="item.State==-2" @click="pushAnswer(item,index)">立即推送</button>
                                <button v-else class="grey">已推送</button>
                            </div>
                        </div>
                    </section>
                </div>

                <footer class="send-redpacket-footer" :class="{'zero':rainList.length!=0 && rainList!==''}" v-if="redpacket.type == 'rain'">
                    <button class="submit" @click="beforeCreateRedbag('rain')">创建红包雨</button>
                    <!-- <p class="unreceived">设置红包雨后，达到开启时间直播页面飘动红包雨，用户点击红包图片即可参与</p> -->
                </footer>
                <footer class="send-redpacket-footer" :class="{'zero':answerList.length!=0 && answerList!==''}" v-else-if="redpacket.type == 'answer'">
                    <button class="submit" @click="beforeCreateRedbag('answer')">创建答题红包</button>
                    <!-- <p class="unreceived">设置答题红包后，将答题红包推送至互动区，答对题目即可领取红包，先到先得</p> -->
                </footer>
                <footer class="send-redpacket-footer" v-else>
                    <div style="display:flex;align-items: center;">
                        <div 
                            v-show="redpacket.type == 'lookredbag'"
                            class="gobackLookRedbag" 
                            @click="gobackLookRedbag"
                        >返回</div>
                        <button class="submit" style="flex:1;" @click="sendPacket(false)"> {{canUsePrivateRedBag?'塞钱进红包': '塞钱' + totalMoney + '元'}}</button>
                    </div>
                    <p class="paytype-2-tips" v-if="canUsePrivateRedBag" >“核销红包”需要已领取红包的用户添加客服领取</p>
                    <template v-else>
                        <p class="unreceived">未领取的微信支付红包，需后台手动发起退款；未领取的第三方支付红包，将于24小时后自动退款</p>
                        <p class="unreceived">
                            红包总金额最多支持发放{{maxWxPay/100}}元
                        <!-- <span v-if="isCreator">，直播间余额发红包最多支持{{maxCashPay/100}}元</span> -->
                    </p>
                    </template>
                </footer>

            </div>
            <!-- <div v-if="false" class="red-packetsSlide" style="padding-top:44%;">
                <p style="text-align: center;font-size:1.4rem">用户单次观看直播达到一定时长即可获得观看奖励</p>
                <p style="text-align: center;font-size:1.4rem">观看奖励帮助您留住观众、增加互动性</p>
                <p style="text-align: center;font-size:1.4rem">详情请在<em style="color:#0084FF">PC管理后台</em>-<em style="color:#0084FF">话题管理</em>-<em style="color:#0084FF">观看奖励</em> 添加</p>
            </div> -->
            <div class="pop-up-model" v-if="showClause">
                <div class="clause-wrap">
                    <div class="clause-con">
                        <p class="clause-con-tit">服务条款</p>
                        <p>发送红包时本平台将收取0.6%的手续费；使用本平台发送红包功能则表示您默认同意本服务条款</p>
                    </div>
                    <div class="clause-btn" v-on:click="showClause=false">我知道了</div>
                </div>
            </div>
            <!-- 城市选择 -->
            <van-popup v-model="showArea" position="bottom">
                <van-area :area-list="redBagAreaList" :columns-num="2"
                          @confirm="selectArea" @cancel="showArea=false" value="100000" />
            </van-popup>
            <!-- 时间选择 -->
            <van-popup v-model="showTime" position="bottom">
                <van-datetime-picker type="datetime"
                                     @confirm="selectTime" @cancel="showTime=false" :min-date="now" />
            </van-popup>
        </div>
        <!-- 选择支付方式 -->
        <div class="pay-shadow" v-if="checkPay" @click="checkPay=false">
            <section class="pay-red-box" @click.stop="">
                <h1 class="pay-title">支付金额</h1>
                <p class="pay-total">￥<var>{{realMoney}}</var></p>
                <div class="pay-option-area">
                    <div class="pay-option">支付方式</div>
                    <div v-if="zbvd.roleid > 0" class="pay-option" @click="redpacket.paytype = 3">
                        <i class="option-icon icon-ac"></i>
                        <div class="option-text">
                          <p>第三方支付</p>
                          <span v-if="merchantInfo.isLianLianPay && zbvd.userid == zbvd.siteuser"><var>余额 {{ (balance / 100).toFixed(2)}}</var></span>
                        </div>
                        <i class="option-check" :class="{on:redpacket.paytype == 3}"></i>
                    </div>
                    <div class="pay-option" @click="redpacket.paytype = 0">
                        <i class="option-icon icon-wechat"></i>
                        <div class="option-text">
                          <p>微信支付</p>
                          <span><var>含微信官方0.6%商户收款手续费</var></span>
                        </div>
                        <i class="option-check" :class="{on:redpacket.paytype == 0}"></i>
                    </div>
                    <div v-if="merchantInfo.isIndePay && (isCreator || zbvd.roleid == 2)" class="pay-option" @click="redpacket.paytype = 4">
                        <i class="option-icon icon-ac"></i>
                        <div class="option-text">
                          <p>虚拟余额支付</p>
                          <span><var>余额 {{ (virtualBalance / 100).toFixed(2)}}</var></span>
                        </div>
                        <i class="option-check" :class="{on:redpacket.paytype == 4}"></i>
                    </div>
                    <!-- <div v-if="zbvd.zbid == 75999 && redpacket.type != 'lookredbag'" class="pay-option" @click="redpacket.paytype = 1">
                        <i class="option-icon icon-ac"></i>
                        <div class="option-text">
                            <p>直播间余额支付</p>
                            <span>直播间余额 ¥{{liveMoney}} <var v-if="liveMoney*1 < totalMoney.replace(',','')*1">余额不足</var></span>
                        </div>
                        <i class="option-check" :class="{on:redpacket.paytype == 1}"></i>
                    </div> -->
                </div>
                <button class="pay-submit" @click="submitCreateRedbag">确定支付</button>
            </section>
        </div>
    </div>
</script>
<!-- 创建红包雨 -->
<script type="text/x-template" id="send-redpacket-rain">
    <div class="redpacket-create" v-cloak>
        <div class="redpacket-create-main">
            <!-- 创建 -->
            <template v-if="!id">
                <section class="red-input-group" v-for="(detail,index) in redpacket.details">
                    <div class="editBox d-flex d-flex-center first-title" v-if="redpacket.details.length > 1">
                        <span>第{{numText[index]}}轮红包雨</span>
                        <div class="del" v-if="index>0" @click="redpacket.details.splice(index,1);$toast('已删除')">删除</div>
                    </div>
                    <div class="editBox two-row" @click="detailIndex=index;showTime=true">
                        <div class="d-flex d-flex-center">
							<div class="new-label">
								<p>发送时间</p>
							</div>
							<div class="fill-in fill-in-t flex">
								<input type="text" placeholder="立即发送" v-model="detail.rptime" class="flex" readonly />
							</div>
							<div class="up-down"></div>
                        </div>
                        <div class="create-tip">只能发送1分钟至12小时内的定时红包</div>
                    </div>
                    <div class="editBox two-row" v-if="detail.rtype==0">
                        <div class="d-flex d-flex-center">
                            <span class="sumin">单个金额</span>
                            <div class="fill-in flex">
                                <input type="text" style="font-size:30px;" placeholder="0.00"
                                    @input="detail.singlemoneystr = filtFloat(detail.singlemoneystr)"
                                    v-model="detail.singlemoneystr" class="flex" />
                            </div>
                            <span v-show="!canUsePrivateRedBag" >元</span>
                        </div>
                        <div class="create-tip" @click="detail.rtype=1;detail.singlemoneystr=''">当前为等分红包，<span>改为拼手气红包</span></div>
                    </div>
                    <div class="editBox two-row" v-if="detail.rtype==1">
                        <div class="d-flex d-flex-center">
                            <span class="sumin">总金额</span>
                            <div class="pin"></div>
                            <div class="fill-in flex">
                                <input type="text" style="font-size:30px;" placeholder="0.00"
                                    @input="detail.money = filtFloat(detail.money)"
                                    maxlength="10"
                                    v-model="detail.money" class="flex" />
                            </div>
                            <span v-show="!canUsePrivateRedBag" >元</span>
                        </div>
                        <div class="create-tip" @click="detail.rtype=0;detail.money=''">当前为拼手气红包，<span>改为等分红包</span></div>
                    </div>
                    <div class="editBox d-flex d-flex-center">
                        <span>红包个数</span>
                        <div class="fill-in flex">
                            <input type="text" :placeholder="'填写红包个数，最多'+ maxWxNum" class="flex"
                                   @input="detail.nums = filtInt(detail.nums)"
                                   v-model="detail.nums" />
                        </div>
                        <span>个</span>
                    </div>
                </section>

                <section class="red-input-group" @click="showChooseCom" v-if="canUsePrivateRedBag">
                    <div class="editBox private-redbag-openchoose">
                        <div class="private-redbag-choose">
                            <span>客服二维码 </span>
                            <div class="up-down"></div>
                        </div>
                        <div class="res-tipsdx">用户添加客服凭红包领取截图取现金红包</div>
                    </div>
                </section>

                <section class="redrain-add-group" v-if="redpacket.details.length<10" @click="addNextRain">添加下一轮红包雨</section>
                
                <section class="red-input-group">
                    <div class="editBox d-flex d-flex-center">
                        <div class="new-label">
                            <p>领取区域</p>
                            <span>选择可领取区域</span>
                        </div>
                        <div class="fill-in fill-in-t flex">
                            <input type="text" placeholder="所有区域" class="flex" v-model="redpacket.citys" readonly @click="showArea=true" />
                        </div>
                        <div class="up-down"></div>
                    </div>
                    <!-- <div class="editBox d-flex d-flex-center">
                        <span>发送选项</span>
                        <div class="fill-in fill-in-t flex">
                            <van-radio-group v-model="redpacket.rptype" direction="horizontal" >
                                <van-radio name="redpacket.rptype!=0" style="justify-content:flex-end">定时发送</van-radio>
                                <van-radio name="redpacket.rptype==0" style="justify-content:flex-end">立即发送</van-radio>
                            </van-radio-group>
                        </div>
                    </div> -->
                    
                    <div class="editBox d-flex d-flex-center">
                        <div class="new-label">
                            <p>持续时间</p>
                            <span>红包雨持续时长5-60秒</span>
                        </div>
                        <div class="fill-in flex">
                            <input type="text" placeholder=""
                                   @input="redpacket.lastTime = filtInt(redpacket.lastTime)"
                                   v-model="redpacket.lastTime" class="flex" />
                        </div>
                        <span>秒</span>
                    </div>
                    <div class="editBox d-flex d-flex-center">
                        <div class="new-label">
                            <p>每轮预留红包</p>
                            <span>预留<var>{{redpacket.occupyNum||0}}</var>个红包，保证前<var>{{redpacket.occupyNum||0}}</var>个用户至少获得1个红包</span>
                        </div>
                        <div class="fill-in flex">
                            <input type="text" placeholder="0" maxlength="7"
                                   @input="redpacket.occupyNum = filtInt(redpacket.occupyNum)"
                                   v-model="redpacket.occupyNum" class="flex" />
                        </div>
                        <span>个</span>
                    </div>
                    <div class="editBox d-flex d-flex-center">
                        <div class="new-label">
                            <p>每轮最多领取</p>
                            <span>每人最多领取个数，0表示不限制</span>
                        </div>
                        <div class="fill-in flex">
                            <input type="text" placeholder="0"
                                   @input="redpacket.perUserLimit = filtInt(redpacket.perUserLimit)"
                                   v-model="redpacket.perUserLimit" class="flex" />
                        </div>
                        <span>个</span>
                    </div>
                </section>

                <section class="red-input-group">
                    <div class="editBox d-flex d-flex-center no-border">
                        <span>红包封面</span>
                        <div class="fill-in flex" style="margin-right:0;">
                            <a href="https://j.weizan.cn/LiveAdmin/assets/html/coverRule/rain.html" class="cover-tip">封面设计规范</a>
                        </div>
                    </div>
                    <div class="cover-list-area">
                        <div class="cover-list">
                        <!-- @click="beforeUploadCover" -->
                            <div class="cover-item add" @click="beforeUploadCover">添加封面</div>
                            <div class="cover-item normal" v-for="item in coverList" :key="item.id" 
                                @click="setCover(item)" :class="{check:item.cover == redpacket.cover && item.bubbleCover == redpacket.bubblecover}">
                                <img :src="item.cover">
                                <i class="del iconfont iconguanbi" v-if="item.id" @click.stop="beforeDelCover(item)"></i>
                            </div>
                        </div>
                    </div>
                </section>
                <input type="file" ref="rainCover" @change="uploadCover" accept="image/*" style="display: none;">
            </template>
            <!-- 查看 编辑 -->
            <template class="redpacket-create-main" v-else>
				<section class="red-input-group">
					<div class="editBox d-flex d-flex-center" @click="showTime=true;">
                        <span>发送时间</span>
                        <div class="fill-in fill-in-t flex">
                            <input type="text" placeholder="请选择发送时间" v-model="redData.Addtime" class="flex" readonly />
                        </div>
                        <div class="up-down"></div>
                    </div>
					<div class="editBox two-row" v-if="redData.RType==0">
						<div class="d-flex d-flex-center">
							<span class="sumin">单个金额</span>
							<div class="fill-in flex grey">{{(redData.Total_Amount/redData.Target_User_Count*0.01).toFixed(2)}}</div>
							<span v-show="!canUsePrivateRedBag">元</span>
						</div>
						<div class="create-tip">当前为等分红包</div>
					</div>
					<div class="editBox two-row" v-if="redData.RType==1">
						<div class="d-flex d-flex-center">
							<span class="sumin">总金额</span>
							<div class="pin"></div>
							<div class="fill-in flex grey">{{(redData.Total_Amount*0.01).toFixed(2)}}</div>
							<span v-show="!canUsePrivateRedBag">元</span>
						</div>
						<div class="create-tip">当前为拼手气红包</div>
					</div>
					<div class="editBox d-flex d-flex-center">
                        <span>红包个数</span>
                        <div class="fill-in flex grey">{{redData.Target_User_Count}}</div>
						<span>个</span>
                    </div>
				</section>
				
                <section class="red-input-group" :class="{'isend':isend=='1'}">
                    <div class="editBox d-flex d-flex-center">
						<div class="new-label">
                            <p>领取区域</p>
                            <span>选择可领取区域</span>
                        </div>
                        <div class="fill-in fill-in-t flex">
                            <input type="text" placeholder="所有区域" class="flex" v-model="redData.Citys" readonly @click="showArea=true" />
                        </div>
                        <div class="up-down"></div>
                    </div>
					<div class="editBox d-flex d-flex-center">
						<div class="new-label">
                            <p>持续时间</p>
                            <span>红包雨持续时长5-60秒</span>
                        </div>
                        <div class="fill-in flex">
                            <input type="text" placeholder="红包雨持续时长5-60秒"
                                   @input="redData.LastTime = filtInt(redData.LastTime)"
                                   v-model="redData.LastTime" class="flex" />
                        </div>
                        <span>秒</span>
                    </div>
                    <div class="editBox d-flex d-flex-center">
						<div class="new-label">
                            <p>每轮预留红包</p>
                            <span>预留<var>{{redData.OccupyNum||0}}</var>个红包，保证前<var>{{redData.OccupyNum||0}}</var>个用户至少获得1个红包</span>
                        </div>
                        <div class="fill-in flex">
                            <input type="text" placeholder="0" maxlength="7"
                                   @input="redData.OccupyNum = filtInt(redData.OccupyNum)"
                                   v-model="redData.OccupyNum" class="flex" />
                        </div>
                        <span>个</span>
                    </div>
                    <div class="editBox d-flex d-flex-center">
						<div class="new-label">
                            <p>每轮最多领取</p>
                            <span>每人最多领取个数，0表示不限制</span>
                        </div>
                        <div class="fill-in flex">
                            <input type="text" placeholder="每人最多领取个数，0表示不限制"
                                   @input="redData.Per_User_Limit = filtInt(redData.Per_User_Limit)"
                                   v-model="redData.Per_User_Limit" class="flex" />
                        </div>
                        <span>个</span>
                    </div>
                </section>

                <section class="red-input-group">
                    <div class="editBox d-flex d-flex-center no-border">
                        <span>红包封面</span>
                        <div class="fill-in flex" style="margin-right:0;">
                            <a href="https://j.weizan.cn/LiveAdmin/assets/html/coverRule/rain.html" class="cover-tip">封面设计规范</a>
                        </div>
                    </div>
                    <div class="cover-list-area">
                        <div class="cover-list">
                            <div class="cover-item add" @click="beforeUploadCover">添加封面</div>
                            <div class="cover-item normal" v-for="item in coverList" :key="item.id" 
                                @click="setCover(item)" :class="{check:item.cover == redpacket.cover && item.bubbleCover == redpacket.bubblecover}">
                                <img :src="item.cover">
                                <i class="del iconfont iconguanbi" v-if="item.id" @click.stop="beforeDelCover(item)"></i>
                            </div>
                        </div>
                    </div>
                </section>
            </template>
            </template>
            <!-- 服务条款 -->
            <!-- <template>
                <div class="clause-tips">
                    <span></span>
                    <div class="tip-right" @click="showClause=true">
                        服务条款
                    </div>
                </div>
                <div class="pop-up-model" v-if="showClause">
                    <div class="clause-wrap">
                        <div class="clause-con">
                            <p class="clause-con-tit">服务条款</p>
                            <p>发送红包时本平台将收取0.6%的手续费；使用本平台发送红包功能则表示您默认同意本服务条款</p>
                        </div>
                        <div class="clause-btn" v-on:click="showClause=false">我知道了</div>
                    </div>
                </div>
            </template> -->
        </div>


        <footer class="send-redpacket-footer zero">
            <button class="submit" v-if="!id"
                    :class="{'disabled':errText}" @click="beforeSubmit">
                生成红包雨{{total?' '+(!isCreator && !zbvd.isAlonePay?realMoney:total):''}}
            </button>
            <button class="submit" :class="{'disabled':errUpdateText}" v-else @click="isend?$router.go(-1):updateRain()">确定</button>
            <p class="paytype-2-tips" v-if="canUsePrivateRedBag" >“核销红包”需要已领取红包的用户添加客服领取</p>
            <template v-else>
                <p class="unreceived">未领取的微信支付红包，需后台手动发起退款；未领取的第三方支付红包，将于24小时后自动退款</p>
                <p class="unreceived" v-if="!id">
                    红包总金额最多支持发放{{maxWxPay/100}}元
                <!-- <span v-if="isCreator">，直播间余额发红包最多支持{{maxCashPay/100}}元</span> -->
            </p>
            </template>
        </footer>
        <!-- 城市选择 -->
        <van-popup v-model="showArea" position="bottom">
            <van-area :area-list="redBagAreaList" :columns-num="2"
                      @confirm="selectArea" @cancel="showArea=false" value="100000" />
        </van-popup>
        <!-- 时间选择 -->
        <van-popup v-model="showTime" position="bottom">
            <van-datetime-picker v-model="beginTime" type="datetime"
                                 @confirm="selectTime" @cancel="showTime=false" :min-date="twoMinLater" />
        </van-popup>

        <!-- 选择支付方式 -->
        <div class="pay-shadow" v-if="checkPay" @click="checkPay=false">
            <section class="pay-red-box" @click.stop="">
                <h1 class="pay-title">支付金额</h1>
                <p class="pay-total">￥<var>{{realMoney}}</var></p>
                <div class="pay-option-area">
                    <div class="pay-option">支付方式</div>
                    <div v-if="zbvd.roleid > 0" class="pay-option" @click="redpacket.paytype = 3">
                        <i class="option-icon icon-ac"></i>
                        <div class="option-text">
                          <p>第三方支付</p>
                          <span v-if="merchantInfo.isLianLianPay && zbvd.userid == zbvd.siteuser"><var>余额 {{ (balance / 100).toFixed(2) }}</var></span>
                        </div>
                        <i class="option-check" :class="{on:redpacket.paytype == 3}"></i>
                    </div>
                    <div class="pay-option" @click="redpacket.paytype = 0">
                        <i class="option-icon icon-wechat"></i>
                        <div class="option-text">
                          <p>微信支付</p>
                          <span><var>含微信官方0.6%商户收款手续费</var></span>
                        </div>
                        <i class="option-check" :class="{on:redpacket.paytype == 0}"></i>
                    </div>
                    <div v-if="merchantInfo.isIndePay && (isCreator || zbvd.roleid == 2)" class="pay-option" @click="redpacket.paytype = 4">
                        <i class="option-icon icon-ac"></i>
                        <div class="option-text">
                          <p>虚拟余额支付</p>
                          <span><var>余额 {{ (virtualBalance / 100).toFixed(2)}}</var></span>
                        </div>
                        <i class="option-check" :class="{on:redpacket.paytype == 4}"></i>
                    </div>
                    <!-- <div v-if="zbvd.zbid == 75999" class="pay-option" @click="redpacket.paytype = 1">
                        <i class="option-icon icon-ac"></i>
                        <div class="option-text">
                            <p>直播间余额支付</p>
                            <span>直播间余额 ¥{{liveMoney}} <var v-if="liveMoney*1 < totalMoney.replace(',','')*1">余额不足</var></span>
                        </div>
                        <i class="option-check" :class="{on:redpacket.paytype == 1}"></i>
                    </div> -->
                </div>
                <button class="pay-submit" @click="submit">确定支付</button>
            </section>
        </div>



    </div>


</script>
<!-- 创建答题红包 -->
<script type="text/x-template" id="send-redpacket-answer">
    <div class="redpacket-create" v-cloak>
        <!-- 查看 编辑 -->
        <div class="redpacket-create-main" v-if="id" :class="{'forbid':isend}">
            <section class="red-input-group">
                <div class="editBox d-flex d-flex-center">
                    <span class="sumin">红包金额</span>
                    <div class="fill-in flex red">￥{{(redData.Total_Amount*0.01).toFixed(2)}}</div>
                </div>
                <div class="editBox d-flex d-flex-center">
                    <span>红包总数</span>
                    <div class="fill-in flex red">{{redData.Target_User_Count}}</div>
                </div>
            </section>
            <section class="red-input-group">
                <div class="editBox d-flex d-flex-center">
                    <span>领取区域</span>
                    <div class="fill-in fill-in-t flex">
                        <input type="text" :placeholder="isend?'所有区域,所有区域':'选择领取区域'" class="flex" v-model="redData.Citys" readonly @click="showArea=true" />
                    </div>
                    <div class="up-down" v-if="!isend"></div>
                </div>
            </section>
            <section class="answer-area">
                <h1 class="answer-item required">题目名称</h1>
                <input class="answer-item" type="text" v-model.trim="Question.Question"
                       placeholder="请输入题目名称，50字之内" maxlength="50">
            </section>
            <section class="answer-area">
                <h1 class="answer-item required">选项设置</h1>
                <div class="answer-item" v-for="(item,index) in Question.Options">
                    <span class="option" :class="{'required':index<=1}">{{['A','B','C','D'][index]}}</span>
                    <input type="text" v-model.trim="Question.Options[index]" placeholder="选项需限制在10字以内" maxlength="10">
                    <div class="del" v-if="index>1 && !isend" @click="Question.Options.splice(index,1)"></div>
                </div>
                <div class="answer-item add" v-if="Question.Options.length<4 && !isend"
                     @click="Question.Options.push('')">添加选项 +</div>
            </section>
            <section class="answer-area" @click="openOption">
                <h1 class="answer-item required">设置正确选项</h1>
                <div class="answer-item">
                    <input type="text" class="flex" v-model="redData.Answer" readonly placeholder="请选择正确选项" style="margin:0 5px;">
                    <i class="up-down" v-if="!isend"></i>
                </div>
            </section>
        </div>
        <!-- 第一步 -->
        <div class="redpacket-create-main" v-show="step==1" v-else>
            <section class="answer-area">
                <h1 class="answer-item required">题目名称</h1>
                <input class="answer-item" type="text" v-model.trim="Question.Question"
                       placeholder="请输入题目名称，50字之内" maxlength="50">
            </section>
            <section class="answer-area">
                <h1 class="answer-item required">选项设置</h1>
                <div class="answer-item" v-for="(item,index) in Question.Options">
                    <span class="option" :class="{'required':index<=1}">{{['A','B','C','D'][index]}}</span>
                    <input type="text" v-model.trim="Question.Options[index]" placeholder="选项需限制在10字以内" maxlength="10">
                    <div class="del" v-if="index>1" @click="Question.Options.splice(index,1)"></div>
                </div>
                <div class="answer-item add" v-if="Question.Options.length<4"
                     @click="Question.Options.push('')">添加选项 +</div>
            </section>
            <section class="answer-area" @click="openOption">
                <h1 class="answer-item required">设置正确选项</h1>
                <div class="answer-item">
                    <input type="text" class="flex" v-model="redpacket.Answer" readonly placeholder="请选择正确选项" style="margin:0 5px;">
                    <i class="up-down"></i>
                </div>
            </section>

        </div>
        <!-- 选项选择 -->
        <van-popup v-model="showOption" position="bottom">
            <van-picker show-toolbar :columns="Question.Options"
                        @confirm="selectOption"
                        @cancel="showOption=false" />
        </van-popup>
        <!-- 第二步 -->
        <div class="redpacket-create-main" v-show="step==2">
            
            
            <section class="red-input-group">
                <div class="editBox two-row" v-if="redpacket.rtype==0">
                    <div class="d-flex d-flex-center">
                        <span class="sumin">单个金额</span>
                        <div class="fill-in flex">
                            <input type="text" style="font-size:30px;" placeholder="0.00"
                                @input="redpacket.singlemoneystr = filtFloat(redpacket.singlemoneystr)"
                                v-model="redpacket.singlemoneystr" class="flex" />
                        </div>
                        <span v-show="!canUsePrivateRedBag">元</span>
                    </div>
                    <div class="create-tip" @click="redpacket.rtype=1">当前为等分红包，<span>改为拼手气红包</span></div>
                </div>
                <div class="editBox two-row" v-if="redpacket.rtype==1">
                    <div class="d-flex d-flex-center">
                        <span class="sumin">总金额</span>
                        <div class="pin"></div>
                        <div class="fill-in flex">
                            <input type="text" style="font-size:30px;" placeholder="0.00"
                                @input="redpacket.money = filtFloat(redpacket.money)"
                                maxlength="10"
                                v-model="redpacket.money" class="flex" />
                        </div>
                        <span v-show="!canUsePrivateRedBag">元</span>
                    </div>
                    <div class="create-tip" @click="redpacket.rtype=0">当前为拼手气红包，<span>改为等分红包</span></div>
                </div>
                <div class="editBox d-flex d-flex-center">
                    <span>红包个数</span>
                    <div class="fill-in flex">
                        <input type="text" :placeholder="'填写红包个数，最多'+maxWxNum" class="flex"
                               @input="redpacket.nums = filtInt(redpacket.nums)"
                               v-model="redpacket.nums" />
                    </div>
                    <span>个</span>
                </div>
            </section>
            <section class="red-input-group">
                <div class="editBox d-flex d-flex-center">
                    <span>领取区域</span>
                    <div class="fill-in fill-in-t flex">
                        <input type="text" placeholder="选择领取区域" class="flex" v-model="redpacket.citys" readonly @click="showArea=true" />
                    </div>
                    <div class="up-down"></div>
                </div>
            </section>

            <section class="red-input-group">
                <div class="editBox d-flex d-flex-center">
                    <span>推送方式</span>
                    <div class="fill-in fill-in-t flex">
                        <select id="answerPushType"v-model="redpacket.ispush" style="width:120px;font-size: 1.4rem;">
                            <option :value="1">立即自动推送</option>
                            <option :value="0">稍后手动推送</option>
                        </select>
                    </div>
                    <div class="up-down"></div>
                </div>
            </section>

            <section class="red-input-group" @click="showChooseCom" v-if="canUsePrivateRedBag">
                <div class="editBox private-redbag-openchoose">
                    <div class="private-redbag-choose">
                        <span>客服二维码 </span>
                        <div class="up-down"></div>
                    </div>
                    <div class="res-tipsdx">用户添加客服凭红包领取截图取现金红包</div>
                </div>
            </section>

            <!-- <div class="clause-tips">
                <div class="tip-right" v-if="!canUsePrivateRedBag" @click="showClause=true">
                    服务条款
                </div>
            </div>
            <div class="pop-up-model" v-if="showClause">
                <div class="clause-wrap">
                    <div class="clause-con">
                        <p class="clause-con-tit">服务条款</p>
                        <p>发送红包时本平台将收取0.6%的手续费；使用本平台发送红包功能则表示您默认同意本服务条款</p>
                    </div>
                    <div class="clause-btn" v-on:click="showClause=false">我知道了</div>
                </div>
            </div>-->
        </div>
        <footer class="create-footer">
            <button class="light" @click="next" v-if="step==1 && !id">下一步</button>
            <button class="light" v-else-if="id&&!isend" @click="updateAnswer">确定</button>
            <button class="light" v-else-if="id&&isend" @click="$router.go(-1)">我知道了</button>
            <template v-else>
                <button @click="step=1">上一步</button>
                <button class="light" @click="submitCreateRedbag">生成答题红包</button>
                
            </template>
        </footer>
        
        <p class="paytype-2-tips" v-if="canUsePrivateRedBag" >“核销红包”需要已领取红包的用户添加客服领取</p>
        <template v-else>
            <p class="unreceived">未领取的微信支付红包，需后台手动发起退款；未领取的第三方支付红包，将于24小时后自动退款</p>
            <p class="unreceived" v-if="step==2 && !id">
                红包总金额最多支持发放{{maxWxPay/100}}元
            <!-- <span v-if="isCreator">，直播间余额发红包最多支持{{maxCashPay/100}}元</span> -->
        </p>
        </template>
        <!-- 城市选择 -->
        <van-popup v-model="showArea" position="bottom">
            <van-area :area-list="redBagAreaList" :columns-num="2"
                      @confirm="selectArea" @cancel="showArea=false" value="100000" />
        </van-popup>

        <!-- 选择支付方式 -->
        <div class="pay-shadow" v-if="checkPay" @click="checkPay=false">
            <section class="pay-red-box" @click.stop="">
                <h1 class="pay-title">支付金额</h1>
                <p class="pay-total">￥<var>{{realMoney}}</var></p>
                <div class="pay-option-area">
                    <div class="pay-option">支付方式</div>
                    <div v-if="zbvd.roleid > 0" class="pay-option" @click="redpacket.paytype = 3">
                        <i class="option-icon icon-ac"></i>
                        <div class="option-text">
                          <p>第三方支付</p>
                          <span v-if="merchantInfo.isLianLianPay && zbvd.userid == zbvd.siteuser"><var>余额 {{ (balance / 100).toFixed(2) }}</var></span>
                        </div>
                        <i class="option-check" :class="{on:redpacket.paytype == 3}"></i>
                    </div>
                    <div class="pay-option" @click="redpacket.paytype = 0">
                        <i class="option-icon icon-wechat"></i>
                        <div class="option-text">
                          <p>微信支付</p>
                          <span><var>含微信官方0.6%商户收款手续费</var></span>
                        </div>
                        <i class="option-check" :class="{on:redpacket.paytype == 0}"></i>
                    </div>
                    <div v-if="merchantInfo.isIndePay && (isCreator || zbvd.roleid == 2)" class="pay-option" @click="redpacket.paytype = 4">
                        <i class="option-icon icon-ac"></i>
                        <div class="option-text">
                          <p>虚拟余额支付</p>
                          <span><var>余额 {{ (virtualBalance / 100).toFixed(2)}}</var></span>
                        </div>
                        <i class="option-check" :class="{on:redpacket.paytype == 4}"></i>
                    </div>
                    <!-- <div v-if="zbvd.zbid == 75999" class="pay-option" @click="redpacket.paytype = 1">
                        <i class="option-icon icon-ac"></i>
                        <div class="option-text">
                            <p>直播间余额支付</p>
                            <span>直播间余额 ¥{{liveMoney}} <var v-if="liveMoney*1 < totalMoney.replace(',','')*1">余额不足</var></span>
                        </div>
                        <i class="option-check" :class="{on:redpacket.paytype == 1}"></i>
                    </div> -->
                </div>
                <button class="pay-submit" @click="toCreate">确定支付</button>
            </section>
        </div>
    </div>
</script>

<!-- 发布红包弹窗结束 -->
<!-- 红包相关容器 -->
<div>
    <div class="newredbag" id="newredbagContentApp" style="display:none">
        <div id="redbagimgcode" @touchmove.prevent></div>
        <div class="fixed-tk" v-if="popuptype!=''" @click="popuptype == 'redbaginfo'? closeredbagcontent():null">
            <div class="more-redpack-group" style="display: none;">
                <div @click="getCompanyRedpacket('prev')" class="more-redpack-btn prev"></div>
                <div @click="getCompanyRedpacket('next')" class="more-redpack-btn next"></div>
            </div>
            <div class="basewrap new-tk" v-if="!isPc"></div>
            <div class="animated redPackets-wrap">
                <!-- 领取红包 -->
                <div class="redPackets-bg" v-if="popuptype=='openredbag'">
                    <div class="uesrImg"><img v-bind:src="redbaginfo.headimgurl" alt="" /></div>
                    <p class="uesrName">
                        {{ Utils.getOmitNickName(Utils.filterPhone(redbaginfo.nickname)) }}
                    </p>
                    <p class="send-tips">发了一个红包，请查收</p>
                    <p class="oupai-countdown" v-show="awaitSeconds>0">红包 <var>{{awaitSeconds}}</var> 秒后即可领取，请做好准备</p>
                    <p class="blessings oupai-redbag">{{redbaginfo.remark}}</p>
                    <button class="open-button" v-on:click="OpenRedBag"></button>
                    <img class="redpack-bg-footer" src="https://static1.weizan.cn/zhibo/livecontent/new-2018/redpack2021/redpack-bg-footer.png">
                    <i class="hb-close" v-on:click="closeredbagcontent"></i>
                </div>
                <!-- 已领完 -->
                <div class="redPackets-bg" v-if="popuptype=='redbagout'">
                    <div class="uesrImg"><img v-bind:src="redbaginfo.headimgurl" alt="" /></div>
                    <p class="uesrName">
                        {{ Utils.getOmitNickName(Utils.filterPhone(redbaginfo.nickname)) }}
                    </p>
                    <p class="send-tips">发了一个红包，请查收</p>
                    <p class="received" style="font-size:1.4rem" v-if="popupstate == 'expired'">该红包已超过24小时，不能进行领取</p>
                    <p class="received" v-else>该红包已被领完</p>
                    <div class="send-again" v-if="!isPc && redbaginfo.paytype != 2">
                        <a href="javascript:;" v-on:click="sendRedbag" v-if="issendredbag">
                            <span>我也发一个</span>
                        </a>
                    </div>
                    <span class="receive-xq" v-on:click="lookRedbagDetail('')" v-if="isRecord && !redbaginfo.refund">
                        查看领取详情
                    </span>
                    <img class="redpack-bg-footer" src="https://static1.weizan.cn/zhibo/livecontent/new-2018/redpack2021/redpack-bg-footer.png">
                    <i class="hb-close" v-on:click="closeredbagcontent"></i>
                </div>
                <!-- 领取成功弹窗 -->
                <div class="redPackets-bg redPackets-gotyep" :class="{'qrcode-redbag':redbaginfo.paytype == 2}" v-if="popuptype=='getsuccess'">
                    <div class="uesrImg"><img :src="redbaginfo.headimgurl" alt="" /></div>
                    <p class="uesrName">{{ Utils.getOmitNickName(redbaginfo.nickname) }}</p>
                    <p v-if="redbaginfo.paytype != 2" class="send-tips">恭喜您获得红包</p>
                    <p class="received">￥{{(redbaginfo.resultMoney*0.01).toFixed(2)}}</p>
                    <div v-if="redbaginfo.paytype == 2">
                        <div class="private-redbag" >
                            <div class="private-redbag-weilingqu"></div>
                            <div class="private-redbag-qrcode" v-if="redbaginfo.redPacketConfigs.exchangeCode.indexOf('data:image') == 0" >
                                <img :src="redbaginfo.redPacketConfigs.exchangeCode" alt="">
                            </div>
                            <div class="private-redbag-info">
                                <div class="private-redbag-title">核销码</div>
                                <div class="private-redbag-title">截图保存作为核销凭证</div>
                            </div>
                        </div>
                        <span class="receive-xq receive-xq-code" v-on:click="lookRedbagDetail('')" v-if="isRecord && !redbaginfo.refund">
                            查看领取详情
                        </span>
                        <div class="private-redbag-serice">
                            <div class="private-redbag-tips">{{redbaginfo.redPacketConfigs.exchangeMsg}}</div>
                            <img class="private-redbag-serice-qrcode" :src="redbaginfo.redPacketConfigs.qrcode" alt="">
                            <div class="private-redbag-connect">客服二维码</div>
                        </div>
                    </div>
                    <div v-else class="receive-xq">
                        <p v-if="redbaginfo.autoWithdrawal">已自动提现至微信零钱，约1~3个小时内到账</p>
                        <template v-else>
                            <p>已存入微赞个人钱包 <a style="color: #006cff" :href="'/live/m/income?zbid=' + zbvd.zbid + '&tpid=' + zbvd.topicid + '&cashIntoType=1&payType=' + redbaginfo.paytype">去提现</a></p>
                            <p>或您可在互动区底部-提现 提现到银行卡</p>
                        </template>
                    </div>
                    <i class="hb-close" v-on:click="closeredbagcontent"></i>
                </div>
                <!-- 企业红包领取成功弹窗 -->
                <div class="redPackets-bg redPackets-gotyep company" :class="{normal:redbaginfo.rptype==0, 'qrcode-redbag':redbaginfo.paytype == 2}" v-if="popuptype=='companysuccess'">
                    <div class="company-title" v-if="redbaginfo.mode=='have'">你已经领过啦～</div>
                    <div class="company-title" v-else-if="redbaginfo.mode=='oldUser'" style="margin-bottom: 123px;">只有新用户可以领哦～</div>
                    <div class="company-title" v-else>恭喜您抢到红包</div>
                    <p class="company-money" v-if="redbaginfo.mode!='oldUser'"><var>{{redbaginfo.resultMoney/100}}</var>元</p>
                    <div class="company-normal" v-if="redbaginfo.mode!='oldUser' && redbaginfo.paytype != 2" style="margin-bottom: 30px;">
                        <p v-if="redbaginfo.autoWithdrawal">已自动提现至微信零钱，约1~3个小时内到账</p>
                        <p v-else>已存入微赞个人钱包 <a style="color: #006cff" :href="'/live/m/income?zbid=' + zbvd.zbid + '&tpid=' + zbvd.topicid + '&cashIntoType=1&payType=' + redbaginfo.paytype">去提现</a></p>
                    </div>
                    <p class="company-normal" @click="lookRedbagDetail('')" v-if="isRecord && redbaginfo.paytype != 2">查看领取详情 ></p>                    
                    <div v-if="redbaginfo.paytype == 2">
                        <div class="private-redbag">
                            <div class="private-redbag-weilingqu" :class="{exchanged: redbaginfo.exchangeStatus == '已核销'}"></div>
                            <div class="private-redbag-qrcode" v-if="redbaginfo.redPacketConfigs.exchangeCode.indexOf('data:image') == 0" >
                                <img :src="redbaginfo.redPacketConfigs.exchangeCode" alt="">
                            </div>
                            <div class="private-redbag-info">
                                <div class="private-redbag-title">核销码</div>
                                <div class="private-redbag-title">截图保存作为核销凭证</div>
                            </div>
                        </div>
                        <span class="receive-xq receive-xq-code" v-on:click="lookRedbagDetail('')" v-if="isRecord && !redbaginfo.refund">
                            查看领取详情
                        </span>
                        <div class="private-redbag-serice">
                            <div class="private-redbag-tips">{{redbaginfo.redPacketConfigs.exchangeMsg}}</div>
                            <img class="private-redbag-serice-qrcode" :src="redbaginfo.redPacketConfigs.qrcode" alt="">
                            <div class="private-redbag-connect">客服二维码</div>
                        </div>
                    </div>
                    <footer class="company-bottom" v-else-if="(redbaginfo.rptype == 2 || redbaginfo.mode=='oldUser') && redbaginfo.paytype != 2">
                        <p class="company-num">当前红包剩余 {{redbaginfo.resultCount||0}} 个待领</p>
                        <p class="company-normal" style="margin:6px 0 2px;">看直播得红包</p>
                        <button @click="toInvite">{{/have|oldUser/.test(redbaginfo.mode)?'邀请好友一起看直播':'再领一个'}}</button>
                    </footer>
                    <footer class="company-bottom" v-else>
                        <p class="bottom-wish">{{redbaginfo.wish}}</p>
                    </footer>
                    <i class="hb-close" v-on:click="closeredbagcontent"></i>
                </div>
                <!-- 领取口令红包 -->
                <div class="redPackets-bg" v-if="popuptype=='commandbag'">
                    <div class="uesrImg"><img v-bind:src="redbaginfo.headimgurl" alt="" /></div>
                    <p class="uesrName">
                        {{ Utils.getOmitNickName(Utils.filterPhone(redbaginfo.nickname)) }}
                    </p>
                    <p class="send-tips">发了一个口令红包，请查收</p>
                    <p class="oupai-countdown" v-show="awaitSeconds>0">红包 <var>{{awaitSeconds}}</var> 秒后即可领取，请做好准备</p>
                    <p class="blessings kl-tips" v-if="redbaginfo.commandtips!=''">口令提示：{{redbaginfo.commandtips}}</p>
                    <p class="blessings kl-tips" v-else></p>
                    <div class="password"><input type="text" placeholder="请输入口令红包" v-model="redbaginfo.command" /></div>
                    <button class="confirm-butt open-button" v-on:click="openredbagbycommand"></button>
                    <img class="redpack-bg-footer" src="https://static1.weizan.cn/zhibo/livecontent/new-2018/redpack2021/redpack-bg-footer.png">
                    <i class="hb-close" v-on:click="closeredbagcontent"></i>
                </div>
                <!-- 企业红包 -->
                <div class="redPackets-bg company" :style="{backgroundImage:'url('+redbaginfo.cover+')'}" v-if="popuptype=='company'">
                    <p class="company-title">{{redbaginfo.companyname}}</p>
                    <!--   <p class="company-text">{{redbaginfo.rptype == 2?redbaginfo.redpwd:redbaginfo.wish}}</p> -->
                    <p class="blessings oupai-redbag">{{redbaginfo.rptype == 2?redbaginfo.redpwd:redbaginfo.wish}}</p>
                    <button class="timing-button" v-if="redbaginfo.rptype == 2" @click="OpenRedBag">发送口令，抢红包</button>
                    <button class="open-button" v-else @click="OpenRedBag"></button>
                    <p class="company-tips-rptype" v-if="redbaginfo.rptype == 2 && redbaginfo.inviteUser"> 
                        <span>{{redbaginfo.inviteUser.substr(0, 10)}}</span>
                        <span>送你一次拆红包的机会</span>
                    </p>
                    <i class="hb-close" v-on:click="closeredbagcontent"></i>
                    <img class="redpack-bg-footer" src="https://static1.weizan.cn/zhibo/livecontent/new-2018/redpack2021/redpack-bg-footer.png">
                </div>
                <!-- 图片验证码 -->
                <div class="redPackets-bg" style="display:none;">
                    <div class="uesrImg"><img v-bind:src="redbaginfo.headimgurl" alt="" /></div>
                    <p class="uesrName">2号车厢</p>
                    <p class="send-tips">发了一个红包，金额随机</p>
                    <div class="yzm-Code"><img src="" alt="" /></div>
                    <div class="password"><input type="text" placeholder="请输入验证码" /></div>
                    <button class="confirm-butt">确认</button>
                    <img class="redpack-bg-footer" src="https://static1.weizan.cn/zhibo/livecontent/new-2018/redpack2021/redpack-bg-footer.png">
                    <i class="hb-close"></i>
                </div>
                <!-- 区域红包 -->
                <div class="redPackets-bg" v-if="popuptype=='nothisarea'">
                    <div class="uesrImg"><img v-bind:src="redbaginfo.headimgurl" alt="" /></div>
                    <p class="uesrName">
                        {{ Utils.getOmitNickName(Utils.filterPhone(redbaginfo.nickname)) }}
                    </p>
                    <p class="send-tips">发了一个红包，请查收</p>
                    <p class="blessings">{{redbaginfo.remark}}</p>
                    <p class="area-tips">该红包不能在该区域领取</p>
                    <img class="redpack-bg-footer" src="https://static1.weizan.cn/zhibo/livecontent/new-2018/redpack2021/redpack-bg-footer.png">
                    <i class="hb-close" v-on:click="closeredbagcontent"></i>
                </div>
                <!-- 商家红包领取 -->
                <div class="redPackets-bg-a" v-if="popuptype=='merchantbag'">
                    <div class="uesrImg"><img v-bind:src="redbaginfo.headimgurl" alt="" /></div>
                    <p class="uesrName">{{ Utils.getOmitNickName(redbaginfo.nickname) }}</p>
                    <p class="send-tips">发了一个商家红包，请查收</p>
                    <div class="business-ad">
                        <img v-bind:src="redbaginfo.advimg" alt="" />
                        <div class="djs-s">
                            <span id="t_s">{{redbaginfo.countdowns}}</span>s
                        </div>
                    </div>
                    <img class="redpack-bg-footer" src="https://static1.weizan.cn/zhibo/livecontent/new-2018/redpack2021/redpack-bg-footer.png">
                    <i class="hb-close" v-on:click="closeredbagcontent"></i>
                </div>
                <!-- 定时红包 -->
                <div class="redPackets-bg" v-if="popuptype=='timingbagshow'">
                    <div class="uesrImg"><img v-bind:src="redbaginfo.headimgurl" alt="" /></div>
                    <p class="ds-user">{{ Utils.getOmitNickName(redbaginfo.nickname) }}</p>
                    <p class="blessings oupai-redbag">{{redbaginfo.remark}}</p>
                    <p class="timing-tips" v-if="redbaginfo.opentime!='' && countdownstr!=''">开抢倒计时</p>
                    <button class="timing-button" v-if="redbaginfo.opentime!=''&& countdownstr!=''">{{countdownstr}}</button>
                    <button class="open-button" v-else v-on:click="OpenRedBag()"></button>
                    <i class="hb-close" v-on:click="closeredbagcontent"></i>
                    <img class="redpack-bg-footer" src="https://static1.weizan.cn/zhibo/livecontent/new-2018/redpack2021/redpack-bg-footer.png">
                </div>
                <!-- 红包详情 已领取 <span></span> -->
                <div class="details-box" v-bind:class="{pcdetail:isPc}" v-if="popuptype=='redbaginfo'" @click.stop="">
                    <div class="head-t">
                        <div class="manImg"><img v-bind:src="redbaginfo.headimgurl" alt="" /></div>
                        <div class="nameUser d-flex d-flex-center" :class="{'nameUser-code':redbaginfo.paytype == 2}">
                            <p><span>{{ Utils.getOmitNickName(redbaginfo.nickname) }}</span>的红包<span class="verify-redbag" v-if="redbaginfo.paytype == 2" >核销红包</span></p>
                            <i v-if="redbaginfo.rtype == 1"></i>
                        </div>
                        <!-- <p class="message">{{redbaginfo.remark}}</p> -->
                    </div>
                    <div class="slide-in" v-on:scroll="loadScroll">
                        <div class="head-b">
                            <p class="b-sum" v-if="myredbagmoney > 0">{{myredbagmoney}}<span>元</span>
                                <a class="exchange-redbag" :href="'/live/page/subview/redpacketView?rid='+redbaginfo.rid" v-if="redbaginfo.paytype == 2" >兑换></a>
                            </p>
                            <p class="b-sum" v-if="false">该红包已被领完  </p>
                            <div class="d-flex d-flex-center b-bottom" v-if="showtool">
                                <div class="details-xq flex d-flex d-flex-center" v-if="issendredbag && redbaginfo.paytype != 2" v-on:click="sendRedbag">
                                    <i class="redbag"></i>
                                    <p>我也发一个</p>
                                </div>
                                <div class="details-xq flex d-flex d-flex-center" v-on:click="myredbaglog">
                                    <i class="redbag-record"></i>
                                    <p>红包记录</p>
                                </div>
                            </div>
                        </div>
                        <div class="hb-record">
                            <p>
                                <label v-if="popupstate=='expired'">该红包已过期，</label>
                                金额{{parseFloat(redbaginfo.redbagmoney).toFixed(2)}}元，已领取{{redbaginfo.draws}}/{{redbaginfo.redbagnums}}
                            </p>
                        </div>
                        <div class="receive-record">
                            <ul v-if="redbaginfo.drawuserlist.length>0">
                                <li class="d-flex d-flex-center" v-for="(item,index) in redbaginfo.drawuserlist">
                                    <div class="uImg"><img v-bind:src="item.headimgurl" alt="" /></div>
                                    <div class="user-words flex" v-bind:data-uid="item.userid">
                                            <p>{{ Utils.getOmitNickName(item.nickname) }}</p>
                                        <span style="line-height: 2.5rem">{{item.addtime}}</span>
                                    </div>
                                    <div class="jine">
                                        <p>{{parseFloat(item.packet_money / 100).toFixed(2)}}元</p>
                                        <div class="d-flex d-flex-center best" v-if="index==0 && redbaginfo.remain == 0 && redbaginfo.rtype == 1">
                                            <i></i>
                                            <span>手气最佳</span>
                                        </div>
                                    </div>
                                </li>
                            </ul>
                        </div>
                    </div>
                    <div class="return-live" v-on:click="closeredbagcontent">
                        <i></i>
                    </div>
                    <!-- <i class="hb-close" v-on:click="closeredbagcontent"></i> -->
                </div>
            </div>
        </div>
    </div>
</div>


<div id="rain-answer-app" v-cloak>
    <!-- 红包雨倒计时 -->
    <section class="red-rain-count-box" v-show="show==1">
        <div class="red-rain-count">
            <h1 class="vz-font">{{countdown(rainBegin)}}</h1>
            <!-- <p class="red-rain-foot" @click="show=0">我知道了</p> -->
        </div>
        <i class="result-btn" @click="show=0"></i>
    </section>
    
    <!-- 红包雨效果 -->
    <section class="red-rain-main" v-show="showRain && rainCount > 0">
        <div class="rain-item" v-for="(item,index) in list" @touchstart="rainClick(index,$event.target)" @mousedown="rainClick(index,$event.target)"
             @animationiteration="onRainRun(index,$event.target)"
             :class="[{'hide':item.hide},item.size,{'back':item.back}]"
             :style="{'left':item.left,'animation-delay':item.delay}">
            <img style="width: 100%;height: 100%;" :src="(red.Cover || red.cover) ? (red.Cover || red.cover) : 'https://j.weizan.cn/zhibo/livecontent/img/redpacket/cover-rain-1.png'" > 
        </div>
        <div id="rain-bg"></div>
		<div class="rain-toast">恭喜你 抢到了 元</div>
		<div class="count-money">￥<span class="vz-font">{{(rainMoneyTotal.sum*0.01).toFixed(2)}}</span></div>
        <div class="count-text vz-font">00:{{rainCount}}</div>
        <i class="red-rain-close rain-close" @click="stopRain('handle')"></i>
        <img v-if="(typeof (red.Cover || red.cover) == 'string' && (red.Cover || red.cover) ? (red.Cover || red.cover) : '' ).replace(/\s/g, '') == 'https://j.weizan.cn/zhibo/livecontent/img/redpacket/cover-rain-1.png'" class="yuanbao" src="https://static1.weizan.cn/zhibo/livecontent/new-2018/img/yuanbao.png">
    </section>

    <!-- 红包雨领取结果 -->
    <section class="red-rain-result-box" v-show="show==2" @click.self="rainConfigsData.paytype == 2 &&  (show=0)">
        <div class="red-rain-result animated zoomIn" style="animation-duration: 500ms">
			<div id="svga-get-rain1" v-show="rainMoneyTotal.sum > 0"></div>
			<div id="svga-get-rain2" v-show="rainMoneyTotal.sum > 0"></div>
            <div class="result-head" v-if="rainMoneyTotal.sum > 0">
                <h1></h1>
                <p class="result-money">
                    共<span class="vz-font">{{(rainMoneyTotal.sum/100).toFixed(2)}}</span>元
                </p>
				<div v-show="rainConfigsData.paytype != 2" class="tip">
                    <p v-if="rainConfigsData.autoWithdrawal">已自动提现至微信零钱，约1~3个小时内到账</p>
                    <p v-else>已存入微赞个人钱包 <a style="color: #006cff" :href="'/live/m/income?zbid=' + zbvd.zbid + '&tpid=' + zbvd.topicid + '&cashIntoType=1&payType=' + rainConfigsData.paytype">去提现</a></p>
                </div>
            </div>
            <div class="result-head error-mode" v-else>
                <h1></h1>
            </div>
            <div v-if="rainConfigsData.paytype == 2 && rainMoneyTotal.sum > 0">
                <div class="private-redbag" >
                    <div class="private-redbag-weilingqu"></div>
                    <div class="private-redbag-qrcode" v-if="rainConfigsData.configs.exchangeCode.indexOf('data:image') == 0" >
                        <img :src="rainConfigsData.configs.exchangeCode" alt="">
                    </div>
                    <div class="private-redbag-info">
                        <div class="private-redbag-title">核销码</div>
                        <div class="private-redbag-title">截图保存作为核销凭证</div>
                    </div>
                </div>
                <div class="private-redbag-serice" >
                    <div class="private-redbag-tips">{{rainConfigsData.configs.exchangeMsg}}</div>
                    <img class="private-redbag-serice-qrcode" :src="rainConfigsData.configs.qrcode" alt="">
                    <div class="private-redbag-connect">客服二维码</div>
                </div>
            </div>
			<div class="next-rain vz-font" v-if="rainMenuCountdown && rainConfigsData.paytype != 2 ">
				<h1></h1>
				{{rainMenuCountdown}}
			</div>
            <div v-else-if="rainConfigsData.paytype != 2 || rainMoneyTotal.sum==0" class="result-btn" @click="show=0" :class="{happyget:rainMoneyTotal.sum>0}"></div>
        </div>
		<div v-if="rainMenuCountdown" class="result-btn" 
		:class="rainMoneyTotal.sum>0?'happyget':'waitnext'" @click="show=0"></div>
    </section>
	<!-- 红包雨领取结果 上一轮 -->
	<section class="red-rain-result-box" v-if="show==6">
        <div class="red-rain-result animated zoomIn" style="animation-duration: 500ms">
            <div class="result-head prev-mode">
                <h1></h1>
                <p class="result-money">
                    共<span class="vz-font">{{(prevRainSum/100).toFixed(2)}}</span>元
                </p>
				<div v-show="rainConfigsData.paytype != 2" class="tip">
                    <p v-if="rainConfigsData.autoWithdrawal">已自动提现至微信零钱，约1~3个小时内到账</p>
                    <p v-else>已存入微赞个人钱包 <a style="color: #006cff" :href="'/live/m/income?zbid=' + zbvd.zbid + '&tpid=' + zbvd.topicid + '&cashIntoType=1&payType=' + rainConfigsData.paytype">去提现</a></p>
                </div>
            </div>
            <div class="result-head error-mode" v-else>
                <h1></h1>
            </div>
            <div v-if="rainConfigsData.paytype == 2">
                <div class="private-redbag" >
                    <div class="private-redbag-weilingqu"></div>
                    <div class="private-redbag-qrcode" v-if="rainConfigsData.configs.exchangeCode.indexOf('data:image') == 0" >
                        <img :src="rainConfigsData.configs.exchangeCode" alt="">
                    </div>
                    <div class="private-redbag-info">
                        <div class="private-redbag-title">核销码</div>
                        <div class="private-redbag-title">截图保存作为核销凭证</div>
                    </div>
                </div>
                <div class="private-redbag-serice" >
                    <div class="private-redbag-tips">{{rainConfigsData.configs.exchangeMsg}}</div>
                    <img class="private-redbag-serice-qrcode" :src="rainConfigsData.configs.qrcode" alt="">
                    <div class="private-redbag-connect">客服二维码</div>
                </div>
            </div>
			<div class="next-rain vz-font" v-if="rainMenuCountdown && rainConfigsData.paytype != 2">
				<h1></h1>
				{{rainMenuCountdown}}
			</div>
            <div v-else class="result-btn" @click="show=0"></div>
        </div>
		<div v-if="rainMenuCountdown" class="result-btn" @click="show=0"></div>
    </section>

    <!-- 红包答题 -->
    <section class="red-answer-box" v-show="show==3">
        <div class="red-answer">
            <h1>{{Question.Question}}</h1>
            <ul>
                <li @click="getRedpacket('answer',item)" v-for="(item,index) in Question.Options">{{['A','B','C','D'][index]}} {{item}}</li>
            </ul>
            <p class="answer-foot">选择答案参与抢红包</p>
        </div>
        <i class="red-rain-close" @click="show=0"></i>
    </section>

    <!-- 红包答题结果 -->
    <section class="red-answer-correctBox" v-show="show==4" :class="{'paytype-2': result.paytype == 2}">
        <div class="red-answer-correct">
            <div class="answer-head" v-if="result.isok">
                <h1></h1>
                <p class="answer-money" :style="result.Amout === 0 ? 'opacity:0':''">
                    <span>{{(result.Amout/100).toFixed(2)}}</span>元
                </p>
                <div class="tip" v-if="result.paytype != 2" >
                    <p v-if="result.autoWithdrawal">已自动提现至微信零钱，约1~3个小时内到账</p>
                    <template v-else>
                        <p>已存入微赞个人钱包 <a style="color: #006cff" :href="'/live/m/income?zbid=' + zbvd.zbid + '&tpid=' + zbvd.topicid + '&cashIntoType=1&payType=' + result.paytype">去提现</a></p>
                        <p>或您可在互动区底部-提现至微信</p> 
                    </template>
                </div>
            </div>
            <div class="answer-head" v-else>
                <i class="error"></i>
                <p class="error-text">{{result.Msg}}</p>
            </div>
            <p class="answer-text" v-if="result.paytype != 2">{{Question.Question}}</p>
            <div v-if="result.paytype == 2">
                <div class="private-redbag" >
                    <div class="private-redbag-weilingqu" :class="{exchanged:result.exchangeStatus == '已核销'}"></div>
                    <div class="private-redbag-qrcode" v-if="result.configs.exchangeCode.indexOf('data:image') == 0" >
                        <img :src="result.configs.exchangeCode" alt="">
                    </div>
                    <div class="private-redbag-info">
                        <div class="private-redbag-title">核销码</div>
                        <div class="private-redbag-title">截图保存作为核销凭证</div>
                    </div>
                </div>
                <div class="private-redbag-serice" >
                    <div class="private-redbag-tips">{{result.configs.exchangeMsg}}</div>
                    <img class="private-redbag-serice-qrcode" :src="result.configs.qrcode" alt="">
                    <div class="private-redbag-connect">客服二维码</div>
                </div>
            </div>
            <div v-else>
                <div style="color:#FDD7A7;font-size:14px;text-align:left;">正确答案：</div>
                <div class="answer-item">{{realOption}} {{result.dataObj}}</div>
            </div>
            <p class="answer-foot" @click="lookRedbagDetail(result.id)" v-if="isRecord">领取详情 ></p>
        </div>
        <i class="red-rain-close" @click="show=0"></i>
    </section>

    <!-- pc端红包雨倒计时二维码 -->
    <section class="pc-rain-count-box" v-show="show==5" v-if="isPc">
        <div class="pc-rain-count">
            <h1></h1>
            <p class="count">距离结束仅剩{{rainCount}}秒</p>
            <div class="img-box"></div>
            <p class="tip">扫码立即参与</p>
        </div>
        <i class="red-rain-close" @click="show=0"></i>
    </section>
    <div style="display: none;">
        <div id="redbag_excode"></div>
    </div>
</div>
<script src="https://static1.weizan.cn/zhibo/livecontent/plugin/vant-ui/area.redbag.cn.js"></script>
<script type="text/javascript">
    $(function () {
        $('body').on('blur', '.give-redpacket-content input,textarea,.redPackets-bg input', function () {
            setTimeout(function () {
                window.scrollBy(0, 15);
                window.scrollBy(0, -15);
            }, 200)
        })
        var isMobile = /iphone|ipad|android/i.test(navigator.userAgent);
        /* 红包功能初始化数据 */
        var data = {
            pageTitle: '',
            isloading: false,
            showClause: false,
            isFreeVer:'EntTVChat' == '',
            liveId: '1427079113',
            tplName: 'VRLive',
            modelType:6,
            liveBase: 'https://wx.vzan.com',
            // 是否新标准版
            isNewStandardVersion: zbvd.applyId == 17 && zbvd.customertype == 10,
            isTrainVersion: zbvd.applyId == 19 && zbvd.customertype == 10,
            showTime:false,//显示日期选择器
            dateModelKey:'',//日期选择当前索引
            now:new Date(),//当前时间
            showArea:false,//显示城市选择(新)
            userInfo: {
                roleId: 0,
                userid: '',
                isAdmin: 'False' === 'True',
                roleType: 0,
                isLiveAss: false,
            },
            liveMoney:0, 
            isfreelive:false,
            mindate: '2024-05-14',
            totalMoney: '0.00',
            precapital: '',
            placeholder: '恭喜发财,大吉大利！',
            minMoney: zbvd.redpacketlimitamountmin/100,
            maxMoney: 6000,
            maxWxPay:zbvd.zbredpacketlimitamountwxchat*1,//微信支付最大额度
            maxCashPay:zbvd.zbredpacketlimitamountcash*1,//余额支付最大额度
            maxWxNum:zbvd.zbredpacketlimitcountwxchat*1,//直播间红包微信支付数量限制
            maxCashNum:zbvd.zbredpacketlimitcountcash*1,//直播间红包余额支付数量限制
            redpacket: {
                paytype: 0, // 默认微信支付
            },
            openRain:false,
            originalRedBag: {
                rtype: 1,//1随机,0等分
                liveId: '1427079113',
                topicId: '768346371',
                byUserId: '0',
                total_fee: 0,
                money: '',
                singlemoneystr: '',
                singlemoney: 0,
                note: '',
                redpwd: '',
                redmsgtip: '',
                type: 'normal',
                isTiming: false,
                rptype: 0,
                rptime: '',
                looktime:'',
                citys: '',
                citycode:'',
                focus: -1,
                nums: '',
                shoperAd: '',
                startTime:'',
                endTime:'',
                companyname:'',//企业名称
                wish:'',//祝福语
                cover:'',//封面
                bubblecover:'',//气泡封面
                paytype:0//0 微信支付 1余额支付
            },
            answerList:'',//答题红包列表
            rainList:'',//红包雨列表
            coverStep:0,//显示企业红包封面弹窗步骤 0不显示弹窗 1上传 2裁剪
            coverY:0,//记录拖动封面时的第一个y坐标
            clipY:80,//裁剪位置的y坐标
            coverMove:false,//是否开始拖动封面
            startEvent:isMobile?'touchstart':'mousedown',
            moveEvent:isMobile?'touchmove':'mousemove',
            coverList:'',//企业红包封面列表
            checkPay:false,//选择支付方式
            coverObj:{cover:'https://i2cut.vzan.com/image/liveimg/jpeg/2021-1-19/1103409786ac5da29241429317e411e37e3542.jpeg',bubblecover:'',onSave:false},//设置封面参数
            bubbleTip:{
                show:false,//显示气泡红包提示
                right:0,top:0//气泡示例图位置坐标
            },
            detailType: 'edit',
            showEditForm: false,
            lookRewardRedBagList: [], // 观看奖励红包列表
            pageSize: 6,
            pageIndex: 1,
            lookRewardRedBagItem: {
                id: 0,
                rewardType: 1,
                tpId: zbvd.topicid,
                zbId: zbvd.zbid,
                showTime: '',
                showTimeToSec: 0,
                limitProvinceCode: 0,
                limitCityCode: 0,
                state: 0,
                limitArea: 0,
                endTime: '',
                redPacketItem: {
                    id: 0,
                    title: '',
                    totalMoney: 0,
                    singleMoney: 0,
                    totalRedPacketsNum: 0,
                    showTotalSecond: 0,
                    type: 1, // 红包类型（默认为 1 随机红包, 0 等额红包）
                    config: { // {\"losingtitle\":\"\",\"losingtips\":\"\",\"redpackeblessing\":\"红包祝福语\"}
                        redpackeblessing: '恭喜获得奖励', //祝福语
                        Losingtitle: '已抢光', // 未获得红包标题
                        Losingtips: '再接再厉', // 未获得红包提示
                    }
                },
            },
            redBagList: [
                { type: 'rain', valueAddedId: 3114, url: '/createRain' },
                { type: 'answer', valueAddedId: 3114, url: '/createAnswer' },
            ],
            cover: '',
            redmsgtip: '',
            balance: 0,
            merchantInfo: {},
            exemptPasswordInfo: {},
        };
        if(zbvd.redpacketlimitamountwxchatzbid && zbvd.redpacketlimitamountwxchatzbid.length>0){
            if(zbvd.redpacketlimitamountwxchatzbid.split(',').indexOf(zbvd.zbid.toString())>=0){
                data.maxWxPay = 20000 * 100;//特定直播间微信支持2万支付
            }
        }
        if(zbvd.redpacketlimitcountzbid && zbvd.redpacketlimitcountzbid.length>0){
            if(zbvd.redpacketlimitcountzbid.split(',').indexOf(zbvd.zbid.toString())>=0){
                data.maxNum = 10000;//特定直播间余额支持1万数量
            }
        }
        var data2 = {
            pageTitle:'',
            liveId: '1427079113',
            topicId: '768346371',
            enc_topicid: 'A18B9FDB1A37A560A23AAEB4D3DB1829',
            userId: '0',
            popuptype: '',
            popupstate: '',
            countdownstr: '',
            _timehand: null,
            myredbagmoney: 0,
            isloading: false,
            setInterObj: null,
            colseCallback: null,
            issendredbag: 'False' == 'True',
            showtool:'False' == 'True',
            timer:null,
            isPc:false,
            isRecord:'False'=='True',//是否显示领取记录
            newUser:'' == 'True',//是否企业红包新用户
            newUserRedbagCount:'',//企业红包新用户红包剩余红包数
            redbaginfo: {
                rtype: 1,//1随机,0等分
                rptype:0,
                rptime:'',
                pages: 0,
                pageindex:1,
                redbagnums: 0,
                redbagmoney: 0,
                remark: '',
                drawuserlist: [],
                advimg: '',
                iscommand:false,
                countdowns: 0,
                commandtips: '',
                nickname: '',
                headimgurl: '',
                rid: '',
                command: '',
                remain: 0,
                draws: 0,
                opentime:'',
                resultMoney:'',//领取红包金额
                companyname: '',
                wish: '',
                seconds: 0,
                resultCount: 0,
                redmsgtip: "",
                redpwd: "",
                redtype: 1,
                refund: false,
                isMerchantRedbag: false,
                guid: "",
                haspwd: false,
                companyname: '',
                cover: '',
                code: '',
                have: false,
                rptimes: '',
                msgInfo: '',
                inviteUser: '', // 企业红包列表玩法，主动邀请的用户
                paytype: 0,
                redPacketConfigs: {
                    qrcode: '',
                    exchangeMsg: '',
                    exchangeCode: ''
                }
            },
        }
        /* 初始化 */
        if (typeof newredbag !== 'undefined') {
            newredbag.initRedpacketApp('#redpacketapp', data,
                [
                'https://static1.weizan.cn/zhibo/livecontent/new-2018/css/city-picker.css',
                'https://static1.weizan.cn/zhibo/livecontent/new-2018/js/city-picker.js',
                'https://static1.weizan.cn/zhibo/livecontent/plugin/LArea/LAreaData.js'
                ]
            );
            newredbag.initRedbagContentApp("#newredbagContentApp",data2);
            newredbag.initRainAnswerApp({
                svga:'https://static1.weizan.cn/zhibo/livecontent/new-2018/svga/qq.svga',
                isRecord:'False'=='True',//是否显示领取记录
				rainSvga1:'https://static1.weizan.cn/zhibo/livecontent/new-2018/svga/getrain1.svga',
				rainSvga2:'https://static1.weizan.cn/zhibo/livecontent/new-2018/svga/getrain2.svga'
            });
        }
    });
</script>
        <!--观看奖励-->

<link href="https://static1.weizan.cn/zhibo/livecontent/new-2018/css/lookvideoreward.css?v12=638498302430485833" rel="stylesheet" />
<script src="https://static1.weizan.cn/zhibo/livecontent/plugin/SliderVerify.min.js?ver=638498302430485833"></script>
<script type="text/javascript" src="https://static1.weizan.cn/zhibo/livecontent/new-2018/js/timingredbag.js?ver=638498302430485833201910172" charset="utf-8"></script>
<div id="lookvideorewardapp" hidden>
    <div v-if="showRedBagMask">
        <div class="livevideoreward-fixed-tk" v-if="showLangscapeRedBag == 1">
            <div class="redbag-2021-container redbagContent countdown-popup" style="height: auto;">
                <img class="topText" src="https://static1.weizan.cn/zhibo/livecontent/livecommon/images/new-vertical/guankanText.png" />
                <div class="countdown-popup__main">
                    <div class="countdown-popup__time">
                      <div>活动参与时间：</div>
                      <p>{{ currentRewardItem.sTime }} ~ {{ currentRewardItem.eTime || '-' }}</p>
                    </div>
                    <div class="rules">
                      <div class="cell">
                        <div class="cell__label">领取条件：</div>
                        <div class="cell__value">
                          参与时间内观看满
                          <strong style="color: #f45e26">{{ formatSec(currentRewardItem.time, 'mm分ss秒') }}</strong>
                        </div>
                      </div>
                      <div class="cell">
                        <div class="cell__label">已观看：</div>
                        <div class="cell__value">{{ formatSec(currentRewardItem.time - (cdMin * 60 + (+cdSec)), 'mm分ss秒') }}</div>
                      </div>
                    </div>
                    <div class="countdown-btn">
                      继续观看
                      <strong style="color: #f45e26">{{ cdMin > 0 ? cdMin + '分' : '' }}{{ cdSec }}秒</strong>
                      后可领取
                    </div>
                </div>
                <div class="countdown-popup__footer">
                    温馨提示：
                    <br />
                    活动期间切勿退出或离开当前直播页面，退出离开直播页面可能会导致观看时间不足，无法参与红包的领取
                </div>
                <div class="vz-redbag-close" @click="showRedBagMask=false">
                    <img src="https://static1.weizan.cn/zhibo/livecontent/livecommon/images/new-vertical/close.png" />
                </div>
            </div>
        </div>
        <div class="livevideoreward-fixed-tk"  v-if="showLangscapeRedBag == 3">
            <div class="redbag-2021-container redbagContent" :class="{'redbag-2021-container-coderedbag': redPacketConfigs.paytype == 2}">
                <img  class="fireworks1" src="https://static1.weizan.cn/zhibo/livecontent/livecommon/images/new-vertical/fireworks1.png" />
                <img  class="fireworks2" src="https://static1.weizan.cn/zhibo/livecontent/livecommon/images/new-vertical/fireworks2.png" />
                <img v-if="!watchRewardText.length" class="congraGetText" src="https://static1.weizan.cn/zhibo/livecontent/livecommon/images/new-vertical/congraGetText.png" />
                <div v-else class="congraGetText tipsword">{{watchRewardText}}</div>
                <div class="redbagMoney">
                    <span class="num">{{parseFloat(rewardinfo.money||0).toFixed(2)}}</span>
                    <span class="text">元</span>
                </div>
                <template v-if="redPacketConfigs.paytype != 2">
                    <div class="redbagTip" v-if="redPacketConfigs.autoWithdrawal">已自动提现至微信零钱，约1~3个小时内到账</div>
                    <div class="redbagTip" v-else>已存入微赞个人钱包<a style="color: #006cff" :href="'/live/m/income?zbid=' + zbvd.zbid + '&tpid=' + zbvd.topicid + '&cashIntoType=1&payType=' + redPacketConfigs.paytype">去提现</a></div>
                </template>

                <div class="qrcode-redbag" v-if="redPacketConfigs.paytype == 2">
                    <div class="private-redbag" >
                        <div class="private-redbag-weilingqu"></div>
                        <img class="private-redbag-qrcode" :src="redPacketConfigs.exchangeCode" alt="">
                        <div class="private-redbag-info">
                            <div class="private-redbag-title">核销码</div>
                            <div class="private-redbag-title">截图保存作为核销凭证</div>
                            <!-- <div class="private-redbag-code">{{ location.origin + result.configs.exchangeCode }}</div> -->
                        </div>
                    </div>
                    <div class="private-redbag-serice" >
                        <div class="private-redbag-tips">{{redPacketConfigs.exchangeMsg}}</div>
                        <img class="private-redbag-serice-qrcode" :src="redPacketConfigs.qrcode" alt="">
                        <div class="private-redbag-connect">客服二维码</div>
                    </div>
                </div>
                <img 
                    class="continueBtnImg"
                    src="https://static1.weizan.cn/zhibo/livecontent/livecommon/images/new-vertical/continueBtn.png"
                    @click="showRedBagMask=false"
                />
            </div>
        </div>
        <div class="livevideoreward-fixed-tk" v-if="showLangscapeRedBag == 4">
            <div class="redbag-2021-container redbagContent">
                <div class="customOuttimeText" v-if="losingtitle">{{ losingtitle }}</div>
                <div class="customOuttimeTip" v-if="losingtips">{{ losingtips }}</div>
                <img v-if="!losingtitle && !losingtips" class="defaultText" src="https://static1.weizan.cn/zhibo/livecontent/livecommon/images/new-vertical/outTimeText.png" />
                <img 
                    class="continueBtnImg"
                    style="margin-top:120px"
                    src="https://static1.weizan.cn/zhibo/livecontent/livecommon/images/new-vertical/continueBtn.png"
                    @click="showRedBagMask=false"
                />
            </div>
        </div>
        <div class="livevideoreward-fixed-tk" v-if="showLangscapeRedBag == 5">
            <div class="redbag-2021-container redbagContent">
                <img class="topText" src="https://static1.weizan.cn/zhibo/livecontent/livecommon/images/new-vertical/guankanText.png" />
                <img class="notBegun" src="https://static1.weizan.cn/zhibo/livecontent/livecommon/images/new-vertical/notBegun.png" />
                <div class="vz-redbag-close" @click="showRedBagMask=false">
                    <img src="https://static1.weizan.cn/zhibo/livecontent/livecommon/images/new-vertical/close.png" />
                </div>
            </div>
        </div>
    </div>
    


</div>
<script>
    var data = {
        liveId: '1427079113',
        topicId: '768346371',
        enc_topicid: 'A18B9FDB1A37A560A23AAEB4D3DB1829',
        
    };
    /* 初始化 */
    timingredbag.initLookRedpacketApp('#lookvideorewardapp', data);
</script>

<style>
    [v-cloak]{
        display: none !important;
    }
</style>
<!--抢优惠券-->
<!--核销优惠券推送到直播间-->
<link href="https://static1.weizan.cn/zhibo/livecontent/coupon/css/coupons.css?v=638498302430485833" rel="stylesheet" />
<script src="https://static1.weizan.cn/zhibo/livecontent/content/live/scripts/jquery.qrcode.min.js"></script>
<div class="rel qrcodeCoupon" style="height:100%;" hidden>
    <!-- 扫描微信随时随地看直播 -->
    <div class="abs live_scanning-code scanning-vchat">
        <div class="scanning-code-img"><div class="qrcode"></div></div>
        <p class="p2">微信扫码领取优惠券</p>
    </div>
</div>

<!-- 新弹窗 -->
<div id="global-coupon" v-cloak>
    <!-- 查看详情 -->
    <div class="new_coupon-shadow" v-if="currentDetail && showDetail">
        <section class="new_coupon-box">
            <div class="top-area">
                <h1 class="new_coupon-title">{{currentDetail.couponName}}</h1>
                <p style="color: #353535;font-size: 12px;">
                    优惠金额：
                    <span class="spend">{{currentDetail.couponContent}}</span>
                </p>
                <p class="new_coupon-little-title">有效期</p>
                <p v-if="currentDetail.validDays">领取后{{currentDetail.validDays}}天内有效</p>
                <p v-else>{{currentDetail.beginDate}} 至 {{currentDetail.validDate}}</p>
                <template v-if="currentDetail.type == 4 && currentDetail.lineType != 0">
                    <p class="new_coupon-little-title">使用门槛</p>
                    <p>{{currentDetail.limitAmountContent}}</p>
                </template>
                <p class="new_coupon-little-title">使用说明</p>
                <p style="white-space: pre-wrap;">{{currentDetail.description}}</p>
            </div>
            <div class="new_coupon-close" @click="currentDetail=false">关闭</div>
        </section>
    </div>
    <!-- 推送的优惠券 -->
    <div class="new_coupon-shadow" v-if="currentCoupon && showCoupon">
        <section class="new_coupon-view">
            <i class="new_close-btn" @click="showCoupon=false"></i>
            <div class="new_coupon-card-top">
                <img class="new_coupon-poster" v-if="currentCoupon.ImageUrl" :src="currentCoupon.ImageUrl.indexOf('<a href')>=0?$(currentCoupon.ImageUrl).attr('href'):currentCoupon.ImageUrl">
                <h1 class="top-title one-line">{{currentCoupon.CouponName}}</h1>
                <div class="new_coupon-card">
                    <h1 class="card-title">优惠金额</h1>
                    <div class="spend">
                        <p class="spendtext">
                            <span>￥</span>{{currentCoupon.money}}
                        </p>
                    </div>
                    <p class="card-text">
                        使用时间<br/>
                        {{currentCoupon.BeginDate|short}} 至 {{currentCoupon.validDate|short}}<br/>
                    </p>
                    <p class="card-text" v-if="currentCoupon.limitStr && currentCoupon.LineType != 0">{{currentCoupon.limitStr}}</p>
                </div>
            </div>
            
            <div class="new_coupon-card-bottom">
                <button class="bottombtn" v-if="currentCoupon.canUse" @click="window.location.href='/live/m/myVerifyCouponList'">立即使用</button>
                <button class="bottombtn" v-if="!currentCoupon.canUse && currentCoupon.payfee" @click="getCoupon">支付￥{{(currentCoupon.payfeeMoney).toFixed(2)}}元领取</button>
                <button class="bottombtn" v-if="!currentCoupon.canUse && !currentCoupon.payfee" @click="getCoupon">免费领取</button>
                <p class="bottom-tip">领取结果在个人中心-票券核销查看</p>
            </div>
        </section>
    </div>
    <!-- 手机姓名验证 -->
    <div class="new_coupon-shadow" @click="openForm=false" v-show="openForm" v-if="currentCoupon" style="z-index: 1000;">
        <section class="form-box" @click.stop="">
            <h1 class="form-box-title">为方便优惠券的使用和核销<br/>请填写您的联系方式</h1>
            <input type="text" v-model="form.UserName" maxlength="6" placeholder="请输入姓名">
            <input type="text" v-model="form.UserPhone" maxlength="11" placeholder="请输入联系方式">
            <button class="form-submit" @click="submitInfo">{{currentCoupon.payfeeMoney?'立即支付':'确定'}}</button>                 
        </section>
    </div>
</div>

<script>
    var isGet = false;
    var isloading = false,loadindex  = -1;

    function checkGetCoupon(data,param2,callback) {
        var that = this;
        layer.load(2);
        Utils.ajax('/api/v1/coupon/CheckGetCoupon', { couponId: data.couponId }, 'get', '', { baseType: 'market' }).then(function (res) {
            if (res.isok && res.code == 0) {
                if (parseInt(res.dataObj) > 0) {
                    layer.closeAll('loading');
                    var params = {
                        tradeType: "NATIVE",
                        couponId: data.couponId,
                        couponDetailId: res.dataObj,
                        userName: param2 ? param2.UserName : "",
                        userPhone: param2 ? param2.UserPhone : "",
                        tpId: zbvd.topicid,
                        source: 0,  // H5 = 0,   微赞live小程序 = 1,   商家小程序 = 2
                        thirdUserId: 0,
                        generalizeShopId: 0,
                        buySourceType: ""
                    }
                    var env = 'prod';
                    console.log("env:" + env);
                    if (env == "prod") {
                        params.tradeType = "JSAPI";
                    }

                    //新支付核销优惠券
                    vzanPay($baseUrl.shopBase + '/api/order/CouponPay', params, {
                        isolder: false,
                        cancel: function () {
                        }
                    }).then(function (res) {
                        if (res && res.isok && res.code == 0) {
                            isloading = false;
                            layer.msg('领取成功');
                            globalCoupon.currentCoupon.canUse = true;
                            globalCoupon.currentCoupon.getCount++;
                            globalCoupon.currentCoupon.getcount++;
                            typeof callback == 'function' ? callback(res) : null;
                        }
                        else {
                            isloading = false;
                            if (res.code == 506) {
                                globalCoupon.openForm = true;
                            }
                            else {
                                layer.msg(res.msg);
                                if (result.code == '505') {
                                    globalCoupon.showCoupon = false;
                                }
                            }
                        }
                    })
                        .catch(function (res) {
                            isloading = false;
                            layer.msg(res.msg);
                        })
                } else {
                    if (res.dataObj == '-1') {
                        layer.closeAll('loading');
                        layer.msg('优惠券已领完');
                        isloading = false;
                    } else if (res.dataObj == '0') {
                        setTimeout(function () { checkGetCoupon(data, param2, callback) }, 800);
                    } else {
                        layer.closeAll('loading');
                        isloading = false;
                        layer.msg('参数异常，请重试');
                    }
                }
            }
            else {
                isloading = false;
                layer.closeAll('loading');
                layer.msg(res.msg);
                typeof callback == 'function' ? callback(res) : null;
            }
        });
    }    

    var globalCoupon = new Vue({
        el:'#global-coupon',
        data:{
            currentDetail:'',//查看详情
            showDetail:false,//查看详情弹窗
            currentCoupon:'',//推送优惠券
            showCoupon:false,//推送优惠券弹窗
            openForm:false,//验证信息弹窗
            canUse:false,//推送优惠券已经领取可以使用
            form:{
                UserName:'',
                UserPhone:'',
                tpId:zbvd.topicid
            },
            callback:'',//领取优惠券回调 缓存区

        },
        methods:{
            toShowDetail:function(item){
                var that = this;
                that.currentDetail = item;
                that.currentDetail.description = that.currentDetail.description.replace(/<br\/>/gi, "\n");
                this.$nextTick(function () { that.showDetail = true; }.bind(that))
            },
            toShowCoupon:function(item){
                item.canUse = false;
                this.currentCoupon = item;
                this.$nextTick(function(){this.showCoupon=true;}.bind(this))
            },
            getCoupon:function(callback){
                var that = this;
                var getConditions = that.currentCoupon.getConditions || 0;
                $.ajax({
                    url: '/liveajax/CheckPhoneAuthScene',
                    data: { zbId: zbvd.zbid, scene: '1102' },
                    method: "post",
                    dataType: 'json',
                }).then(function (res) {
                    if (res.isok) {
                        var emzbid = zbvd.zbid;
                        if (res.code == '1002' && getConditions!=3) {
                            empower.init(1, emzbid);//需要手动输入手机号授权
                            return;
                        } else if (res.code == '1003' && getConditions!=3) {
                            var siteName = res.dataObj.siteName || '';
                            var emPhone = res.dataObj.phone || '';
                            empower.init(2, emzbid, emPhone, siteName);//需要按钮允许授权
                            return;
                        }
                    }
                    if (that.currentCoupon.payfeeMoney) {//去支付
                        return checkGetCoupon(that.currentCoupon, that.form, callback);
                    }
                    return that.getCouponNew(callback);
                }).fail(function () {
                    if (that.currentCoupon.payfeeMoney) {//去支付
                        return checkGetCoupon(that.currentCoupon, that.form, callback);
                    }
                    return that.getCouponNew(callback);
                });               
            },
            //领取优惠券最新接口 [ausir-2022/01/24]
            getCouponNew:function(callback){
                var that = this;
                var load = layer.load(2);
                var getConditions = that.currentCoupon.getConditions||0;
                var blackBox = "";
                if(getConditions==3){
                    var time=localStorage.getItem(watchRewardUtils.sessionKey) || 0;
                    blackBox = "观看"+time+"s";
                }
                var para={
                    zbId:zbid,
                    sourceType:1,
                    sourceId:zbvd.topicid,
                    couponId: that.currentCoupon.Id || that.currentCoupon.couponId,
                    userName:that.form.UserName,
                    userPhone:that.form.UserPhone,
                    isFromMenu: (that.currentCoupon.menu == 1),//自定义菜单过来的
                    blackBox: blackBox,
                    getConditions: getConditions
                };
                Utils.ajax('/api/v1/coupon/GetCoupon', para, 'post', '', { baseType: 'market' }).then(function (r) {
                    if (r.isok && r.code == 0) {
                        layer.msg("领取成功");
                        typeof callback == 'function'? callback(r):null;
                        that.currentCoupon.getCount++;
                        that.currentCoupon.canUse = true;
                        that.form={UserName:'',UserPhone:''};
                    }
                    else{
                        layer.msg(r.msg);
                        if(r.code == 506){
                            that.openForm = true;
                        }
                    }
                    layer.close(load);
                });
            },
            submitInfo:function(){
                if(this.form.UserName==''){
                    return layer.msg('请输入姓名');
                }
                if(this.form.UserPhone==''){
                    return layer.msg('请输入联系方式');
                }
                if(!/^[0-9]{11}$/.test(this.form.UserPhone) || this.form.UserPhone.length!=11){
                    return layer.msg('请输入正确的联系方式');
                }
                this.openForm = false;
                if(this.currentCoupon.payfeeMoney>0){
                    checkGetCoupon(this.currentCoupon,JSON.parse(JSON.stringify(this.form)),this.callback);//去支付 并且传入验证消息

                }else{
                    this.getCouponNew(this.callback);
                }
                this.form.UserName='';this.form.UserPhone='';
            }
        },
        filters:{
            short:function(v){
                return v.slice(0,v.length-3);
            }
        }
    })

    function getSocketCouponShow(msg){
        globalCoupon.toShowCoupon(JSON.parse(msg.Msg.content));
    }
</script>
<!--核销优惠券推送到直播间-->        <div id="vue-app">
            <!--二维码弹窗-->
            <div class="qrcode-popupp" v-show="show" style="display:none;" @click.self="showOut" id="attentionDiv">
                <div class="qrcode-popupp-center" v-show="qrcodeData.type != 'login'">
                    <p class="qrc-pc-title d-flex justify-sb">
                        <span id="attentionTitle">{{qrcodeData.title}}</span>
                        <span class="f-12px iconfont iconclose-line" @click="showOut"></span>
                    </p>
                    <div class="qrc-pc-option d-flex" v-show="type === 'phone'">
                        <div @click="changeTpyePhone(true)" class="flex act">微信观看</div>
                    </div>
                    <img draggable="false" :style="{marginBottom: qrcodeData.tips.length? 0: '20px', 'max-width': '100%', 'object-fit': 'contain' }" class="qrc-pc-img" :src="qrcodeData.qrcodeurl" id="attentionImg" />
                    <p v-show="qrcodeData.tips" class="qrc-pc-tips" id="attentionTips">{{qrcodeData.tips}}</p>
                </div>
                <div class="qrcode-popupp-center" style="width: 400px; height: 450px; box-sizing: border-box;" v-show="qrcodeData.type == 'login'">
                    <div class="d-flex tab-box">
                        <div class="flex" @click="handleChangeLogin('1')">
                            <span class="login_tab_item_text i18n" :class="loginType == '1'?'act':''" name="quick.login.name">快捷登录</span>
                        </div>
                        <div class="flex" @click="handleChangeLogin('0')">
                            <span class="login_tab_item_text i18n" :class="loginType == '0'?'act':''" name="mobile.login.name">手机登录</span>
                        </div>
                    </div>
                    <div class="login-content">
                        <div v-show="loginType == '1'">
                            <div id="qrc-pc-img-box">
                                <div id="qrc-pc-out-time" style="display: none;"><i class="iconfont iconrefresh"></i></div>
                                <img draggable="false" :style="{marginBottom: qrcodeData.tips.length? 0: '20px' }" class="qrc-pc-img" :src="qrcodeData.qrcodeurl" />
                            </div>
                            <p v-if="qrcodeData.tips" class="qrc-pc-tips i18n" name="wx.login.tips">{{qrcodeData.tips}}</p>
                            <div class="line-box">
                                <span class="i18n desc" name="third.login.tips">海外用户登录</span>
                            </div>
                            <div class="btn-box" @click="routerTo">
                                <img src="https://static1.weizan.cn/zhibo/livecontent/pc/img/facebook.png" />
                                <span class="i18n" name="facebook.btn.name">Facebook</span>
                            </div>
                        </div>
                        <div class="el-form-box" v-show="loginType == 0">
                        <el-form ref="loginForm" :model="loginForm">
                            <el-form-item key="phone" class="phone-input" prop='phone'>
                                <el-input v-model='loginForm.phone' placeholder='请输入手机号码' maxlength='11' auto-complete="new-password" selectname="please.setYourPhone.place" selectattr="placeholder" class="i18n-el-input">
                                    <template slot="prepend">+86</template>
                                </el-input>
                            </el-form-item>
                            <el-form-item key="code" class="code-input" prop='code'>
                                <el-input v-model="loginForm.code" placeholder="请输入验证码" maxlength='6' auto-complete="new-password" selectname="please.setYourCode.place" selectattr="placeholder" class="i18n-el-input"></el-input>
                                <div class="get-code-btn cursor-pointer" @click.stop="getSlideCode">
                                    <span v-show="!timer" class="i18n" name="phonecode.send.btn">发送验证码</span>
                                    <span v-show="timer">{{times}}s</span>
                                </div>
                            </el-form-item>
                        </el-form>
                        <el-button type="primary" @click="submitLoign" class="i18n" name="login.name">登录</el-button>
                        <div class="bottom-box">
                            <div class="tips i18n" name="first.login.register.tips">首次登录请使用微信快捷登录</div>
                            <div class="desc" style="display: flex">
                                <el-checkbox v-model="loginForm.agreeBook"></el-checkbox>
                                <span class="text" style="margin-left: 10px"><span class="i18n" name="read.and.agree">阅读并同意</span>
                                <a class="i18n" name="User.Agreement" href="https://live.vzan.com/assets/UserAgreement.html" target="_blank">用户协议</a>
                                <span class="i18n" name="douhao.name">、</span>
                                <a class="i18n" name="privacy.policy" href="https://live.vzan.com/assets/html/vzanprivacypolicy.html" target="_blank">隐私政策</a>
                                </span>
                            </div>

                        </div>
                        <div id="imgscode"></div>
                    </div>
                    </div>
                </div>
            </div>
        </div>
        <div id="vote-to-code" style="display: none;"></div>

        <!--弹窗-->
<div id="tips-modal" v-if="modalData.isopen" v-cloak>
    <div v-if="modalData.types === 0" class="wrap">
        <div class="title">
            {{modalData.title}}
        </div>
        <div class="content-wrap">{{modalData.content}}</div>
        <div class="btn-wrap">
            <div @click="closeModal()" class="cus-btn close-btn">关闭</div>
            <div @click="confirm()" class="cus-btn confirm-btn">{{modalData.btntxt}}</div>
        </div>
    </div>
    <div v-if="modalData.types === 1" class="img-modal-wrap">
        <div class="img-wrap">
            <div style="height: 100%">
                <img class="img" :src="modalData.content" />
            </div>
        </div>
        <div class="btn-wrap">
            <div @click="closeModal()" class="cus-btn close-btn">关闭</div>
        </div>
    </div>
</div>

<script>
    var tipsModal = new Vue({
        el: '#tips-modal',
        data: function () {
            return {
                modalData: {}
            }
        },
        methods: {
            closeModal() {
                if (this.modalData.types === 1 || this.modalData.entrytype == 1) {
                    this.modalData.isopen = false;
                    $.cookie('liveAdverts_768346371', String(new Date(this.modalData.addtime.replace(/-/g, '/')).getTime()));
                } else {
                    if (history.length > 2) {
                        window.history.go(-1);
                    } else {
                        location.href = '/live/liveIntroduce-768346371?v=' + new Date().getTime()
                    }
                }
            },
            confirm() {
                this.modalData.isopen = false;
                $.cookie('liveAdverts_768346371', String(new Date(this.modalData.addtime.replace(/-/g, '/')).getTime()));
            },
            getData() {
                var _this = this
                Utils.ajax('/liveplugin/topic/getAdverts?tpid=768346371&type=0', {}, 'POST', '', { baseType: 'liveInterface' })
                    .then(function(res) {
                        if (res.code == 0) {
                            if($.cookie('liveAdverts_768346371') !== String(new Date(res.data.addtime.replace(/-/g, '/')).getTime())) {
                                if (res.data && res.data.types != 2) {
                                    _this.modalData = res.data;
                                }
                            }
                        }
                    });
            }
        },
        mounted() {
            var _this = this;
            $(window).load(function() {
                _this.getData();
            });
        }
    })
</script>
        <!--百度统计-->
        <script>
    var _hmt = _hmt || [];
    (function () {
        var hm = document.createElement("script");
        hm.src = "https://hm.baidu.com/hm.js?5c88f64ce16c5100a4a8509273257ce4";
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(hm, s);
    })();
</script>
<script charset="UTF-8" src="//static1.weizan.cn/zhibo/js/sa-sdk-javascript@1.18.15/sensorsdata.min.js"></script>
    <script charset="UTF-8" src="//static1.weizan.cn/zhibo/userlivecontent/vzan/static/live-pc.js"></script>

    </div>
</body>
</html>

<!-- 峰会连麦入口 -->
<script src="https://static1.weizan.cn/zhibo/livecontent/plugin/require.js" defer async data-main="https://static1.weizan.cn/zhibo/livecontent/livecommon/app/main_pc-3d9ed4907a.js?v=1.4" type="text/javascript" charset="utf-8"></script>
<div id="geneQRcode" style="display: none;"><canvas width="128" height="128"></canvas></div>
<script type="text/javascript">
    var langEnum = {
        '0': '中文',
        '1': 'English',
        '2': 'Deutsch',
        '3': '日本語',
        '4': '한국어.',
        '5': 'Español',
        '6': 'русский язык',
        '7': 'Français'
    }

    var statusMap = {
        '-1': 'notbegin',
        '1': 'beginning',
        '0': 'playback',
        '2': 'notsignal'
    }

    // 是否开启全量弹幕
    var isOpenFullBarrage = '0' == '1';
    var topDistance = '0' == 0 ? false : true;
    var openPictureInPicture = false;  // 是否开启画中画

    // 复制功能
    var clipboard = new Clipboard('.btn_copy', {
        text: function () {
            var url = 'https://wx.vzan.com/live/tvchat-768346371?ver=638512900112373342&amp;sharetstamp=1715664411237'.replace(/&amp;/g, '&');
            return url;
        }
    });
    clipboard.on('success', function(e) {
        layer.msg('复制成功')
    })

    var pdLeft = document.getElementsByClassName('pd-viewcontent-left')[0].getBoundingClientRect().right;
    $('.pd-right-fixed-1').css({
        'left' : pdLeft + 16
    })

    var distance = topDistance ? 152 : 36;
    var mikeVideoHeight = $('#mike-video-app').outerHeight() || 0;//连麦视频区域高度
    $('.direct-three-right').css('height', document.body.offsetHeight - distance - mikeVideoHeight)
    $('.direct-right-area').css('height', document.body.offsetHeight - distance)
    window.onresize = function() {
        mikeVideoHeight = $('#mike-video-app').outerHeight() || 0;
        $('.direct-three-right').css('height', document.body.offsetHeight -distance - mikeVideoHeight)
        $('.direct-right-area').css('height', document.body.offsetHeight - distance)
    }

    if(topDistance) {
         // 拉伸效果
        var _height = $('.direct-three-right').height();
        window.addEventListener("scroll", function() {
            if($(window).scrollTop() < 120) {
                var __height = _height + $(window).scrollTop();
                $('.direct-three-right').css('height', __height);
            }
        });
    }

    // 互动区enter发送
    window.addEventListener('keydown', function (event) {
        var isSendInput  = $(document.activeElement).attr('id') === "input-txtbox";
        if (event.keyCode === 13 && isSendInput) {
            var _inputval = $("#input-txtbox").val();
            if (_inputval) {
                $('#btn-send').click();
            }
        }
    });

    window.addEventListener("scroll", function(e) {
        // 开启和关闭画中画的逻辑
        if (typeof livevideoplayer !== "undefined" && livevideoplayer && livevideoplayer.player) {
            var videoEle = $('#videoPlayer');

            if($(window).scrollTop() > 620) {
                if(videoEle && !openPictureInPicture) {
                    videoEle.addClass('fixed-video');
                    openPictureInPicture = true;
                }
            }else {
                if(videoEle && openPictureInPicture) {
                    videoEle.removeClass('fixed-video');
                    openPictureInPicture = false;
                }
            }
        }
    })

    var title = $(".live_title_bar").attr("attr-title");
    var descript = $(".live_title_bar").attr("attr-descript");
    var imgurl = $(".live_title_bar").attr("attr-pic");
    var shareurl = $(".live_title_bar").attr("attr-url");
    var states = $(".live_title_bar").attr("attr-state");
    if (location.hostname.toLowerCase() != "vzan.com") {
        var urlReg = /[a-zA-Z0-9][-a-zA-Z0-9]{0,62}(\.[a-zA-Z0-9][-a-zA-Z0-9]{0,62})+\.?/;
        try {
            var c_host = urlReg.exec(shareurl)[0];
            if (c_host.toLowerCase() != location.hostname.toLowerCase()) {
                shareurl = shareurl.replace(c_host, location.hostname);
            }
        } catch (ex) { }
    }
    try {
        if (shareurl.toLowerCase().indexOf('tvchat') > -1 || shareurl.toLowerCase().indexOf('liveing') > -1 || shareurl.toLowerCase().indexOf('promotionjump') > -1) {
            shareurl += (shareurl.indexOf('?') > -1 ? '&' : '?') + 'sharetstamp=' + Date.now();
        }
    } catch (ex) { console.log(ex); }
    window._bd_share_config = {
        "common": {
            bdText: title,
            bdDesc: descript,
            bdUrl: shareurl,
            bdPic: imgurl,
            "bdSnsKey": {},
            "bdMini": "2",
            "bdMiniList": false,
            "bdPic": "",
            "bdStyle": "1",
            "bdSize": "32"
        },
        "share": {}
    };
    with (document) 0[(getElementsByTagName('head')[0] || body).appendChild(createElement('script')).src = 'https://static1.weizan.cn/zhibo/livecontent/plugin/PCShare/static/api/js/share.js?v=898605938856262.js?cdnversion1=' + ~(-new Date() / 36e5)];

    $(function () {
        // 监听浏览器大小 更新视频画面
        window.addEventListener('resize',function(){
            $('#videoPlayer').find('video').height($('#videoPlayer').height());
        })
        var kaypair_livestatus = {
            notbegin: '未开始',
            beginning: '直播中',
            notsignal: '主播暂时离开，稍后再来！',
            endlive: '直播已结束，稍后看回放！',
            playback: '回放中'
        };

        var danmukuCookie = $.cookie('closelookdm_' + zbvd.topicid);

        if (zbvd.isOpenDm && zbvd.tplname!="HomeLive") {
            // $("#dmswitch").show().find('.dmbox').addClass('open-dm');
            $(".pc-dm").show()
            if (zbvd.IsScreen == '1') {
                // if ($.cookie('closelookdm_' + zbvd.topicid) == '0' || $.cookie('closelookdm_' + zbvd.topicid) == null) {
                    // $('#input-txtbox').attr("placeholder", "发个弹幕和主播互动吧")
                    $('#input-txtbox').attr("placeholder", "发个弹幕和主播互动吧").attr('placeholder', $.i18n.prop('barrage.place.name'));
                // }
            }
        } else {
            $(".pc-dm").hide();
            // $('#input-txtbox').attr(selectAttr, $.i18n.prop('publish.comment.name'));
            // 快来发表你的评论吧
            $('#input-txtbox').attr("placeholder", "快来发表你的评论吧").attr("placeholder", $.i18n.prop('comment.place.name'))
        }
        // 判断cookie里的 closelookdm_ 是不是为 1，为1则关闭弹幕
        console.log('cookie: ' + danmukuCookie);
        if (danmukuCookie == '1' || zbvd.tplname=="HomeLive") {
            zbvd.lookdm = false;
            $(".pc-dm").find('.dmbox').removeClass('open-dm').addClass('close-dm')
            //$("#dmswitch").show().find('.dmbox').children('i').addClass('icondanmu-guan');
            $(".pc-dm").find('.dmbox .open-icon').hide();
            $(".pc-dm").find('.dmbox .close-icon').show();
        } else {
            zbvd.lookdm = true;
            $(".pc-dm").find('.dmbox').removeClass('close-dm').addClass('open-dm')
            //$("#dmswitch").show().find('.dmbox').children('i').addClass('icondanmu-kai');
            $(".pc-dm").find('.dmbox .open-icon').show();
            $(".pc-dm").find('.dmbox .close-icon').hide();
        }

        // 如果是未开始且已经过了开始时间，则未开始倒计时那里不显示弹幕图标
        if ($('#div_live_status').data('starttime')) {
            var _startTime = new Date($('#div_live_status').data('starttime')).getTime();
            var _nowTime = new Date().getTime();
            if (_nowTime > _startTime) {
                $(".countdown-dm").css('display', 'none');
            }
        }
        var topicH5Url = window.location.origin + '/live/tvchat-' + zbvd.topicid + '?v=' + Date.now();

        $('#liveqr').qrcode({ width: 128, height: 128, correctLevel: 0, text: topicH5Url });

        var qrcode = $('#qr-canvas_tpl').qrcode({ width: 128, height: 128, correctLevel: 0, text: topicH5Url }).hide();
        var canvas = qrcode.find('canvas').get(0);
        $('#answer-qr_img').attr('src', canvas.toDataURL('image/jpg'))

        var urls = topicH5Url + "&skId=" + zbvd.skId;
        $('#WeixinSanQRCode').qrcode({ width: 218, height: 218, correctLevel: 0, text: urls });

        $('.direct-three-left-bottom-ma').hover(function () {
            $('.direct-three-erweimasmall').show();
        });
        $('.direct-three-left-bottom-ma').mouseleave(function () {
            $('.direct-three-erweimasmall').hide();
        });
        $('.direct-one-personal').hover(function () {
            $('.direct-one-list').stop().slideDown();
        });
        $('.direct-one-personal').mouseleave(function () {
            $('.direct-one-list').stop().slideUp();
        });
        $('.direct-three-left-follow-end > img').click(function () {
            $('#FocusQRCode').hide();
            $('#LoginQRCode').hide();
        });
        $('.marquee').animate({ left: "-500px" }, 10000);
        $('.img2').eq(0).hover(function () {
            $(this).attr('src', 'https://static1.weizan.cn/zhibo/livecontent/livecommon/images_pc/direct-three-04.png');
        }).mouseleave(function () {
            $(this).attr('src', 'https://static1.weizan.cn/zhibo/livecontent/livecommon/images_pc/direct-three-01.png');
        });
        $('.img2').eq(1).hover(function () {
            $(this).attr('src', 'https://static1.weizan.cn/zhibo/livecontent/livecommon/images_pc/direct-three-05.png');
        }).mouseleave(function () {
            $(this).attr('src', 'https://static1.weizan.cn/zhibo/livecontent/livecommon/images_pc/direct-three-02.png');
        });
        $('.img2').eq(2).hover(function () {
            $(this).attr('src', 'https://static1.weizan.cn/zhibo/livecontent/livecommon/images_pc/direct-three-06.png');
        }).mouseleave(function () {
            $(this).attr('src', 'https://static1.weizan.cn/zhibo/livecontent/livecommon/images_pc/direct-three-03.png');
        });
        $('.direct-two-co2').click(function () {
            $('#FocusQRCode').show();
            $('#LoginQRCode').hide();
            $(".layui-layer .layui-layer-shade").hide();
        });

        $('#tab_des .direct-four-cooperation').eq(0).click(function () {
            console.log($(this).children('div'));
            $(this).children('div').addClass('active')
            $(this).siblings('.direct-four-cooperation').children('div').removeClass('active');
            // $(this).addClass('active').siblings('.direct-four-cooperation').removeClass('active');
            $('#tab_des .direct-four-words').eq(0).show().siblings('.direct-four-words').hide();
        });
        $('#tab_des .direct-four-cooperation').eq(1).click(function () {
            $(this).children('div').addClass('active')
            $(this).siblings('.direct-four-cooperation').children('div').removeClass('active');
            // console.log($(this));
            // $(this).addClass('active').siblings('.direct-four-cooperation').removeClass('active');
            $('#tab_des .direct-four-words').eq(1).show().siblings('.direct-four-words').hide();
        });
        $('#tab_des .direct-four-cooperation').eq(2).click(function () {
            $(this).children('div').addClass('active')
            $(this).siblings('.direct-four-cooperation').children('div').removeClass('active');
            // console.log($(this));
            // $(this).addClass('active').siblings('.direct-four-cooperation').removeClass('active');
            $('#tab_des .direct-four-words').eq(2).show().siblings('.direct-four-words').hide();
        });

        $(document).on("click", "#logout", function () {
            var desc = $.i18n.prop('logout.desc.name')?$.i18n.prop('logout.desc.name'): "确认要退出登录吗？退出之后不能再参与直播互动！"
            var tips = $.i18n.prop('logout.tips.name')?$.i18n.prop('logout.tips.name'): "提示"
            var submit = $.i18n.prop('logout.submit.name')?$.i18n.prop('logout.submit.name'): "确定"
            var cancel = $.i18n.prop('logout.cancel.name')?$.i18n.prop('logout.cancel.name'): "取消"
            layer.confirm(desc, { icon: 3, anim: 0, title: tips, btn: [submit, cancel] }, function (index) {
                var timeout = new Date(Date.now() - (60 * 1000)).toGMTString();
                var subhost = '',subhostArr = location.host.split('.');
                subhostArr.shift()
                subhost = '.' + subhostArr.join('.');

                document.cookie = ""+ zbvd.usercookie + "=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;";
                $.cookie(zbvd.usercookie, null, { domain: "." + location.hostname, path: '/', expire: timeout });
                $.cookie(zbvd.usercookie, null, { domain: zbvd.cookiedomain, path: '/', expire: timeout });
                $.cookie(zbvd.usercookie, null, { domain: subhost, path: '/', expire: timeout });

                document.cookie = "wk_user1427079113_6=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;";
                // 删除本地 token
                localStorage.removeItem('Authorization');
                $.cookie('wk_user1427079113_6', null, { domain: "." + location.hostname, path: '/', expire: timeout });
                $.cookie('wk_user1427079113_6', null, { domain: zbvd.cookiedomain, path: '/', expire: timeout });
                if (false) {
                    setTimeout(function () { location.href = '/live/livedetail-1427079113'; }, 1000);
                }
                else {
                    setTimeout(function () { window.location.reload(true); }, 1000);
                }
            });
        });

        // 判断页面是否启用flash
        function isUseFlash() {
            if (!$('#liveVideo').length || !$('object').length) {
                if ($('#liveVideo').length && $('#liveVideo').attr('src').indexOf('.mp4')) {
                    return false;
                }
                var useFlash = false;
                try {
                    userFlash = Boolean(new ActiveXObject('ShockwaveFlash.ShockwaveFlash'));
                } catch (ex) {
                    useFlash = ('undefined' !== typeof window.navigator.mimeTypes['application/x-shockwave-flash']);
                }
                if (!useFlash) {
                    var $useFlashTips = $('<div class="use-flash">flash插件未开启,点击<a href="http://get.adobe.com/flashplayer">此处</a>启用flash插件观看视频</div>');
                    // 隐藏视频加载中语句和图标
                    $('#playerloading, #aodianplayer_uid_base1 a').hide();
                    $('#videoPlayer').append($useFlashTips);
                }
            }
        }

        function saveLiveFocus(_cancleFlag, _focustype, callback_success) {
            setTimeout(function () {
                $.post('/liveajax/savefocus', { cancleFlag: _cancleFlag, liveid: zbvd.zbid, "types": "focus", focustype: _focustype, shareuid: zbvd.shareuid }, function (data) {
                    if (callback_success && typeof (eval(callback_success)) == "function") {
                        callback_success();
                    }
                });
            }, 3500);
        };
        saveLiveFocus(1, "");

        $('#qrc-pc-img-box #qrc-pc-out-time').click(function() {
            window.location.reload(true)
        })
    });

    // 等待6s在请求函数
    setTimeout(pcGetOnlineNumber, 6000);

    // 获取在线人数
    function pcGetOnlineNumber () {
        Utils.ajax('/api/topic/tp_views', { tpid: zbvd.topicid }, 'GET', '', { baseType: 'livePlayApi' }).then(function(data){
        // $.post("/liveajax/GetOnlineNumber", { zbid: zbvd.zbid, tpid: zbvd.topicid }, function (data) {
            if (data && data.isok) {
                if (zbvd && zbvd.tongjifangshi) {
                    switch (zbvd.tongjifangshi) {
                        case "pv":
                            $(".online_number").text(pcUtilsFormatNum(data.dataObj) + "人气");
                            break;
                        case "uv":
                            $(".online_number").text(pcUtilsFormatNum(data.dataObj) + "人气");
                            break;
                    }
                }
            }
        });
        setTimeout(pcGetOnlineNumber, 60 * 1000);
    };

    function pcUtilsFormatNum(num) {
        if (Object.prototype.toString.call(num) != "[object Number]") {
            num = parseInt(num);
        }
        if (num > 10000) {
            return parseFloat(num / 10000).toFixed(2) + "万";
        }else {
            return num.toString();
        }
    }

    var timerCheckLogin = 0;
    function PCUserLogin() {
        if (!zbvd.userid) {
            $.post("/live/login-" + zbvd.zbid, { skId: zbvd.skId, backurl: '0F7BFFA9474D371F39E70DAD7EB5EB23F2C9F26430169546F1B0327A879E8A476EC81D9CADB2DD007935136160D1E30513055652D15ACD538189A4E647D151BBC582C7C172AD3EAE6EDB5D5DB3113A3F58DA3B3ED481E3AAC3DC2E2055FD22E6957925481D1C94818F9DDC84EB45BB3132DDDE9370F47BF0AA6CF895F6C9BA07AB652CD608D2E6399A76ADA9693EF3D7' }, function () { });
            timerCheckLogin = setInterval(function getlogininfo() {
                $.post("/live/getlogininfo", { skId: zbvd.skId }, function (data) {
                    if (data && data.isok) {
                        $.cookie(zbvd.usercookie, data.Msg, { path: '/', domain: "." + location.host });
                        setTimeout(function () { window.location.reload(true); }, 1500);
                    }
                    else if (data && !data.isok) {
                        if (data.msg.indexOf("二维码已过期") > -1) {
                            $('#qrc-pc-img-box #qrc-pc-out-time').css('display', 'flex')
                            clearInterval(timerCheckLogin);
                            timerCheckLogin = null
                        }
                    }
                });
            }, 2000);
        } else {
            clearInterval(timerCheckLogin);
            timerCheckLogin = null;
        }
    }

    //关注-取消关注直播间
    //var focusTimer = 0;
    //var isFocus = false;
    //$('.set-following').text((isFocus ? '已' : '+') + '关注');
    // $('.pd-like-text').text((isFocus ? '已' : '') + '关注');
    // $('.pd-like').click(function () {
    //     var that = this;
    //     clearTimeout(focusTimer);
    //     focusTimer = setTimeout(function () {
    //         var _cancleFlag = isFocus ? 0 : 1;
    //         $.post("/liveajax/savefocus", { cancleFlag: _cancleFlag, liveid: 1427079113, "types": "focus", focustype: 'click' }, function (data) {
    //             if (data && data.isok) {
    //                 isFocus = Boolean(_cancleFlag);
    //                 $('.set-following').text((isFocus ? '已' : '+') + '关注');
    //                 $('.pd-like-text').text((isFocus ? '已' : '') + '关注');
    //                 var basNum = Number($('.live-follow').find('span').text());
    //                 if (basNum && basNum >= 0) {
    //                     $('.live-follow').find('span').text(basNum + (isFocus ? 1 : -1));
    //                 }
    //             } else {
    //                 PcLiveApp.showOut('login');
    //             }
    //             layer.msg(data.Msg);
    //         });
    //     }, 500);
    // })

    // 获取推荐列表
    var repage = 1;
    var rehasmore = true
    function formatTime() {
        "/Date(1561518888000)/".replace('/Date(', '').replace(')/', '')
    }
    var isfetchRelist = false;
    function getRecommentList() {
        if (isfetchRelist) {
            console.log('adfasdfasd')
            return
        };
        isfetchRelist = true;
        $.get('/live/TopicsRec?page=' + repage + '&limit=10&zbId=1427079113&tpId=768346371', function (res) {
            isfetchRelist = false;
            if (res.data && res.data.length) {
                if (repage === 1) {
                    $('.category-list').find('.item-content').html('');
                    $('#tab_des').find('.direct-four-cooperation.recm-topic').show();
                }
                repage += 1;
                var sstin = ''
                for (var i = 0; i < res.data.length; i++) {
                    var rei = res.data[i];
                    var starttime = LiveUtil.timestampFormat(rei.starttime.replace('/Date(', '').replace(')/', ''));
                    var itemStr = '<dl><dt><a href="/live/tvchat-' + rei.Id + '" target="_self"><div class="stateLive state-' + (rei.status == -1 ? 'preview' : rei.status == 0 ? 'playback' : 'living') + '"></div><img src="' + rei.cover + '" class="lazy" style="display: block;" title="(title)" /><span class="overlay" title="' + rei.title + '"></span></a></dt><dd class="desc" style="margin-top:12px;line-height:13px;"><a href="/live/tvchat-' + rei.Id + '" target="_blank" title="' + rei.title + '">' + rei.title + '</a></dd><dd class="desc d-flex justify-sb" style="margin-top:8px;line-height:12px;"><p class="viewnum view">' + starttime + '</p><p class="viewnum view"><i class="iconfont iconguankanrenshu"></i>' + LiveUtil.numberConvert(rei.viewcts) + '</p></dd></dl>';
                    sstin += itemStr;
                }
                $('.category-list').find('.item-content').append(sstin);
            } else {
                if (repage == 1) {
                    $('#tab_des').find('.direct-four-cooperation.recm-topic').hide();
                    $('#tab_des').find('.direct-four-words.recm-topic-tt').hide();
                    if ("True" == "True") {
                        $('.direct-four-cooperation.topic-interduce').children('div').addClass('active')
                        // $('#tab_des').find('.direct-four-cooperation.topic-interduce').addClass('active');
                        $('#tab_des').find('.direct-four-words.topic-interduce-tt').show();
                    } else if ("False" == "True") {
                        $('.direct-four-cooperation.live-com').children('div').addClass('active')
                        // $('#tab_des').find('.direct-four-cooperation.live-com').addClass('active');
                        $('#tab_des').find('.direct-four-words.live-com-tt').show();
                    }
                }
                rehasmore = false;
            }
        })
    }

    // 获取营销插件的开始时间
    var MarketingTimer = null;
    var MarketingList = [];
    function GetActivtvio() {
        var _this = this;
        $.get('/live/activtvio?tid=768346371', function (res) {
            if (res.isok && res.dataObj) {
                // answer_time 竞猜
                // auc_time 竞拍
                // lot_timea 在线抽奖
                // lot_timeb 场次抽奖
                for (var key in res.dataObj) {
                    if (res.dataObj[key]) {
                        MarketingList.push({ time: res.dataObj[key], name: key });
                    }
                }
                var _isOpenVote = 'False'; // 为True时开启在线投票
                var _length = $('.vertical-apply-icon').length; // 长度大于0时有报名表

                if(MarketingList.length === 0 && _isOpenVote != 'True' && _length === 0) {
                    $('.im-direct-three-right').css('padding-bottom', '60px')
                    $('.pd-icon').css('display', 'none');
                }else {
                    $('.im-direct-three-right').css('padding-bottom', '109px')
                    $('.pd-icon').css('display', 'block');
                }

                MarketingTimer = setInterval(function () {
                    if (MarketingList.length) {
                        for (var i = 0; i < MarketingList.length; i++) {
                            var item = MarketingList[i];
                            if (new Date() > new Date(item.time)) {
                                console.log('item.name')
                                console.log(item.name)
                                $('.' + item.name).show();
                                MarketingList.splice(i, 1);
                            }
                        }
                    } else {
                        clearInterval(MarketingTimer);
                        MarketingTimer = null;
                    }
                }, 1000)
            }
        })
    }

    setTimeout(function () {
        console.log('set')
        getRecommentList();
        GetActivtvio();
    }, 2000);

    var answerLayout = null;
    function ShowQrCode(from) {
        if (from = 'answer') {
            answerLayout = layer.open({
                type: 1,
                title: false,
                closeBtn: 0,
                shadeClose: true,
                content: $('#answer-qr_tpl').html(),
            });
        }
    }

    function closeAnswerQrCode() {
        if (answerLayout !== null) {
            layer.close(answerLayout);
        }
    }

    // 培训版 话题签到
    $('#sgin_in_traning').click(function () {
        if (zbvd.roleid <= 0) {
            if (zbvd.loginuser) {
                var type = $(this).data('type');
                if (type === 'list' || window.signTrangin.IsuserSigin) {
                    window.signTrangin.getUserSign();
                    $('#topic-sign-in-popu').show();
                } else if (window.signTrangin.endtime) {
                    $('#topic-sign-in-popu').show();
                } else {
                    layer.msg('没有进行中的签到');
                }
            } else {
                window.PcLiveApp.showOut('login');
                layer.msg('尚未登录，请登录再操作');
            }
        }
    })
    $('#sgin_in_traning_new').click(function () {
        if (zbvd.roleid <= 0) {
            if (zbvd.loginuser) {
                var type = $(this).data('type');
                if (type === 'list') {
                    window.signTrangin.getUserSignNew();
                    window.signTrangin.userState = 'list';
                    $('#topic-sign-in-popu').show();
                } else if (window.signTrangin.endtime) {
                    $('#topic-sign-in-popu').show();
                } else {
                    layer.msg('没有进行中的签到');
                }
            } else {
                window.PcLiveApp.showOut('login');
                layer.msg('尚未登录，请登录再操作');
            }
        }
    })

    // 切换评论\榜单
    $(document).ready(function(){
        $('#direct-three-right-comment-id .pd_tab_item').on('click', function () {
            var pdTabItem = $(this);
            var pdTabItemText = pdTabItem.children('span');
            var pdSlblingsTabItemText = pdTabItem.siblings('.pd_tab_item').children('span');
            pdTabItemText.addClass('act')
            pdSlblingsTabItemText.removeClass('act')
            var type = $(this).data('type');
            $('.' + type + '-direct-three-right').show().siblings('.dtr-tab').hide();
            // 第一次打开榜单时，加载榜单数据
            if (type === 'toplist' && !window.TopList.listDay.length) {
                if (!window.TopList.IsScreen) {
                    window.TopList.getShareListShuping();
                } else if (window.TopList.isbandan) {
                    window.TopList.hengping();
                }
            }
        })
    })
    // 切换 评论 、 榜单
    // $('.direct-three-right-comment').on('click', 'span', function () {
    //     // return;
    //     $(this).addClass('act').siblings('span').removeClass('act');
    //     var type = $(this).data('type');
    //     $('.' + type + '-direct-three-right').show().siblings('.dtr-tab').hide();

    //     // 第一次打开榜单时，加载榜单数据
    //     if (type === 'toplist' && !window.TopList.listDay.length) {
    //         if (!window.TopList.IsScreen) {
    //             window.TopList.shuping();
    //         } else if (window.TopList.isbandan) {
    //             window.TopList.hengping();
    //         }
    //     }
    // })
    // 初始 video -> height
    function resHeight() {
        // video 16:9
        var width = $('.direct-three-left-video').eq(0).width();
        var videoheight = Math.min(1300, width) * 0.5625;
        $('.direct-three-left-video').height(videoheight);
        // $('#viewcontent').height(videoheight + 50);
        $('#viewcontent').css('min-height', videoheight + 50)

        if (false === false && false === false && false === false) {
            $('.direct-security').css({ width: '1300px' });
        }
    }
    window.addEventListener('resize', resHeight);
    resHeight();
    setTimeout(function () {
        resHeight()
    }, 1000)
    // 榜单
    window.TopList = new Vue({
        el: '#top-list',
        data: function () {
            return {
                listType: 'Day',
                listDay: [],
                listTotal: [],
                pageDay: 1,
                pageTotal: 1,
                hasMoreDay: true,
                hasMoreTotal: true,
                IsScreen: zbvd.IsScreen,
                limit: 10,
                IsOpenShare: true,
                IsOpenReward: true,
                isbandan: false
            };
        },
        watch: {
            listType: function () {
                if (this.IsScreen) {
                    this.hengping();
                } else {
                    this.getShareListShuping('ch');
                }
            }
        },
        methods: {
            shuping: function (fg) {
                if (!this['hasMore' + this.listType] || (fg == 'ch' && this['page'+this.listType] > 1)) {
                    return;
                };
                var that = this;
                var loadingIndex = layer.load(1);
                $.ajax({
                    url: '/live/GetSharelist',
                    type: "POST",
                    data: {
                        tid: zbvd.topicid,
                        type: this.listType == 'Day' ? 1 : 2,
                        page: this['page'+that.listType],
                        limlt: this.limit,
                        uid: zbvd.userid,
                    },
                    success: function (res) {
                        layer.close(loadingIndex);
                        if (res.dataObj && res.dataObj.length) {
                            that['list' + that.listType] = that['list' + that.listType].concat(res.dataObj);
                            that['page'+that.listType] += 1;
                        } else {
                            that['hasMore' + that.listType] = false;
                        }
                        that.$nextTick(function() {
                            globalHanleI18n()
                        })
                    },
                    error: function(error) {
                        layer.close(loadingIndex)
                        console.log(error)
                    }
                })
            },
            hengping: function () {
                var that = this;
                var loadingIndex = layer.load(1);
                $.ajax({
                    type: "POST",
                    url: "/liveajax/GetTopicMenContent",
                    data: {
                        tpid: zbvd.topicid,
                        istate: 2
                    },
                    dataType: "json",
                    success: function (res) {
                        if (res.isok) {
                            var list = res.dataObj;
                            if (list.yaomodel && list.yaomodel.IsOpen === 1) {
                                that.getShareListHengping();
                            }
                            //that.listDay = list.yaomodel.fenxiangbang
                            that.IsOpenShare = list.yaomodel.IsOpen;

                            that.listTotal = list.shangmodel.dashangBang.map(function (el) {
                                el.HeadImgUrl = el.headimgurl;
                                el.NickName = el.nickname;
                                return el;
                            });;
                            that.IsOpenReward = list.shangmodel.IsOpen;

                            if (!that.IsOpenReward && !that.IsOpenShare) {
                                $('span[data-type="toplist"]').hide();
                            }
                            that.$nextTick(function() {
                                globalHanleI18n()
                            })
                        }
                        layer.close(loadingIndex);
                    },
                    error: function () {
                        layer.close(loadingIndex);
                        layer.msg('获取数据失败了！')
                    }
                });
            },
            getShareListHengping: function () {
                console.log('listType:', this.listType)
                var that = this;
                if (!that.hasMoreDay) { return }
                var data = {
                    zbid: zbvd.zbid,
                    topicId: zbvd.topicid || 0,
                    page: this.pageDay,
                    limit: 20,
                    isday: false,
                    isShareTimes: true
                };
                Utils.ajax("/datalive/v1/h5/share/get_sharelist_cache", data, "POST", "", { baseType: "gwapi" }).then(function (res) {
                    if (res.isok && res.dataObj && res.dataObj.rankItemList) {
                        that.$nextTick(function () {
                            that.listDay = that.listDay.concat(res.dataObj.rankItemList);
                            if (res.dataObj.rankItemList.length < 20) {
                                that.hasMoreDay = false;
                            } else {
                                that.pageDay += 1;
                            }
                        })
                    }
                });
            },
            getShareListShuping: function (fg) {
                if (!this['hasMore' + this.listType] || (fg == 'ch' && this['page'+this.listType] > 1)) {
                    return;
                };
                var that = this;
                var data = {
                    zbid: zbvd.zbid,
                    topicId: zbvd.topicid || 0,
                    page: this['page'+that.listType],
                    limit: this.limit,
                    isday: this.listType == 'Day' ? true : false,
                    isShareTimes: true,
                    uid: zbvd.userid
                };

                var loadingIndex = layer.load(1);
                Utils.ajax("/datalive/v1/h5/share/get_sharelist_cache", data, "POST", "", { baseType: "gwapi" }).then(function (res) {
                    if (res.isok && res.dataObj && res.dataObj.rankItemList) {
                        that.$nextTick(function () {
                            layer.close(loadingIndex);
                            if (res.dataObj && res.dataObj.rankItemList.length) {
                                that['list' + that.listType] = that['list' + that.listType].concat(res.dataObj.rankItemList);
                                that['page' + that.listType] += 1;
                            } else {
                                that['hasMore' + that.listType] = false;
                            }
                            that.$nextTick(function () {
                                globalHanleI18n()
                            })
                        })
                    } else {
                        layer.close(loadingIndex);
                    }
                });
            }
        },
        mounted: function () {
            var that = this;
            $('.total-list').scroll(function () {
                if (($('.total-list').height() + $('.total-list').get(0).scrollTop) === $('.total-list').get(0).scrollHeight) {
                    if (!that.IsScreen) {
                        that.getShareListShuping();
                    }
                }
            })
            $('.day-list').scroll(function () {
                if (($('.day-list').height() + $('.day-list').get(0).scrollTop) === $('.day-list').get(0).scrollHeight) {
                    if (that.IsScreen) {
                        that.getShareListHengping();
                    } else {
                        that.getShareListShuping();
                    }
                }
            })
        }
    })

    // 二维码弹窗
    var qrcodeList = {
        phone: {
            title: '手机看',
            tips: '微信扫码即可观看',
            qrcodeurl: ''
        },
        wc: {
            title: '关注公众号获得更多直播内容',
            tips: '',
            qrcodeurl: ''
        },
        cs: {
            title: '添加客服，随时咨询',
            tips: '联系方式：',
            qrcodeurl: ''
        },
        login: {
            title: '扫码登录',
            // tips: '微信扫码登录即可关注直播间',
            tips: '请使用微信扫描二维码登录',
            qrcodeurl: '',
            type: 'login'
        },
        pay: {
            title: '扫码支付',
            tips: false,
            qrcodeurl: ''
        },
        hudong: {
            title: '扫码登录',
            tips: '微信扫码登录即可参与直播互动',
            qrcodeurl: '',
            type: 'login'
        },
        vote: {
            title:'扫码参与',
            tips: '微信扫码参与投票',
            qrcodeurl: ''
        },
        auction: {
            title:'进入小程序参与竞拍，体验0延迟',
            tips: '微信扫码参与',
            qrcodeurl: ''
        },
        luckdraw: {
            title:'参与直播抽大奖',
            tips: '微信扫码参与',
            qrcodeurl: ''
        },
        tominapp: {
            title:'进入小程序参与竞拍，体验0延迟',
            tips: '微信扫码参与',
            qrcodeurl: ''
        }
    };
    if (qrcodeList.cs.tips.length < 11) {
        qrcodeList.cs.tips = false
    }
    var hasNickNameLogin = $.cookie('visitorNoLoginUserName');
    window.PcLiveApp = new Vue({
        el: '#vue-app',
        data: function () {
            return {
                show: false,
                type: '',
                qrcodeData: {
                    title: '',
                    qrcodeurl: 'https://j.weizan.cn/images/vzanbg/small_ind_5.png?ver=636950768212672650',
                    tips: ''
                },
                wcormin: true,
                minurl: '',
                weburl: '',
                istencentlive: false,
                isbbaclive:false,
                loginType: 1,
                visitorNickname:  hasNickNameLogin || '',
                hasNickNameLogin: hasNickNameLogin != null,
                languageLogin: 'zh_CN',
                loginForm: {
                    phone: '',
                    code: '',
                    agreeBook: false,
                    verObj: null
                },
                timer: null,
                times: null,
                slideHost: '',
                liveCodeHost: '',
                codeLoginHost: ''
            };
            },
        methods: {
            visitorLogin: function () {
                if (hasNickNameLogin) {
                    return;
                }
                if (this.visitorNickname.length) {
                    if (this.visitorNickname.length > 50) {
                        layer.msg('昵称不能超过50个字哦');
                    } else {
                        var that = this;
                        $.ajax({
                            url: '/liveajax/checkKeyWords',
                            data: {
                                tpid: parseInt('768346371'),
                                zbid: parseInt('1427079113'),
                                content: this.visitorNickname
                            },
                            type: 'POST',
                            success: function (res) {
                                if (Number(res.dataObj) <= 0) {
                                    $.cookie('visitorNoLoginUserName', that.visitorNickname, {path:'/',expires:360 });
                                    window.location.reload();
                                } else {
                                    layer.msg('您的昵称涉及敏感词，请重新输入~');
                                }
                            },
                            error: function () {
                                layer.msg('您的昵称敏感词检查异常，请重新输入~');
                            }
                        })
                    }
                } else {
                    layer.msg('昵称不能为空哦');
                }
            },
            showOut: function (type, url) {
                console.log(type);
                if (typeof type === 'string') {
                    this.type = type;
                    if (url) {
                        console.log(url);
                        qrcodeList[type].qrcodeurl = url;
                        if ((type === 'phone' || type === 'auction') && !this.minurl.length) {
                            this.wcormin = true;
                            this.minurl = url;
                            $('.qrc-pc-option').find('div:last-child').addClass('act').siblings('div').removeClass('act');
                        }
                    }
                    else {
                        this.wcormin = true;
                    }
                    this.show = true;
                    var item = qrcodeList[type];
                    this.qrcodeData = item;
                    if (!zbvd.userid && (type === 'login' || type === 'hudong')) {
                        PCUserLogin()
                    } else {
                        clearInterval(timerCheckLogin);
                        timerCheckLogin = null;
                    }
                } else {
                    clearInterval(timerCheckLogin);
                    timerCheckLogin = null;
                    $("#attentionDiv").hide();
                    this.show = false;
                }
                globalHanleI18n()
                try {
                    // 自定义埋点 关注公众号
                    window.VZAN_SHENCE && window.VZAN_SHENCE.track('zb_gzh_click', {
                        page_type: '直播页',
                        page_name: document.title,
                        page_url: window.location.href,
                        event_time: Date.now()
                    });
                }  catch (error) {
                    console.log(error)
                }
            },
            // 手机，小程序 码切换
            changeTpyePhone: function (fg) {
                // console.log(fg)
                if (this.minurl && this.weburl) {
                    this.qrcodeData.qrcodeurl = fg ? this.weburl : this.minurl;
                    this.wcormin = fg;
                    $('.qrc-pc-option').find('div:' + (fg ? 'first' : 'last') + '-child').addClass('act').siblings('div').removeClass('act');
                }
            },
            // 二维码弹窗
            renderCodeShow: function (type, url) {
                var that = this;
                if (type === 'vote') {
                    var cavdom = $('#vote-to-code').find('canvas').get(0);
                    if (cavdom) {
                        cavdom.getContext("2d").clearRect(0, 0, 128, 128);
                    }
                    $('#vote-to-code').html('');
                    $('#vote-to-code').qrcode({ width: 128, height: 128, correctLevel: 0, text: url });
                    var loadingIndex = layer.load(1);
                    setTimeout(function () {
                        layer.close(loadingIndex);
                        that.qrcodeData = qrcodeList[type];
                        that.qrcodeData.qrcodeurl = $('#vote-to-code').find('canvas').get(0).toDataURL();
                        that.show = true;
                    }, 1500)
                }
                if (!zbvd.userid && (type === 'login' || type === 'hudong')) {
                    PCUserLogin()
                } else {
                    clearInterval(timerCheckLogin);
                    timerCheckLogin = null;
                }
            },
            // 获取话题二维码  公众号 、客服
            GetTopicQRCode: function (cb) {
                var that = this;
                $.post('/liveajax/GetTopicQRCode', { tpid: zbvd.topicid }, function (data) {
                    if (data.isok && data.dataObj) {
                        var qrcode = data.dataObj.MerchantQRCode || data.dataObj.QrCodeUrl || 'https://static1.weizan.cn/zhibo/livecontent/miniVideo/images/ico-noQCode.png';
                        if (zbvd.LogoPopType == 1) {
                            qrcodeList.wc.qrcodeurl = qrcode;
                            qrcodeList.wc.title = data.dataObj.QRName || '关注后可收到直播最新动态哦';
                        } else if (zbvd.LogoPopType == 2) {
                            qrcodeList.cs.qrcodeurl = qrcode;
                        }
                        cb && cb();
                    }
                });
            },
            // 获取话题二维码
            GetTopicQRCodeNew: function () {
                var that = this;
                $.post('/liveajax/GetTopicQRCode', { tpid: zbvd.topicid }, function (data) {
                    if (data.isok && data.dataObj) {
                        var qrcode = data.dataObj.MerchantQRCode || data.dataObj.QrCodeUrl || 'https://static1.weizan.cn/zhibo/livecontent/miniVideo/images/ico-noQCode.png';
                        qrcodeList.wc.title = data.dataObj.QRName;
                        qrcodeList.wc.qrcodeurl = qrcode;
                        qrcodeList.wc.tips = data.dataObj.QRDescribe;
                        that.showOut("wc");
                    }
                });
            },
            saveLiveFocus: function (_cancleFlag, _focustype, callback_success) {
                $.post('/liveajax/savefocus', { cancleFlag: _cancleFlag, liveid: zbvd.zbid, "types": "focus", focustype: _focustype, shareuid: zbvd.shareuid }, function (data) {
                    if (callback_success && typeof (eval(callback_success)) == "function") {
                        callback_success();
                    }
                });
            },

            changeLoginLanguage:function(value) {
                this.languageLogin = value
                $.cookie('language', this.languageLogin, { expires: 30, path: '/' })
                var that = this
                window.location.href=updateLoadUrl(window.location.href)
                // location.reload()
            },

            routerTo:function() {
                $.post('/live/facebooklogin',{
                    topicid: zbvd.topicid,
                    zbid: zbvd.zbid,
                    channel: 'PC',
                    redirect_uri: window.location.href
                }).then(function (data) {
                   if (data && data.isok) {
                        // location.href = data.dataObj.loginUrl
                        var a = document.createElement('a')
                        a.href = data.dataObj.loginUrl
                        a.rel = 'noreferrer'
                        if(self != top){
                            a.target = '_top'
                        }else{
                            a.target = '_self'
                        }
                        a.click()
                    }
                });
            },

            // 切换登录形式
            handleChangeLogin:function(val) {
                if (this.loginType == val) return;
                this.loginType = val
                this.initLogin()
            },

            getSlideCode:function() {
                if (this.timer) return //验证码倒计时不请求
                if(!this.loginForm.phone) {
                    var tips = $.i18n.prop('please.setYourPhone.place')? $.i18n.prop('please.setYourPhone.place'): "请输入您的手机号码"
                    $(document).minTipsBox({
                        tipsContent: tips,
                        tipsTime: 1
                    });
                    return false;
                }
                if (this.loginForm.phone!='') {
                    if(!(/^1[3456789]\d{9}$/.test(this.loginForm.phone))){
                        var tips = $.i18n.prop('phone.illegal.tips')? $.i18n.prop('phone.illegal.tips'): "手机号码不合法，请重新输入"
                        $(document).minTipsBox({
                            tipsContent: tips,
                            tipsTime: 1
                        });
                        return false;
                    }
                }
                var that = this;
                $.ajax({
                    type: "GET",
                    url: that.slideHost + "/api/v2/code/create",
                    data: {
                        key: this.loginForm.phone,
                        app: 'vzanlive'
                    },
                    success: function (data) {
                        console.log(data);
                        $("#imgscode").show();
                        this.verObj =  $("#imgscode").imgcode({
                            frontimg: data.dataObj.frontImg,
                            backimg: data.dataObj.backGoundImg,
                            refreshcallback(){
                                that.getSlideCode(); //刷新验证码
                            },
                            callback(msg){
                                console.log(that,msg,'msg')
                                if (msg.xpos == -1) return
                                that.chkVerCode(this, msg.xpos);
                            }
                        });
                        $("#imgscode .code-img .code-mask").css("padding-top", data.yAddress + "px");
                        $("#imgscode .code-img .code-mask").css("box-sizing", 'border-box');
                    },
                    error: function () {

                    }
                });
            },

            chkVerCode:function(obj, xpos) {
                var that = this
                $.ajax({
                    type: "POST",
                    url: that.slideHost + "/api/v2/code/verify",
                    data: {
                        xpos: xpos,
                        key: this.loginForm.phone,
                        app: 'vzanlive'
                    },
                    success: function (data) {
                        if (data.isok==true) {
                            obj.getsuccess();
                            that.getCode() // 验证码接口
                        }else {
                            var tips = $.i18n.prop('error.name')? $.i18n.prop('error.name'): "验证失败"
                            obj.getfail(tips);
                            setTimeout(function() {
                                that.getSlideCode()
                            },1200)
                            return
                        }
                    }
                });
            },

            getCode:function() {
                var that = this
                var tips = ''
                $.ajax({
                    type: "GET",
                    url: that.liveCodeHost +"/api/v1/SMS/get_phone_login_smscode",
                    data: {
                        phone: this.loginForm.phone,
                    },
                    success: function (data) {
                        if (data.isok==true && data.code==0) {
                            tips = "发送成功"
                            $(document).minTipsBox({
                                tipsContent: tips,
                                tipsTime: 1
                            });
                            that.times = 120
                            // this.times = 5
                            that.timer = setInterval(function(){
                                that.times--
                                if(that.times===0){
                                    clearInterval(that.timer)
                                    that.timer = null
                                }
                            },1000)
                        }else {
                            tips = data.msg
                            $(document).minTipsBox({
                                tipsContent: tips,
                                tipsTime: 1
                            });
                            return false;
                        }
                    }
                });
            },

            submitLoign:function() {
                var that = this
                if (this.loginForm.phone=='') {
                    var tips = $.i18n.prop('please.setYourPhone.place')? $.i18n.prop('please.setYourPhone.place'): "请输入您的手机号码"
                    $(document).minTipsBox({
                        tipsContent: tips,
                        tipsTime: 1
                    });
                    return false;
                }
                if (this.loginForm.phone!='') {
                    if(!(/^1[3456789]\d{9}$/.test(this.loginForm.phone))){
                        var tips = $.i18n.prop('phone.illegal.tips')? $.i18n.prop('phone.illegal.tips'): "手机号码不合法，请重新输入"
                        $(document).minTipsBox({
                            tipsContent: tips,
                            tipsTime: 1
                        });
                        return false;
                    }
                }

                if (this.loginForm.code=='') {
                    var tips = $.i18n.prop('please.setYourCode.place')? $.i18n.prop('please.setYourCode.place'): "请输入验证码"
                    $(document).minTipsBox({
                        tipsContent: tips,
                        tipsTime: 1
                    });
                    return false;
                }
                if (this.loginForm.agreeBook==false) {
                    var tips = $.i18n.prop('User.Agreement.and.privacy.policy')? $.i18n.prop('User.Agreement.and.privacy.policy'): "请阅读并勾选用户协议"
                    $(document).minTipsBox({
                        tipsContent: tips,
                        tipsTime: 1
                    });
                    return false;
                }
                $.ajax({
                    type: "POST",
                    url: that.codeLoginHost +"/api/auth/verify_code_login",
                    data: {
                        phone: this.loginForm.phone,
                        code: this.loginForm.code
                    },
                    success: function (data) {
                        if (data.isok==true && data.code==0) {
                            var subhost = '',subhostArr = location.host.split('.');
                            subhostArr.shift()
                            subhost = '.' + subhostArr.join('.');
                            document.cookie = ""+ zbvd.usercookie + "=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;";
                            $.cookie(zbvd.usercookie, data.dataObj.cookieVal, { path: '/', domain: "." + location.host });
                            $.cookie(zbvd.usercookie, data.dataObj.cookieVal, { domain: location.hostname, path: '/' });
                            $.cookie(zbvd.usercookie, data.dataObj.cookieVal, { domain: zbvd.cookiedomain, path: '/' });
                            $.cookie(zbvd.usercookie, data.dataObj.cookieVal, { domain: subhost, path: '/' });
                            if(self != top){
                                setTimeout(function () { window.parent.location.reload(true); }, 1500);
                            }else{
                                setTimeout(function () { window.location.reload(true); }, 1500);
                            }
                        }else {
                            var tips = data.msg
                            $(document).minTipsBox({
                                tipsContent: tips,
                                tipsTime: 1
                            });
                            return false;
                        }
                    }
                });
            },

            initLogin: function() {
                this.loginForm = Object.assign({}, this.loginForm, this.$options.data().loginForm)
                this.timer = null
                this.times = null
            },

            getEnv: function() {
                if (/local|demvt.vzan|dev.vzan|wx-dev.vzan|-dev|192.|127./i.test(location.host)) {
                    return 'dev';
                } else if (/ntestvt|-pre/i.test(location.host)) {
                    return 'ntestvt';
                } else if (/testvt|ce.vzan|-test/i.test(location.host)) {
                    return 'testvt';
                } else {
                    return 'prod';
                }
            },

            getHostValue: function() {
                switch(this.getEnv()) {
                    case "dev":
                        this.slideHost = 'https://live-gateway-dev.vzan.com/slidverify'
                        this.liveCodeHost = 'https://live-liveapi-dev.vzan.com'
                        this.codeLoginHost = 'https://live-play-dev.vzan.com'
                        break;
                    case "testvt":
                        this.slideHost = 'https://live-gateway-dev.vzan.com/slidverify'
                        this.liveCodeHost = 'https://live-liveapi-test.vzan.com'
                        this.codeLoginHost = 'https://live-play-test.vzan.com'
                        break;
                    case "ntestvt":
                        this.slideHost = 'https://live-gateway.vzan.com/slidverify'
                        this.liveCodeHost = 'https://live-liveapi-pre.vzan.com'
                        this.codeLoginHost = 'https://live-play-pre.vzan.com'
                        break;
                    case "prod":
                        this.slideHost = 'https://live-gateway.vzan.com/slidverify'
                        this.liveCodeHost = 'https://live-liveapi.vzan.com'
                        this.codeLoginHost = 'https://live-play.vzan.com'
                        break;
                }
            }

        },
        mounted: function () {
            var that=this;
            this.languageLogin = $.cookie('language')
            this.getHostValue()
            setTimeout(function () {
                var loginimg = $('#WeixinSanQRCode').find('canvas').get(0).toDataURL();
                qrcodeList.login.qrcodeurl = loginimg;
                qrcodeList.hudong.qrcodeurl = loginimg;
                var phonecode = $('#liveqr').find('canvas').get(0).toDataURL();
                qrcodeList.phone.qrcodeurl = phonecode;
                qrcodeList.luckdraw.qrcodeurl = qrcodeList.phone.qrcodeurl;
                qrcodeList.vote.qrcodeurl = phonecode;
                that.weburl = qrcodeList.phone.qrcodeurl;
            }, 500);

            //腾讯直播间屏蔽
            if (that.istencentlive) {
                $(".direct-one-personal").hide();
                $(".live-follow").hide();
                $(".set-live-share").hide();
            }
            if (that.isbbaclive) {
                $(".direct-one-personal").hide();
                $(".live-topic-info").hide();

                $(".sgin_in_traning").hide();
            }
            if ($.cookie('visitorNoLoginUserName')) {
                //快来发表你的评论吧
                var dominput = $('<input selectname="comment.place.name" selectattr="placeholder" placeholder="快来发表你的评论吧" id="input-txtbox" class="direct-three-right-bottom-shuru i18n-input" />')
                $('.c-notlogin').replaceWith(dominput);
            }

            // 网页端连麦绑定身份（没有登录先弹出登录弹窗登录）
            var params = Utils.GetParmas()
            if (!zbvd.loginuser && params.linkMicRole) {
                this.showOut('login');
            }
        },
        watch: {
            show:function() {
                this.loginType = '1'
                this.initLogin()
                if (this.show == true) {
                    var that = this
                    this.$nextTick(function() {
                        if (that.qrcodeData.type == 'login') {
                            globalHanleI18n()
                        }
                    })
                }
            }
        }
    });

    window.PcRedbag2021 = new Vue({
        el: '#pc-redbag-2021',
        data: function() {
            return {
                showLogin: false,
                qrcodeURL: '',
                timerCheckLogin: null,
                showNoLogin: false
            }
        },
        computed: {
            showTimer: function () {
                return lookredpacketapp.showTimer;
            },
            showWatchRedBag: function () {
                return lookredpacketapp.showWatchRedBag;
            },
            cdMin: function () {
                return lookredpacketapp.cdMin;
            },
            cdSec: function () {
                return lookredpacketapp.cdSec;
            },
        },
        mounted: function () {
            var that = this;
            setTimeout(function () {
                var loginimg = $('#WeixinSanQRCode').find('canvas').get(0).toDataURL();
                that.qrcodeURL = loginimg;
            }, 100)
        },
        methods: {
            // 开红包
            handleWatchRedBag: function() {
                // 已断网
                if (!lookredpacketapp.networkStatus) {
                    layer.msg('网络已断开，请检查网络');
                    return;
                }

                if (liveStatus == 'notbegin' || (liveStatus == 'notsignal' && liveinfo.playurl == '')) {
                    lookredpacketapp.showRedBagMask = true;
                    lookredpacketapp.showLangscapeRedBag = 5;
                    return;
                }
                lookredpacketapp.showRedBagMask = true;

                if (typeof lookredpacketapp != 'undefined' && lookredpacketapp.rewardArray && lookredpacketapp.rewardArray.times) {
                    lookredpacketapp.showLangscapeRedBag = 4;
                } else {
                    lookredpacketapp.showLangscapeRedBag = 1;
                }
            },
            handleClickLogin: function() {
                this.showLogin = !this.showLogin
            },
            enterLogin: function() {
                this.showLogin = true
                this.PCUserLogin()
            },
            leaveLogin: function() {
                this.showLogin = false
                clearInterval(this.timerCheckLogin);
                this.timerCheckLogin = null;
            },
            PCUserLogin: function() {
                var that = this
                if (!zbvd.userid) {
                    $.post("/live/login-" + zbvd.zbid, { skId: zbvd.skId, backurl: '0F7BFFA9474D371F39E70DAD7EB5EB23F2C9F26430169546F1B0327A879E8A476EC81D9CADB2DD007935136160D1E30513055652D15ACD538189A4E647D151BBC582C7C172AD3EAE6EDB5D5DB3113A3F58DA3B3ED481E3AAC3DC2E2055FD22E6957925481D1C94818F9DDC84EB45BB3132DDDE9370F47BF0AA6CF895F6C9BA07AB652CD608D2E6399A76ADA9693EF3D7' }, function () { });
                    that.timerCheckLogin = setInterval(function getlogininfo() {
                        $.post("/live/getlogininfo", { skId: zbvd.skId }, function (data) {
                            if (data && data.isok) {
                                $.cookie(zbvd.usercookie, data.Msg, { path: '/', domain: "." + location.host });
                                setTimeout(function () { window.location.reload(true); }, 1500);
                            }
                            else if (data && !data.isok) {
                                if (data.msg.indexOf("二维码已过期") > -1) {
                                    $(document).minTipsBox({
                                        tipsContent: data.msg,
                                        tipsTime: 1
                                    });

                                    clearInterval(that.timerCheckLogin);
                                    that.timerCheckLogin = null;
                                }
                            }
                        });
                    }, 2000);
                } else {
                    clearInterval(that.GetTopicQRCodetimerCheckLogin);
                    timerCheckLogin = null;
                }
            }
        }
    })

    var pdShare = new Vue({
        el: '#pd-share-id',
        data: {
            sharePdPopUp: false,
            shareUrl: 'https://wx.vzan.com/live/tvchat-768346371?ver=638512900112373342&amp;sharetstamp=1715664411237'.replace(/&amp;/g, '&'),
            drainSet: null,
            getTopicQRCodeShow: false,
            AttentionLiveSwitch: false,
            CustomImageSwitch: false,
            isShowConcernLook: false,
            isFocus: 'False'.toLowerCase() === 'true',
            isSubscribe: true,
            mpQrCode: ''
        },
        created() {
            var _this = this;
            window.triggerQrCodeIMEvent = this.triggerQrCodeIMEvent;
            setTimeout(function() {
                if (window.drainSetConfig && window.drainSetConfig.length) {
                    for (var i = 0; i < window.drainSetConfig.length; i++) {
                        if (window.drainSetConfig[i].type == 'subscribe') {
                            _this.drainSet = window.drainSetConfig[i];
                            _this.AttentionLiveSwitch = _this.drainSet.open;
                            _this.CustomImageSwitch = _this.drainSet.alertActively;
                            _this.isShowConcernLook = _this.drainSet.open && _this.drainSet.alertActively && _this.drainSet.mustSubscribe;
                            if (_this.isShowConcernLook) {
                                _this.getIsSubscribe();
                            }
                            _this.AutoShowQRCode(zbvd.topicid);
                            _this.saveLiveFocus(0, '');
                            break;
                        }
                    }
                }
            }, 2500);
        },
        methods: {
            triggerQrCodeIMEvent: function(e) {
                console.log(e);
                this.getTopicQRCodeShow = true;
            },
            getIsSubscribe: function() {
                var _this = this
                Utils.ajax('/marketing/wx/v1/public/private_domain/drainage/topic/isSubscribe?userId=' + zbvd.userid + '&zbId=' + zbvd.zbid, {}, 'post',
                    '', { baseType: '' }).then(function (result) {
                    _this.isSubscribe = result.data;
                }, "json");
            },
            pdShareEnter: function(e) {
                this.sharePdPopUp = true;
            },
            pdShareLeave: function(e) {
                var that = this;
                this._sharetimer = setTimeout(function() {
                    that.sharePdPopUp = false;
                }, 150);
            },
            pdShareSover: function() {
                clearTimeout(this._sharetimer);
            },
            track: function() {
                // 自定义埋点 分享
                window.VZAN_SHENCE && window.VZAN_SHENCE.track('zb_topic_share',{
                    page_type: '直播页',
                    page_name: document.title,
                    page_url: window.location.href,
                    is_success: true,
                    fail_reason: '',
                    event_time: Date.now(),
                });
            },
            AutoShowQRCode: function(tpId) {
                var that = this;
                if (that.drainSet && that.drainSet.alertType != 'no' && (that.drainSet.alertActively && that.drainSet.open)) {
                    //是否弹出关注二维码
                    if (that.drainSet.alertType == 'everyday') { //每天一次
                        if (!$.cookie("focusQRshow5_" + tpId)) {
                            setTimeout(that.getTpQrcode(true), 3500);
                            $.cookie("focusQRshow5_" + tpId, "1", { expires: 1, path: '/', domain: location.hostname, secure: false });
                        }
                    } else { //每次进入都弹
                        setTimeout(that.getTpQrcode(true), 3500);
                    }
                }
            },
            getTpQrcode: function() {
                this.getTopicQRCodeShow = true;
                try {
                    // 自定义埋点 43 关注
                    window.VZAN_SHENCE && window.VZAN_SHENCE.track('zb_gzh_click', {
                        page_type: '直播页',
                        page_name: document.title,
                        page_url: window.location.href,
                        event_time: Date.now()
                    });
                } catch (error) {
                    console.log(error)
                }
            },
            //关注直播间
            focusCurrentLive: function () {
                var _this = this;
                if (!this.isFocus) {
                    _this.saveLiveFocus(1, 'click', function () {
                        layer.msg('关注成功');
                        _this.isFocus = true;
                    });
                }
            },
            //关注直播间并且 弹窗关注
            focusAndShowAttention: function () {
                var _this = this;
                if (!this.isFocus) {
                    _this.saveLiveFocus(1, 'click', function () {
                        layer.msg('关注成功');
                        _this.isFocus = true;
                    });
                }
                _this.getTpQrcode();//获取关注信息
            },
            saveLiveFocus: function (_cancleFlag, _focustype, callback_success) {
                var _this = this;
                setTimeout(function () {
                    var generalizeShopId = _this.getQueryString('generalizeShopId', 0) || _this.getQueryString('generalizeshopid', 0) || 0;
                    $.post('/liveajax/savefocus', { cancleFlag: _cancleFlag, liveid: zbvd.zbid, "types": "focus", focustype: _focustype, generalizeShopId: generalizeShopId }, function (data) {
                        if (callback_success && typeof (eval(callback_success)) == "function") {
                            callback_success();
                        }
                    });
                }, 1000);
            },
            getQueryString: function (name, defaultval) {
                var reg = new RegExp('(^|&)' + name + '=([^&]*)(&|$)', 'i');
                var r = window.location.search.substr(1).match(reg);
                if (r != null) {
                    return unescape(r[2]);
                }
                return defaultval || null;
            },
        }
    })

    var pdLang =  new Vue({
        el: '#pd-lang-id',
        data() {
            return {
                languageValue: 'zh_CN',
                timer: null,
                langVisible: false,
                showButton: true
            }
        },
        mounted: function() {
            if (window.zbvd.roleid == 0 && window.zbvd.applyId == 17 && window.zbvd.customertype == 10) {
                this.showButton = false
            }
        },
        methods: {
            changeLanguage(value) {
                if (window.zbvd.applyId == 17 && window.zbvd.customertype == 10) {
                    this.$alert('当前直播间版本不支持该功能，如需使用此功能请进行直播间升级，如有疑问，可致电官方服务电话：4000866612', '升级提示', {
                        confirmButtonText: '立即升级',
                        callback: function(action) {
                            if(action == 'confirm') {
                                location.href = '/live/AccountManage-3100?zbid=' + window.zbvd.zbid
                            }
                        }
                    });
                    return
                }
                if (this.languageValue == value) return this.langVisible = false
                this.languageValue = value
                $.cookie('language', this.languageValue, { expires: 30, path: '/' })
                window.location.href=updateLoadUrl(window.location.href)
                // location.reload();
            }
        },
        watch: {

        },

        created:function() {
            var that = this
            if ($.cookie('language')) {
                this.languageValue = $.cookie('language')
            }else {
                this.timer = setInterval(function() {
                    if ($.cookie('language')) {
                        console.log(21123)
                        that.languageValue = $.cookie('language')
                        clearInterval(that.timer)
                        that.timer = null
                    }
                },300)
            }
        }
    });
    var loginUser = '';
    // if(!loginUser) {
    //     console.log('login')
    //     PcLiveApp.showOut('login');
    // }

    window.pdRightMenu = new Vue({
        el: '#pd-right-fixed-id',
        data: {
            pdRightMenuCurrent: '',
            shareUrl: 'https://wx.vzan.com/live/tvchat-768346371?ver=638512900112373342&amp;sharetstamp=1715664411237',
            text: '',
            isWait: false,
            drainSet: null,
            isShowCustomerService: false
        },
        methods: {
            pdRightMenuEnter: function(e) {
                console.log(e)
                if(!loginUser && e === 'mine') {
                    return;
                }
                this.pdRightMenuCurrent = e;
            },
            pdRightMenuleave: function(e) {
                var that = this;
                this._rightMenutimer = setTimeout(function() {
                    that.pdRightMenuCurrent = '';
                }, 150);
            },
            pdRightMenuSover: function() {
                clearTimeout(this._rightMenutimer);
            },
            setMinappQRCode: function (url) {
                $('.mini-qrcode-box').find('img').attr('src', url).css("visibility","visible");
                // 竞拍小程序二维码
                qrcodeList['auction'].qrcodeurl = url;
            },
            open: function() {
              if (this.isWait) {
                  window.SummitWebMic.revokeVisible = true
              } else {
                  window.SummitWebMic.openLinkMicDialog()
              }
            },
            onVirtualSceneClick: function() {
              window.location.href = "/live/page/virtualScene/" + zbvd.topicid;
            }
        },
        created() {
            var _this = this;
            setTimeout(function() {
                if (window.drainSetConfig && window.drainSetConfig.length) {
                    for (var i = 0; i < window.drainSetConfig.length; i++) {
                        if (window.drainSetConfig[i].type == 'consult') {
                            _this.drainSet = window.drainSetConfig[i];
                            _this.isShowCustomerService = _this.drainSet.open && _this.drainSet.liveHome;
                            break;
                        }
                    }
                }
            }, 2500);
        }
    })
    window.pdRightMenu1 = new Vue({
        el: '#pd-right-fixed-id-1',
        data: {
            pdRightMenuCurrent1: '',
            shareUrl: 'https://wx.vzan.com/live/tvchat-768346371?ver=638512900112373342&amp;sharetstamp=1715664411237',
            drainSet: null,
            isShowCustomerService: false
        },
        methods: {
            pdRightMenuEnter1: function(e) {
                if(!loginUser && e === 'mine') {
                    return;
                }
                this.pdRightMenuCurrent1 = e;
            },
            pdRightMenuleave1: function(e) {
                var that = this;
                this._rightMenutimer1 = setTimeout(function (){
                    that.pdRightMenuCurrent1 = '';
                }, 150);
            },
            pdRightMenuSover1: function() {
                clearTimeout(this._rightMenutimer1);
            },
            setMinappQRCode: function (url) {
                $('.mini-qrcode-box').find('img').attr('src', url);
                // 竞拍小程序二维码
                qrcodeList['auction'].qrcodeurl = url;
            }
        },
        created() {
            var _this = this;
            setTimeout(function() {
                if (window.drainSetConfig && window.drainSetConfig.length) {
                    for (var i = 0; i < window.drainSetConfig.length; i++) {
                        if (window.drainSetConfig[i].type == 'consult') {
                            _this.drainSet = window.drainSetConfig[i];
                            _this.isShowCustomerService = _this.drainSet.open && _this.drainSet.liveHome;
                            break;
                        }
                    }
                }
            }, 2500);
        }
    });

    window.pcRightComment = new Vue({
        el: '#direct-three-right-comment-id',
        data: {
            namebandan: ''
        },
        methods: {
        }
    });

    // 弹窗事件
    $('.show-out-pop').click(function () {
        var dom = $(event.target);
        var type = dom.data('type');
        if (!dom.hasClass('show-out-pop')) {
            type = dom.parents('.show-out-pop').data('type');
        }
        if (type === 'guess') {
            ShowQrCode();
            return;
        }
        PcLiveApp.showOut(type);
        try {
            // 自定义埋点 关注公众号
            window.VZAN_SHENCE && window.VZAN_SHENCE.track('zb_gzh_click', {
                page_type: '直播页',
                page_name: document.title,
                page_url: window.location.href,
                event_time: Date.now()
            });
        }  catch (error) {
            console.log(error)
        }
    });


    //跑马灯 start
    var horseClock;//跑马灯定时器 用于每隔一段时间改变位置
    setTimeout(horseInit,6000)
    function horseInit() {
        if ($('#horse-box').length == 0) {
            $('#player-el').append("<div id='horse-box'></div>");
        }
        $.get("/liveajax/HorseRaceLamp", { tid: zbvd.topicid, v: new Date().getTime() })
            .then(function (r) {
                if (r.isok) {
                    var data = r.dataObj;
                    clearInterval(horseClock)
                    if ($('#horse-box .horse-text').length == 0) {
                        var text = $('<div class="horse-text"></div>');
                        text.text(data.MaskCustomValue).css({ color: data.MaskFontColor, fontSize: data.MaskFontSize / 2 })
                            .appendTo('#horse-box')
                    } else {
                        var text = $('#horse-box .horse-text')
                        text.text(data.MaskCustomValue).css({ color: data.MaskFontColor, fontSize: data.MaskFontSize / 2 })
                    }
                    //转rgba
                    text.css('color', text.css('color').replace('rgb', 'rgba').replace(')', ',') + (100 - data.MaskOpacity) / 100 + ')')
                    var w = $('#horse-box').width(), h = $('#horse-box').height(),
                        sw = text.width(), sh = text.height()
                    var x, y;
                    switch (r.dataObj.MaskStyle) {
                        //32为videojs控制条高度
                        case 1:
                            text.addClass('default').removeClass('blink');
                            horseClock = setInterval(function () {
                                y = randomRange(0, h - sh - 32) / h
                                text.css({ top: y * 100 + '%' })
                            }, 14000)
                            break;
                        case 2:
                            text.addClass('blink').removeClass('defalut');
                            horseClock = setInterval(function () {
                                y = randomRange(0, h - sh - 32) / h
                                text.css({ top: y * 100 + '%' })
                            }, 14000)
                            break;
                        case 3:
                            text.removeClass('default blink');
                            horseClock = setInterval(function () {
                                if (sw == 0)
                                    sw = text.width()
                                x = randomRange(0, w - sw) / w
                                y = randomRange(0, h - sh - 32) / h
                                text.css({ 'left': x * 100 + '%', top: y * 100 + '%' })
                            }, 5000)
                            break;
                    }
                } else {
                    $('#horse-box .horse-text').remove()
                }
            })
    }

    function randomRange(a, b) {//返回a,b之间的随机值 用于跑马灯随机定位
        return (b - a) * Math.random() + a;
    }
    //跑马灯 end
    var isadmin = zbvd && zbvd.isadmin;
    var isfirstEnter = true;
    $(document).on("click", "#pcOpenForm", function () {
        var _formurl = "/live/tpform?oId=768346371&zbId=1427079113&type=1&meun=iframe";
        if ($(this).data("url") != undefined && $(this).data("url") != "") {
            _formurl = $(this).data("url");
        }
        var title = $(this).attr("attr-title") || "报名表";
        var isShowBtn = 1;
        layer.open({
            skin: 'tpForm',
            type: 2,
            area: ['450px', '650px'],
            fix: false, //不固定
            anim: 5, //动画0~6
            shade: 0.4,  //遮罩透明度
            title: title, //页面标题
            shadeClose: isShowBtn,
            closeBtn: isShowBtn,
            content: _formurl,
            end: function () {
                $('body').get(0).style = 'overflow: hidden auto;'
            }
        });
        $('body').css({
            position: 'fixed',
            top: 0,
            left: 0,
            right: 0,
            bottom: 0
        });
    })

    var titleName = "报名表";
    $(document).on("click", "#openformJava", function () {
        var newzbid = window.zbvd.zbid;
        var _formurl = location.protocol + "//" + location.host + "/live/tpform?oId=768346371&type=1&meun=iframe&zbId="+newzbid;
        if ($(this).data("url") != undefined && $(this).data("url") != "") {
            _formurl = $(this).data("url");
        }
        var title = $(this).attr("attr-title") || titleName || "报名表";
        var isShowBtn = 1;
        layer.open({
            skin: 'tpForm',
            type: 2,
            area: ['480px', '650px'],
            fix: false, //不固定
            anim: 5, //动画0~6
            shade: 0.4,  //遮罩透明度
            title: title, //页面标题
            shadeClose: isShowBtn,
            closeBtn: isShowBtn,
            content: _formurl,
            end: function () {
                $('body').get(0).style = 'overflow: hidden auto;'
            }
        });
        $('body').css({
            position: 'fixed',
            top: 0,
            left: 0,
            right: 0,
            bottom: 0
        });
    })
    $(function () {
        // 新版抽奖大转盘icon逻辑判断12.10

        function getQueryVariable(variable) {
            var query = window.location.search.substring(1);
            var vars = query.split("&");
            for (var i = 0; i < vars.length; i++) {
            var pair = vars[i].split("=");
            if (pair[0] == variable) { return pair[1]; }
            }
            return (false);
        }
        if (window.zbvd.TurntableId>0) {
            var url = '/live/mk/turntableindex?zbid=' + window.zbvd.zbid + '&lotteryid=' + window.zbvd.Enc_TurntableId +"&topicid="+window.zbvd.topicid + "&v=" + new Date().getTime()+ "&tuid=" +  getQueryVariable("tuid");
            $('#newTurnIcon').attr('href',url);
            $("#oldTurnIcon").css("display","none");//
            $("#newTurnIcon").css("display","block");//显示新版
        }
        // 11.10 PC页面报名表跳转逻辑
        var isadmin = zbvd && zbvd.isadmin;
        var isfirstEnter = true;
        // 11.3调用java新版报名表接口判断报名表弹出类型
        console.log(window.zbvd.formId>0,window.zbvd.formId);
        if (window.zbvd.formId>0) {
            // 获取url参数
            var signupskip = getQueryVariable("signupskip")||0;
            var base = {
                id: "768346371", //获取话题
                //needFormAttr: true,//无登录状态下无需获取post_data
                //userId:userId,//已登录就请求post_data
                shareUid: 0,
                type: 1, //类型固定话题zbid
                zbId: window.zbvd.zbid,
            };
            //判断用户是否已登录
            var formUrl = "/marketing/wx/v1/enroll_form/simple"
            if(window.zbvd.userid!=0){
                base.userId = window.zbvd.userid;
                formUrl = "/marketing/wx/v1/enroll_form/get"
            }else{
                base.needFormAttr = true;
            }
            var lid = window.zbvd.zbid; //报名表请求判断是否强制报名且未填报名表跳转新版报名表页面
            var rol = window.zbvd.roleid;
                $.ajax({
                    headers: {
                        'TOKEN-PAYLOAD': JSON.stringify({lid,rol})
                    },
                type: "POST",
                dataType: "json",
                contentType: "application/json",
                url: formUrl,
                data: JSON.stringify(base),
                success: function (data) {
                    // console.log(data);
                    var newzbid = window.zbvd.zbid;
                    if (data && data.dataObj) {
                        // 待审核 || 审核不通过
                        var auditStatus = data.dataObj.audit_type === 0 || data.dataObj.audit_type === 2
                        //判断新版版本是否已报名
                        //此处只调用接口判断是否弹出报名表弹窗以及判断显示互动区icon是哪个
                        //判断是否进入前要打开报名表
                        if (
                            (data.dataObj.form_attr.topicEnterType==1||data.dataObj.form_attr.topicEnterType==2) && (data.dataObj.post_data.length==0 || auditStatus)
                        ) {
                            // console.log("in");
                            if (data.dataObj.form_attr.fillInStyle == 1 && !window.zbvd.isadmin) {
                                // console.log("in_iframe");
                                //执行弹窗弹出
                                // 获取报名表
                                var _formurl =
                                    location.protocol +
                                    "//" +
                                    location.host +
                                    "/live/tpform?oId=768346371&type=1&meun=iframe&zbId=" +
                                    newzbid+'&ver='+new Date().getTime();
                                if (
                                    $(this).data("url") != undefined &&
                                    $(this).data("url") != ""
                                ) {
                                    _formurl = $(this).data("url");
                                }
                                var title = data.dataObj.title || "报名表";
                                titleName = data.dataObj.title || "报名表";
                                var isShowBtn = data.dataObj.form_attr.must_write ? 0 : 1;
                                layer.open({
                                    skin: 'tpForm',
                                    type: 2,
                                    area: ['480px', '650px'],
                                    fix: false, //不固定
                                    anim: 5, //动画0~6
                                    shade: 0.4,  //遮罩透明度
                                    title: title, //页面标题
                                    shadeClose: isShowBtn,
                                    closeBtn: isShowBtn,
                                    content: _formurl,
                                    end: function () {
                                        $('body').get(0).style = 'overflow: hidden auto;'
                                       }
                                });
                                $("body").css({
                                    position: "fixed",
                                    top: 0,
                                    left: 0,
                                    right: 0,
                                    bottom: 0,
                                });
                            }else if(data.dataObj.form_attr.fillInStyle == 0 && !window.zbvd.isadmin){
                                //判断是否跳过填写
                                if(signupskip==1){
                                }else if(Utils.getUrlParam('mike')==''){
                                    //整体页面跳转
                                    var others = encodeURIComponent(JSON.stringify(window.location.search.substring(1)))||"";
                                    console.log("toNewPage");
                                    //window.location.href = "/live/tpform?oId=768346371&type=1&meun=pc&zbId=" + newzbid + "&others="  + others;

                                    // 报名表独立页面跳转优化(话题报名表)
                                    window.location.href = "/live/mk/signupform?zbid=" + newzbid + '&oId=768346371&type=1&meun=pc&others='  + others;
                                }
                            }
                        }
                    }else if (data && data.code==4008){
                        //此处进行直播登录页的跳转
                        //打开扫码登录页
                        //如果没登录，且不会自动跳转，说明是非强制的弹窗
                        //因为未登录，无法通过接口判断该报名表是否强制填写，是否弹窗或者页面。
                        //暂时默认是弹窗吧。
                        // console.log("tologin");
                        var newzbid = window.zbvd.zbid;
                        var _formurl = location.protocol + "//" + location.host + "/live/tpform?oId=768346371&type=1&meun=iframe&zbId="+newzbid;
                        var title = "报名表";
                        var isShowBtn = 1;
                        layer.open({
                            skin: 'tpForm',
                            type: 2,
                            area: ['480px', '650px'],
                            fix: false, //不固定
                            anim: 5, //动画0~6
                            shade: 0.4,  //遮罩透明度
                            title: title, //页面标题
                            shadeClose: isShowBtn,
                            closeBtn: isShowBtn,
                            content: _formurl,
                            end: function () {
                                $('body').get(0).style = 'overflow: hidden auto;'
                            }
                        });
                        $('body').css({
                            position: 'fixed',
                            top: 0,
                            left: 0,
                            right: 0,
                            bottom: 0
                        });
                    }else{
                        $("#openformJava").css("display","none");//不显示显示
                    }
                },
                error: function () {
                    console.log("报名表详情调用失败");
                },
            });
        }else{
            $("#openformJava").css("display","none");//不显示显示
        }
    })
</script>
<script>
    var newSidetipApp = new Vue({
        el: '#newSidetipApp',
        data:function() {
            return {
                tag: 0,
                msgList: [],
                currentItem: {},
                hidetime: 0,
                currentDate: 0,
                IsScreen: zbvd.IsScreen,
                tipstyleType:'normal',
                signMessage:'签到了',
            }
        },
        methods: {
            showMsg: function() {
                var that = this;
                if (this.hidetime) {
                    return;
                }
                clearTimeout(this.hidetime);
                this.hidetime = 0;
                this.currentItem = this.msgList.shift();
                var duration = this.msgList.length === 0 ? 6000 : 2000;
                this.hidetime = setTimeout(function() {
                    clearTimeout(that.hidetime);
                    that.hidetime = 0;
                    that.currentItem = {};
                    if (that.msgList.length) {
                    setTimeout(function() {
                        that.showMsg();
                    }, 500);
                    }
                }, duration);
            }
        }
        // mounted:function(){
        //     var that = this;
        //     this.currentDate = Date.now();
        //     if(zbvd.loginuser && zbvd.loginuser.nickname){
        //         this.$nextTick(function(){
        //             var item = zbvd.loginuser.nickname;
        //             item = item.length > 6 ? item.slice(0, 6) : item;
        //             item+= ' 来了';
        //             sideTipsAddWellcome({nickname: item})
        //             that.showMsg();
        //         })
        //     }
        // }
    })

    $(function(){
        window.onload = function(){
            console.log('44444', $('.themeUrl')[0].offsetHeight)
            if ('0' == 0) {
                $('.pc-live-video').css({
                    paddingTop: '0px',
                    background: ''
                })
                $('.direct-three').css({
                    paddingTop: 0,
                })
            } else {
                $('.pc-live-video').css({
                    background: ''
                })
                $('.direct-three').css({
                    paddingTop: '0px',
                })
            }
            $('.fixedMark').css({
                top: $('.themeUrl')[0].offsetHeight - 240 + 'px',
                opacity: 1
            })
        }
        window.onresize = function(){
            $('.fixedMark').css({
                top: $('.themeUrl')[0].offsetHeight - 240 + 'px',
            })
        }
    })

    // 新 websockiet 访客进入 收到一条消息
    function sideTipsAddWellcome (params,type) {
        var that = this;
        var current = Date.now();
        if(type == 'sign'){
            newSidetipApp.tipstyleType = 'sign';
            newSidetipApp.signMessage = params.sign_message || "签到了";
        }else {
            newSidetipApp.tipstyleType = 'normal';
        }
        // 如果第二个进来，计算小于6s大于1s，取消第一个的定时器
        if (
            current - newSidetipApp.currentDate > 2000 &&
            current - newSidetipApp.currentDate < 6000
        ) {
            clearTimeout(newSidetipApp.hidetime);
            newSidetipApp.hidetime = 0;
            newSidetipApp.currentItem = {};
        }
        params.tag = newSidetipApp.tag + 1;
        // 判断进来的是否是自己，如果是自己立即显示自己
        // 只显示最新的6条数据
        if (zbvd.loginuser && zbvd.loginuser.nickname === params.nickname ) {
            if (newSidetipApp.msgList.length >= 6) {
                newSidetipApp.msgList.pop();
            }
            newSidetipApp.msgList.splice(0, 0, params);
        } else {
            if (newSidetipApp.msgList.length >= 6) {
                newSidetipApp.msgList.shift();
            }
            newSidetipApp.msgList.push(params);
        }
        if(current - newSidetipApp.currentDate > 2000) {
            setTimeout(function() {
                newSidetipApp.showMsg();
            }, 1000);
        }
        newSidetipApp.tag = params.tag;
        newSidetipApp.currentDate = current;
    }

    window.IsOpenMultiScene = 'False' == 'True';
    window.IsOpenMultiLanguage = false;
    window.sceneArea = new Vue({
        el: '#sceneArea',
        data: {
            isopenScene: 'False' == 'True',//对会场开关
            sceneType: '2' * 1, //多会场位置 1 右侧 2 下方
            sceneList: [],//多会场数据
            activeScene: 0,
            islanguage: false,//是否是多语言
            conferenceName: '看更多会场'
        },
        methods: {
            sceneInit: function (callback) {
                var that = this;
                $.post('/liveajax/GetSonTopicsList', {
                    zbid: zbvd.zbid, tpid: zbvd.topicid
                }).then(function (r) {
                    if (r.isok) {
                        that.sceneList = r.dataObj;
                        window.livestatus = r.dataObj[0].livestatus;
                        livevideoplayer.liveinfo.livestatus = r.dataObj[0].livestatus;
                        callback && callback();
                    }
                })
            },
            changeScene: function (item, index, update) {//传update时 即使是同一会场也响应 用于socket状态更新
                if (this.activeScene == index && update == undefined) {
                    return false;
                }
                if (livevideoplayer.isPlayAd) {//正在播广告
                    return false;
                }
                update && console.log(index);
                if (item.IsAudt == -1 && index != 0) { //不是主会场且审核不通过
                    return layer.msg('直播审核未通过，无法观看');
                }
                if ($('.danmuBox').length == 0) {//防止弹幕无法再显示
                    $('#player-el').append('<div class="danmuBox"></div>');
                }
                $('#div_live_status').attr('data-starttime', item.StartTime).hide();
                if(livevideoplayer.player) {
                  window.usePlayerHeartbeat && usePlayerHeartbeat.postTimeLong('paused')
                }
                this.activeScene = index;
                livevideoplayer.liveinfo.cover = item.Cover;
                livevideoplayer.liveinfo.playurl = item.playurl + (item.playurl.indexOf("?") > -1 ? "&" : "?") + "zbid=" + window.zbvd.zbid + "&tpid=" + window.zbvd.topicid;
                livevideoplayer.liveinfo.playbackurl = item.palyBackUrl + (item.palyBackUrl.indexOf("?") > -1 ? "&" : "?") + "zbid=" + window.zbvd.zbid + "&tpid=" + window.zbvd.topicid;
                livevideoplayer.liveinfo.livestatus = item.livestatus;
                livevideoplayer.playurl = item.playurl.replace("http://", "https://");
                liveinfo.appid = item.appid;
                liveinfo.stream = item.stream;
                livevideoplayer.options.poster = item.Cover;

                try {
                    if (item.livestatus !== 'beginning') {
                        try {
                            $('.player-container #player-el').removeClass('vjs-liveui').removeClass('vjs-live');
                            livevideoplayer.player.options_.liveui = false;
                        } catch (error) {
                            console.log(error);
                        }
                    } else if (item.livestatus == 'beginning') {
                        $('.player-container #player-el').addClass('vjs-liveui').addClass('vjs-live');
                        livevideoplayer.player.options_.liveui = true;
                    }
                } catch (error) {
                  console.error(error);
                }

                switch (item.livestatus) {
                    case 'beginning':
                        $('.live-state-icontips').html(liveStyle.living);
                        break;
                    case 'playback':
                        $('.live-state-icontips').html(liveStyle.playback);
                        break;
                    case 'videosrc':
                        if (item.Status == -1) {
                            $('.live-state-icontips').html(liveStyle.notStart);
                        }
                        else {
                            $('.live-state-icontips').html(liveStyle.playback);
                        }
                        break;
                }
                $('.iconshijian').next().text(item.StartTime);
                if (item.playurl || item.playbackurl) {
                    $('.video-poster,#videomsgtip').hide();
                    horseInit();
                }
                else {
                    this.resetCover(item);
                    $('#horse-box').hide();
                }
                livevideoplayer.initVideo();

                $('#player-el_html5_api').css('height', '100%');
                
                if (item.playurl == '' && livevideoplayer.player) {
                    livevideoplayer.player && livevideoplayer.player.dispose();
                    $("#videoPlayer").hide();
                    $('#videomsgtip').css("display","flex");
                    livevideoplayer.player = null;
                }

                // 低延迟兼容
                // 已开启低延迟播放
                if (liveinfo.open_webrtc) {
                    // 是否在低延迟播放中 hls
                    if (VZ_HLS.player) {
                        VZ_HLS.destroy();
                    }
                    // 是否在低延迟播放中 flv
                    if (VZ_FLV.player) {
                        VZ_FLV.player.destroy();
                    }
                    // 是否在低延迟播放中 webrtc
                    if (VZAN_WEBRTCAPI.peerConnection) {
                        VZAN_WEBRTCAPI.stopStream('close')
                    }
                }
            },
            resetCover: function (item) {
                var img = new Image(); img.src = item.Cover;
                img.onload = function () {
                    $('.video-poster').attr('src', item.Cover).show();
                }
            },
            preLangInit: function () {
                var that = this;
                Utils.ajax('/marketing/wx/v1/topic_lang/multi_lang_list', { 
                    topicId: zbvd.topicid,
                    size: -1, // -1表示不分页
                    zbId: zbvd.zbid,
                    from: 'pc' 
                }, 'POST').then(function (res) {
                    try {
                        if (!res.dataObj.isOpen) {
                            return;
                        }
                        if (res.dataObj.list && res.dataObj.list.length) {
                            var list = res.dataObj.list;
                            var newList = [];
                            list.forEach(function(item, index) {
                                newList.push({
                                    livestatus: statusMap[item.status],
                                    Id: item.id,
                                    Cover: item.cover,
                                    title: item.title,
                                    TopicId: item.topicId,
                                    LangTypeName: langEnum[item.langType]
                                })
                                if (item.topicId == zbvd.topicid) {
                                    that.activeScene = index;
                                }
                            })
                            that.sceneList = newList;
                            that.islanguage = true;
                            that.isopenScene = true;
                            window.IsOpenMultiLanguage = true;
                            window.livestatus = newList[0].livestatus;
                            livevideoplayer.liveinfo.livestatus = newList[0].livestatus;
                        }
                    } catch(e) {
                        console.log(e)
                    }
                    
                })
            },
            changeLanguageTopic: function (item) {
                location.href = location.href.replace(zbvd.topicid, item.TopicId);
            }
        },
        mounted: function () {
            var that = this;
            if (that.isopenScene) {
                that.sceneInit();
            } else {
                // 只有旗舰版才执行
                if (zbvd.customertype == 6) {
                    setTimeout(function () { that.preLangInit(); }, 3 * 1000);
                }
            }
            setTimeout(function(){
                that.conferenceName = $.i18n.prop('conference.hall.btn')?$.i18n.prop('conference.hall.btn'):'看更多会场'
            },1000)
        },
        filters: {
            fitStatus: function (v, item) {
                switch (v) {
                    case 'notbegin': // 未开始
                        return 'state-preview';
                    case 'beginning': // 直播中
                        return 'state-living';
                    case 'notsignal': // 无信号
                        return 'state-living';
                    case 'playback': // 回放
                        return 'state-playback';
                    case 'mergeing': // 回放合成中
                        return 'state-playback';
                    case 'endlive': // 直播结束
                        return 'state-playback';
                    case 'videosrc': // 回放录播
                        return item.Status == -1 ? 'state-preview' : 'state-playback';
                }
            }
        }
    })
</script>

<script>
    var isthirdStr = 'False';
    var isRefresh = 'False';
    if(isRefresh.toLowerCase() === 'true'){
        window.location.href=window.location.protocol+"//"+window.location.host+"/live/tvchat-"+zbvd.topicid+"?ver="+new Date().getTime();
    }
    var isthird = isthirdStr.toLowerCase() === 'true' ? true : false;
    $(function () { if (isthird) { getConfig(); } });
    function getConfig() {
        $.post('/liveajax/GetWebChatSign', { zbid: "1427079113", link: window.location.href }).then(function (res) {
            if (res.isok) {
                var configParams = res.dataObj;
                wx.agentConfig({
                    corpid: configParams.corpid, // 必填，企业微信的corpid，必须与当前登录的企业一致
                    agentid: configParams.agentid, // 必填，企业微信的应用id （e.g. 1000247）
                    timestamp: configParams.agentConfigTime, // 必填，生成签名的时间戳
                    nonceStr: configParams.agentConfigNoncestr, // 必填，生成签名的随机串
                    signature: configParams.agentconfigsignature,// 必填，签名，见附录1
                    jsApiList: ['selectExternalContact', 'openUserProfile'], //必填
                    success: function (res) {
                        //console.log("agentConfigSuccess");
                        // 若一切正常，此时可以在 window 上看到 WWOpenData 对象
                        //console.info('window.WWOpenData', window.WWOpenData);
                        if (WWOpenData.on) {
                            // ww-open-data 元素数据发生变更时触发
                            WWOpenData.on('update', function (event) {
                                var openid = event.detail.element.getAttribute('openid')
                                console.info('渲染数据发生变更', openid, event.detail.hasData)
                            })
                            /**
                             * ww-open-data 获取数据失败时触发
                             */
                            WWOpenData.on('error', function (event) {
                                console.log('获取数据失败');
                                console.log(event);
                            })
                        }
                        //if (WWOpenData.prefetch) {
                        //    WWOpenData.prefetch({ }, (err, data) => {
                        //        if (err) {
                        //            console.info('prefetch', window.WWOpenData);
                        //            // 错误处理
                        //        }
                        //        console.log(data);
                        //        // 数据处理
                        //    })
                        //}
                        //console.log(document.querySelectorAll('ww-open-data'));
                        WWOpenData.bindAll(document.querySelectorAll('ww-open-data'));
                    },
                    fail: function (res) {
                        console.log(res);
                        if (res.errMsg.indexOf('function not exist') > -1) {
                            alert('版本过低请升级')
                        }
                    }
                });

            } else if (res.Msg) {
                console.log(res.Msg);
                // that.$message.error(res.Msg);
            }
        });
    }

    var paginationDom = document.getElementsByClassName('swiper-pagination')[0];
    if (paginationDom) {
        paginationDom.addEventListener("click",function(event){
            event.stopPropagation();
        },false);
    }

    var tabLeftChildren = $('.pd-tabs-left').children();
    if(tabLeftChildren.length == 1 && tabLeftChildren[0].style.display == 'none') {
        var _reduction = $('.pd-viewcontent-left').height() - $('.direct-three-left-video').height() - 146;
        var _remainder = $('.direct-three-right').height() - _reduction;
        $('.direct-three-right').css('height', _remainder);
        $('.themeBackground-b').css('background', 'unset');
    }else {}


</script>

<script>
    Utils.ajax('/api/v1/WatchReward/IsExistTopicTimingTime', { topicIdStr: zbvd.enc_topicid }, 'GET', '', { baseType: 'market' }).then(function (res) {
        if (res.code == 0 && res.dataObj) {
            if (!loginUser) {
                PcRedbag2021.showNoLogin = true
            }
        } else {
            PcRedbag2021.showNoLogin = false
        }
    })
</script>

<script>
    var pcTopicDescVue = new Vue({
        el: '#pc-topic-desc-id',
        data: function() {
            return {
                introduceDetails: {
                     guest: "",//主播
                }
            }
        }
    })
    $(function() {
        function analyseLog(actData) {
          var that = this;
          setTimeout(() => {
            try {
              Utils.ajax('/api/MeetingActivityService/setBrowseCountCache', { RelationId: window.zbvd.mActId, Zbid: window.zbvd.zbid, RelationType: 0 }, 'POST', '', { baseType: 'meetingBase' }).then(function () {})
            } catch (err) { console.log('analyseLog => setBrowseCountCache err', err) }
            try {
              Utils.ajax('/api/MeetingActivityService/UserBrowseAddWx', { RelationId: window.zbvd.mActId, Zbid: window.zbvd.zbid, RelationType: 0, Type: 1, ItemId: window.zbvd.topicid }, 'POST', '', { baseType: 'meetingBase' }).then(function () {})
            } catch (err) { console.log('analyseLog => UserBrowseAddWx err', err) }
            try {
              Utils.ajax('/api/MeetingTopicService/TopicUserAddWx', { topicId: window.zbvd.topicid, zbid: window.zbvd.zbid }, 'POST', '', { baseType: 'meetingBase' }).then(function () {})

            } catch (err) { console.log('analyseLog => UserBrowseAddWx err', err) }
          }, 5000)
        }
        try {
            if (!window.zbvd.mActId) return
            if (self !== top) {
                $('body').addClass('expo-live-video')
            }
            Utils.ajax('/api/MeetingTopicService/MeetingTopicActData', {
                'topicId': window.zbvd.topicid,
                'zbid': window.zbvd.zbid
            }, 'POST', '' ,{ baseType: 'meetingBase'}).then(function(MeetingTopicActDataRes) {
                if (!MeetingTopicActDataRes.isok || !MeetingTopicActDataRes.dataObj) return;
                analyseLog(MeetingTopicActDataRes.dataObj);
                if (MeetingTopicActDataRes.dataObj.exorData.tpType === 0 && MeetingTopicActDataRes.dataObj.exorData.assemblyType === 0) {
                    $('.pd-text-info-top').append('<div class="pd-text-info-top-tag" style="border-color:#8c8c8c;color:#8c8c8c;">主会场</div>');
                } else if (MeetingTopicActDataRes.dataObj.exorData.tpType === 0 && MeetingTopicActDataRes.dataObj.exorData.assemblyType === 1) {
                    $('.pd-text-info-top').append('<div class="pd-text-info-top-tag" style="border-color:#8c8c8c;color:#8c8c8c;">分会场</div>');
                }
                Utils.ajax('/api/MeetingSignUpService/InspectUserPayment', {
                    'RelationId': window.zbvd.mActId,
                    'RelationType': 0
                }, 'POST', '' ,{ baseType: 'meetingBase'}).then(function(InspectUserPaymentRes) {
                    if (InspectUserPaymentRes.isok) {
                        if (InspectUserPaymentRes.dataObj.playbackType === 1 && MeetingTopicActDataRes.dataObj.actData.status === 1 && new Date(MeetingTopicActDataRes.dataObj.end_time) < new Date()) {
                            $('.expo-video-mask').remove()
                        } else if (!InspectUserPaymentRes.dataObj.isSignUp && !zbvd.isadmin && InspectUserPaymentRes.dataObj.isTicket) {
                            $('#pcLiveRightArea').hide()
                            $('#videoPlayer').remove()
                            $('.expo-video-mask').html("<img src='https://static1.weizan.cn/zhibo/livecontent/img/expo/right-side-icon-coupon.png'/><span>仅限购票用户参与活动</span>").show()
                        } else if (!InspectUserPaymentRes.dataObj.isSignIn && !zbvd.isadmin && InspectUserPaymentRes.dataObj.isTicket) {
                            $('#pcLiveRightArea').hide()
                            $('#videoPlayer').remove()
                            $('.expo-video-mask').html("<img src='https://static1.weizan.cn/zhibo/livecontent/img/expo/right-side-icon-namecard.png'/><span>请先选择一张门票签到</span>").show()
                        } else {
                            $('.expo-video-mask').remove()
                        }
                    }
                })
            })
        } catch (err) {
            console.log(err)
        }
    })

</script>